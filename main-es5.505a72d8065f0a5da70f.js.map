{"version":3,"mappings":"20EAAA,cAGA,yCACA,8CACA,gCACAA,IAGAC,kBAA6C,UAC7CA,YACAA,WACAC,meCFOC,EDEPD,WCAEE,WACUC,EACAC,EACDC,EACAC,EACCC,aAJAC,gBACAA,wBACDA,eACAA,uBACCA,qBAEJH,EAAQI,cACVC,KAAS,MAAeC,UAAU,kBAAMN,EAAQO,mBDRtDZ,yCCYSa,sBAEDL,KAAKM,QAAQL,WACfD,KAAKM,QAAQC,UACZC,QAAKC,KAAa,OAClBN,UAAU,WACT,IAAMR,EAAQK,EAAKU,gBAAgBC,UAAUC,QAAQ,yBAC/ChB,EAAOI,EAAKU,gBAAgBC,UAAUC,QAAQ,mBAE/CC,kBADclB,EACdkB,YADuBjB,KAEtBkB,OAAOC,SAASC,aDtB9BxB,2BC4BeyB,sKAEPjB,KADoBkB,cAAcC,UAAU,gBAEzCnB,KAAKoB,SAASC,KACjBP,OAAOQ,iBAAiB,sBAAwB1B,YAC9CA,EAAM2B,iBACNvB,EAAKwB,YAAc5B,EACnBI,EAAKyB,sBACJ,CAAEC,WARET,gDD5BfzB,gCCyCUiC,sBACNX,OAAOQ,iBAAiB,QAAS,WAAQtB,EAAK2B,cAAiB,CAAED,YD1CrElC,wBC6CgBmC,iKAENhC,OADNK,KAAKwB,YAAYI,SADLD,SAEU3B,KAAKwB,YAAYK,WAF3BF,OAENhC,EAFMgC,OAGZ3B,KAAK8B,iBAAiBC,WAAW,MAAO,aAAcpC,EAAQqC,SAC9DhC,KAAKwB,mBAJOG,kDD7ChBnC,KCiDuBC,sCAnDVA,GAAUwC,wFAAVxC,EAAUyC,QAAVzC,EAAU0C,qBAFT,SC8BP,IAAMC,EAA2B,CACtCC,cACAC,IAAK,CACHC,IAAK,CACHC,kBAEFC,UAAW,CACTC,SAAU,SACVC,IAAK,wCACLC,GAAI,MAENC,KAAM,CAEJC,SAAU,eACVC,kBACAC,WAAY,CAAC,yBACZC,WAAY,CAAC,CACZC,iBAAkB,wDAClBC,YAAa,MACbC,SAAU,oBAGdC,QAAS,CACPC,QAAS,IAEXC,MAAO,CACLZ,IAAK,eAEPa,aAAc,CACZb,IAAK,0CACLc,QAAS,CAAC,WACVC,wBAAyB,IAE3BC,SAAU,CACRC,OAAQ,CAAC,YAAa,sBAExBC,gBAAiB,CACfC,2BACAC,gBACAC,iBAAkB,iCAEpBC,cAAe,CACbC,UAAW,CACT3D,cAEF4D,cAAe,CACbC,MAAO,yCACPC,UAAW,kDACX9D,aACA+D,WACAC,eAAgB,OAChBC,QAAS,YACTC,OAAQ,CACN,CAAEC,KAAM,OAAQC,aAAc,OAC9B,CAAED,KAAM,WAAYC,aAAc,IAAKC,YAAa,QAEtDC,YAAa,SAEfC,qBAAsB,CACpBC,MAAO,EACPC,wBACAZ,MAAO,+CACPC,UAAW,kDACXC,WACA/D,aACAgE,eAAgB,aAChBC,QAAS,YACTS,UAAW,OACXC,SAAU,MACVL,YAAa,cAEfM,SAAU,CACRd,UAAW,8CACXU,MAAO,EACPK,OAAQ,CACNC,MAAO,IACPC,KAAK,6GAGTC,mBAAoB,CAClBP,yBAEFQ,gBAAiB,CACfR,wBACAX,UAAW,6CACXU,MAAO,EACPT,YAEFmB,OAAQ,CACNpB,UAAW,qDACX9D,aACAwE,MAAO,EACPK,OAAQ,CACNC,MAAO,MAGXK,SAAU,CACRpB,aAGJqB,YAAa,CACX,CACEC,KAAM,aACNC,MAAO,iBACPC,IACE,qIAEFC,OAAQ,EAAC,OAAS,MAAO,SAAU,YAErC,CACEH,KAAM,YACNC,MAAO,cACPC,IACE,wIAEFC,OAAQ,CAAC,WAAY,YAAa,aAAc,gBAGpDC,mBAAoB,CAClBC,KAAM,CACJC,YAAa,UACbC,cAAe,GACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,GACfC,YAAa,GAEfC,MAAO,CACLR,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAEfE,UAAW,CACTT,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,IACfC,YAAa,IAGjBG,kBAAmB,CACjBX,KAAM,CACJC,YAAa,UACbC,cAAe,GACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,EACbC,YAAa,UACbC,cAAe,EACfC,YAAa,GAEfC,MAAO,CACLR,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,GACfC,YAAa,GAEfE,UAAW,CACTT,YAAa,UACbC,cAAe,EACfC,mBAAoB,UACpBC,UAAW,UACXC,YAAa,GACbC,YAAa,UACbC,cAAe,GACfC,YAAa,8FC5MdI,EHDPrH,wBGCOqH,sCAAMA,4DANF,CACPC,8CCuBGC,EJnBPvH,wBImBOuH,sCAAMA,4DAdF,CACPD,KACAE,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,wBCMGC,ELpBPhI,wBKoBOgI,sCAAMA,4DAjBF,CACPV,KACAW,IACAR,KACAD,KACAK,KACAH,KACAI,KACAC,KACAA,KACAA,KACAG,MACAA,ULfJlI,IM2BOmI,EN3BPnI,wBM2BOmI,sCAAMA,4DAlBF,CACPb,KACAG,KACAD,KACAY,KACAP,KACAC,KACAC,KACAA,KACAM,KACAN,KACAG,MACAH,KACAA,SNtBJ/H,IOUOsI,EPVPtI,wBOUOsI,sCAAMA,4DAXF,CACPhB,KACAG,KACAD,KACAM,KACAC,KACAA,mCCaGQ,ERlBPvI,wBQkBOuI,sCAAMA,4DAfF,CACPT,KACAR,KACAkB,KACAC,KACAV,KACAA,KACAP,KACAK,KACAJ,KACAiB,SRbJ1I,IS8EO2I,ET9EP3I,wBS8EO2I,sCAAMA,4DAvCF,CACPrB,KACAO,KACAL,KACAC,KACAW,KACAK,KACAX,KACAI,MACAA,MACAA,MACAA,gBACAA,gBACAH,KACAA,KACAA,KACAG,MACAH,KACAA,KACAA,KACAA,KACAA,KACAa,KACArB,EACAS,EACAM,EACAH,EACAd,EACAgB,KACAA,KACAN,KACAA,KACAA,KACAQ,+LC5EGM,GVIP7I,WUCEE,WACUC,EACAC,aADAI,qBACAA,sBAJVA,uCAMEA,KAAKsI,+BAAiCtI,KAAKuI,gCAC3CvI,KAAKwI,mBVNThJ,0CUSEgJ,WACExI,KAAKyI,QAAUC,OAAO1I,KAAK2I,eAAeC,IAAI,0BACzC5I,KAAKyI,UACRzI,KAAKyI,QAAU,GAGjBzI,KAAK2I,eAAeE,IAAI,wBAA0B7I,KAAKyI,SAAW,GAClEzI,KAAK2I,eAAeE,IAClB,UACA7I,KAAKkB,cAAcC,UAAU,kBVlBnC3B,2CUsBE+I,WACE,SACEvI,KAAK2I,eAAeC,IAAI,YACxB5I,KAAK2I,eAAeC,IAAI,aACtB5I,KAAKkB,cAAcC,UAAU,kBV1BrC3B,8BUkCEsJ,WACE,WACE9I,KAAK2I,eAAeC,IAAI,4BAC+B,UAAvD5I,KAAK2I,eAAeC,IAAI,4BAGtB5I,KAAKyI,SACLzI,KAAKkB,cAAcC,UAAU,wCAM7BnB,KAAKkB,cAAcC,UAAU,4CAEzBnB,KAAKsI,mCANTtI,KAAK2I,eAAeE,IAAI,wBAAyB,GACjD7I,KAAK2I,eAAeI,OAAO,oCACpB,IAaA/I,KAAKkB,cAAcC,UAAU,gCAClCnB,KAAKyI,QAAUzI,KAAKkB,cAAcC,UAAU,gCAC9CnB,KAAK2I,eAAeE,IAAI,+BAA2B,GAKhD7I,KAAKkB,cAAcC,UAAU,mBVjExC3B,uBUoEE2B,WACE,IAAMxB,EAAe,IAAIsI,KAEzB,SAAae,gBACbrJ,EAAasJ,aACbtJ,EAAauJ,SAAW,QAEjBvJ,IV3EXH,sCU8EE2J,WACEnJ,KAAK2I,eAAeE,IAAI,0BAA2B7I,KAAKoJ,eV/E5D5J,KU+E4D4J,uCAnF/Cf,IAAoBpG,qDAApBoG,GAAoBnG,QAApBmG,GAAoBlG,qBAFnB,gECNdF,iBAEEA,yBACEA,cAAIA,8BAAqCA,QACzCA,kBAEAA,iBACEA,mBAA2CA,wEAAuB,4DAAlEA,QACAA,8BACFA,QACFA,QAEAA,kBACEA,gDAGFA,QAEAA,cACAA,kBACEA,mCAIEA,wEACFA,QAEFA,qBAAgFA,gCAA2CA,QAC3HA,QAEFA,8BA3BQA,iDAIyCA,sCAC3CA,gEAMFA,4CASEA,kEAI4EA,0DXflFzC,IYAO6J,GZAP7J,WYQEE,WACSC,EACCC,EACAC,EACEC,aAHHE,cACCA,4BACAA,qBACEA,uBAVZA,kBACOA,+BACLsJ,MAAGtJ,KAAKkB,cAAcC,UAAU,wCAA0CnB,KAAKkB,cAAcC,UAAU,UAElGnB,WAAiC,IAAIuJ,YZN9C/J,kCYeEgK,WACExJ,KAAKyJ,gBZhBTjK,gCYmBEkK,WACE1J,KAAK2J,OAAOC,aZpBhBpK,yBYuBUiK,sBACF9J,EAAW,EACXC,KACAC,EAAc,IAAIgK,KAAK7J,KAAKkB,cAAcC,UAAU,wBAElDrB,EAAuBE,KAAKkB,cAAcC,UAAU,0BAG1D,GAAIrB,EAAsB,CACxB,IAAMgK,EAAiB,IAAID,KAAK/J,GAC5BiK,MAAMD,EAAeE,YACvBC,QAAQC,IAAI,wDACZtK,OAEAD,EAAW,EACXE,EAAciK,GAIlB,IAAI/J,EAAoB,GAExB,GAAIH,EAAgB,CAClB,IAAIkK,EAAWjK,EAAYmK,UAAYrK,EACnCmK,EAAM,KACRA,EAAM,IAAMA,GAEd,IAAIK,EAAatK,EAAYuK,WAAa,EACtCD,EAAQ,KACVA,EAAQ,IAAMA,GAGhBpK,YADaF,EAAYwK,cACzBtK,YAA+BoK,EAA/BpK,YAAwC+J,QAExC/J,EAAoBD,EAGtB,YAAKwK,QAAUtK,KAAKU,gBAAgBC,UAAUiI,IAAI5I,KAAKkB,cAAcC,UAAU,UAAY,IACxFX,QACC+J,KAAIT,mBACK9J,EAAKU,gBAAgBC,UAAUC,QAAQ,qBAAsB,CAClEwD,QACAoG,YAAaxK,EAAKkB,cAAcC,UAAU,gBAAkB,GAC5DsJ,QAASzK,EAAKkB,cAAcC,UAAU,gBAAkBnB,EAAKkB,cAAcC,UAAU,gBAAkB,GACvGuJ,YAAa3K,GAAqB,QAGtCI,UAAW2J,mBAAM9J,EAAK2K,MAAMC,KAAKd,KAE9B9J,KAAK2K,QZvEhBnL,0BY2EEqL,WACE7K,KAAK8K,qBAAqB1B,UAAYpJ,KAAKoJ,YZ5E/C5J,yBY+EEuL,WACM/K,KAAKsK,SACPtK,KAAKsK,QAAQU,kBZjFnBxL,KYiFmBwL,uCAjFN3B,IAAsBpH,yEAAtBoH,GAAsB4B,yfDZnChJ,iDAA8BA,yaEStBA,6BAEEA,oFACFA,gDAGEA,qBAMEA,gGACAA,uBACFA,aAHEA,wGCGLiJ,GdXP1L,Wc8CEE,WACUC,EACAC,EACAC,aAFAG,iBACAA,qBACAA,oBArCVA,YAAkC,IAAIuJ,YA2B5BvJ,kBAAe,IAAIiC,MACnBjC,gBAAa,IAAIiC,MdxC7BzC,2BcwC6ByC,WAtBzB,OAAOjC,KAAKmL,MdlBhB3L,IckBgB2L,SAENxL,GACNK,KAAKmL,KAAOxL,IdrBhBH,kBcqBgBG,WAMZ,OAAOK,KAAKoL,Sd3BhB5L,Ic2BgB4L,SAEHzL,GACLA,IAAUK,KAAKoL,UAInBpL,KAAKoL,QAAUzL,EACfK,KAAKqL,aAAaC,KAAKtL,KAAKoL,YdnChC5L,mBcmCgC4L,WAQ5B,OAAOpL,KAAKuL,UAAUC,Ud3C1BhM,sBcmDEgK,sBACExJ,KAAKyL,aAAezL,KAAKwL,QAAQE,YAAYvL,UAAWR,YACtD,IAAMC,EAAeI,EAAKkB,cAAcC,UAAU,iBAAmB,MACrE,GAAIxB,EACF,GAAkB,mBAAdA,EAAK+E,KAAT,WACwB1E,EAAK2L,aAAaC,aAAaC,OADvD,IACE,gCAAWhM,EAAXiM,SAAqDD,IAC/C7L,EAAK2L,aAAaC,aAAaG,MAAMnD,IAAI/I,GAASmM,UACpDhM,EAAKiM,OAAOrB,KAAK/K,EAAQuE,QAH/B,oCAG+BA,GAGN,qBAAdzE,EAAK+E,MAA6C,oBAAd/E,EAAK+E,KAHrBN,WAITpE,EAAKkM,IAAIC,QAJA/H,IAI7B,gCAAWvE,EAAXuM,SAA6BD,IACvBtM,EAAMwM,QAAQC,QAChBtM,EAAKiM,OAAOrB,KAAK/K,EAAMuE,QANEA,oCAU7BpE,EAAKiM,OAAOrB,KAAKjL,EAAKyE,YAGxBpE,EAAKiM,OAAOrB,KAAKhL,GAEnBI,EAAKuM,WAAWjB,KAAK3L,OdzE3BH,yBc6EEuL,WACE/K,KAAKyL,aAAaT,gBd9EtBxL,mCciFEgN,WACExM,KAAKwL,QAAQiB,yBdlFjBjN,mCcqFEkN,WACE1M,KAAKwL,QAAQmB,qBdtFjBnN,KcsFiBmN,uCA3EJzB,IAAgBjJ,+DAAhBiJ,GAAgBD,6uBDvB7BhJ,yBAGEA,qDAEAA,iBAEIA,oCAEEA,qDAKAA,6DACEA,8CAUAA,mCAeAA,0BAOFA,QACJA,QACFA,QACFA,eAhDEA,sBAAmB,mBAKmBA,wEAG7BA,yDAIQA,yDACAA,0DA4BPA,6BAAgB,s2CEhCpBA,SACEA,iBAGFA,uCAHOA,qCAAsB,YAAtBA,CAAsB,4DAJjCA,eAEIA,SACAA,iCAKJA,sCAPoBA,2BAChBA,+BACeA,2DAUnBA,SACEA,iBACFA,uCADOA,qCAAsB,YAAtBA,CAAsB,4DAF7BA,SACAA,+DADAA,sBACeA,2DArBnBA,SACEA,iBAOEA,sBAWFA,2CAOAA,QACFA,2CAzBOA,sDAAuD,2BAAvDA,CAAuD,6BAAvDA,CAAuD,yBAAvDA,CAAuD,+BAAvDA,CAAuD,wBAD7BA,4BAOzBA,8BAAoB,efI5BzC,IgBAOoN,GhBAPpN,WgBMEE,WACUC,EACAC,EACAC,aAFAG,sBACAA,oBACAA,qBARHA,gBAA2B,GhBDpCR,yCgBYEqN,sBACE7M,KAAK8M,UAAY9M,KAAK+M,eAAeC,SAAS7M,UAAUR,YACpDK,EAAKiN,oBAAoBtN,GACzBK,EAAKkN,QAAUvN,IAGnBK,KAAKmN,QAAUnN,KAAKoN,aAAaC,OAAOlN,UAAUR,mBAChDK,EAAKiN,oBAAoBjN,EAAKkN,ahBnBpC1N,yBgBuBEuL,WACE/K,KAAK8M,UAAU9B,cACfhL,KAAKmN,QAAQnC,gBhBzBjBxL,iCgB4BUyN,SAAoBtN,GAC1B,IAAIC,EAAa,GACjB,YAAID,EAAuB,CACzBK,KAAKsN,WAAa,GAElB3N,EAAY2N,WACV1N,EAAaD,EAAQ2N,WACZtN,KAAKkB,cAAcC,UAAU,gBACtCvB,EAAaI,KAAKkB,cAAcC,UAAU,eANnB,UAQHvB,GARG,IAQzB,gCAAWC,EAAX0N,UAGQ1N,EAAQ2N,OAA0C,YAAjCxN,KAAKoN,aAAaK,YACxC5N,EAAQ2N,OAAS3N,EAAQ2N,MAAME,SAAS1N,KAAKoN,aAAaK,cACzDzN,KAAKsN,WAAWK,KAAK9N,IAbA,oChB9B/BL,KgB2C+BK,uCA3ClB+M,IAAmB3K,+DAAnB2K,GAAmB3B,uRDZhChJ,uCAAkCA,6vBfYlCzC,IiBMOoO,GjBNPpO,WiBmCEE,uBAZUM,kBAAe,IAAIiC,MjBvB/BzC,8BiBcgC4L,WAEN,OAAOpL,KAAKoL,SjBhBtC5L,IiBuB+ByC,SAdlBtC,GACLA,IAAUK,KAAKoL,UAGnBpL,KAAKoL,QAAUzL,EACfK,KAAKqL,aAAaC,KAAKtL,KAAKoL,YjBdhC5L,0BiBgBsC4L,WAWlC,OAAOpL,KAAK6N,SjB3BhBrO,wBiB2BgBqO,WAKZ,OAAQ7N,KAAK8N,YAAc9N,KAAK6N,OAAU,UAAY,ajBhC1DrO,KiBgC0D,sBCvCpDyC,4CACAA,6DDYO2L,iCAA+B3C,6ZElB5ChJ,uBAEEA,sBACEA,SACFA,QACFA,eALWA,uBAAe,2BAEVA,i5BFaF,CGNP,WAGI,IAFT8L,EAESC,uDAFE,OACXrO,EACSqO,uDADD,QACRpO,EAASoO,qEAET,SAAOC,OAAQ,cAAe,IAC5BA,OAAM,UAAQA,OAAM,CAClBC,QAAS,EACTC,QAAS,cAEXF,OAAM,WAASA,OAAM,CACnBC,QAAS,EACTC,QAAS,aAEXF,OAAW,mBAAiBA,OAAjB,UAA4BF,EAA5B,YAAwCpO,EAAxC,YAAiDC,QAC5DqO,OAAW,mBAAiBA,OAAQ,UAfjC,KHMsBG,oBjBH7B5O,IqBGO6O,GrBHP7O,WqByBEE,uBAPUM,oBAAiB,IAAIiC,MrBlBjCzC,gCqBkBiCyC,WAZ7B,OAAOjC,KAAKsO,WrBNhB9O,IqBMgB8O,SAED3O,GACPA,IAAUK,KAAKsO,YAInBtO,KAAKsO,UAAY3O,EACjBK,KAAKuO,eAAejD,KAAKtL,KAAKsO,crBdlC9O,4BqBckC8O,WAQ9B,OAAOtO,KAAKwO,WrBtBhBhP,2BqB2BEiP,WACEzO,KAAKwO,UAAYxO,KAAKwO,arB5B1BhP,KqB4B0BgP,uCAzBbH,iCAA6BpD,2mBHf1ChJ,eACEA,iBACEA,oBAAwBA,gCAASrC,yCAG/BqC,6BACAA,6BACFA,QACFA,QAEAA,iBACEA,SACFA,QACFA,eAVIA,sFAEaA,mCACAA,8aIYVyM,GtBNPlP,WsB4CEE,uBAvBSM,kBAWCA,oBAAiB,IAAIiC,MtBhCjCzC,gCsBgCiCyC,WAvB7B,OAAOjC,KAAKsO,WtBThB9O,IsBSgB8O,SAED3O,GACPA,IAAUK,KAAKsO,YAInBtO,KAAKsO,UAAY3O,EACjBK,KAAKuO,eAAejD,KAAKtL,KAAKsO,ctBjBlC9O,yBsBiBkC8O,WAQ9B,OAAOtO,KAAK2O,gBtBzBhBnP,IsByBgBmP,SAEIhP,GAChBK,KAAK2O,eAAiBhP,ItB5B1BH,4BsB4B0BG,WAQtB,OAAOK,KAAKwO,WAAaxO,KAAK4O,YtBpClCpP,gCsBoCkCoP,WAK9B,OAAO5O,KAAKwO,UAAYxO,KAAK4O,YtBzCjCpP,6BsB8CEqP,WACE7O,KAAKwO,YACLxO,KAAK8O,qBtBhDTtP,KsBgDyBkP,uCA1CZA,iCAAuBzD,mkBClBpChJ,eAEEA,iBACEA,0BAEEA,gCAASrC,sBACXqC,QAEAA,wCAA4BA,yDAC1BA,SACFA,QAEAA,iBAGEA,WACFA,QACFA,QAEFA,eAfMA,wCAI0BA,sCAM1BA,8yCDCQ,CENP,WAGI,IAFT8L,EAESC,uDAFE,QACXrO,EACSqO,uDADD,QACRpO,EAASoO,qEAET,SAAOC,OAAQ,cAAe,IAC5BA,OACE,UACAA,OAAM,CACJC,QAAS,EACTC,QAAS,cAGbF,OACE,WACAA,OAAM,CACJC,QAAS,EACTC,QAAS,aAGbF,OAAW,mBAAiBA,OAAjB,UAA4BF,EAA5B,YAAwCpO,EAAxC,YAAiDC,QAC5DqO,OAAW,mBAAiBA,OAAQ,UArBjC,KFMsBG,mGGKzBnM,qBAOEA,mGACAA,yDAMFA,+BATEA,oJAIAA,0EAA4D,uGAO9DA,qBAQEA,0FACAA,uBACFA,+BAREA,yEAAiE,qGAUnEA,qBAQEA,sFACAA,uBACFA,+BAREA,0FAAgF,iGAUlFA,qBAKEA,0GAGAA,uBACFA,+BAHEA,0HAEUA,sFAYVA,kCAGEA,kFACFA,+BAFEA,sFAIFA,iCAMEA,0EAAmC,0EAAnCA,CAAmC,sEAGrCA,+BAPEA,mBAAW,gBAAXA,CAAW,eAAXA,CAAW,2EAvFjBA,uBAIEA,sEAA+B,6FAI/BA,2BAWAA,4BAgBAA,2BAYAA,2BAYAA,2BAUAA,oBAIEA,4DACAA,uBACFA,QAEAA,qBAEEA,0CAMAA,yCAUFA,QACFA,+BA9FEA,mCAA6B,oGAS3BA,sCAAqB,cAArBA,CAAqB,cAArBA,CAAqB,wCAArBA,CAAqB,gBAArBA,CAAqB,wBASpBA,+CAgBAA,+CAYAA,+CAYDA,qCAoBGA,+CAMAA,2EAtFPA,qEACGA,qGAkGLA,kBAEAA,sEAAgC,gEAAhCA,CAAgC,6DAAhCA,CAAgC,gEAKhCA,iCACAA,uCADaA,sCzB/FbzC,I0B0COuP,G1B1CPvP,W0BqPEE,WACSC,EACAC,EACCC,EACAC,aAHDE,oBACAA,uBACCA,oBACAA,kBAlKFA,gBAECA,sCAaDA,kBAeAA,oBAEDA,iBAAwC,IAAIuJ,IACjDvJ,KAAKgP,YAEAhP,sBACAA,uBAAoB,GAEpBA,UAAO,OAEPA,iBAAc,IAAIuH,KAAY,IAC9BvH,mBAAgBuH,aAEfvH,eAAY,IAAIuJ,QAChBvJ,uBAAoB,IAAIuJ,QACzBvJ,gCAA6B,IAAIuJ,QAGhCvJ,oBAEAA,YAAS,IAAIiP,KAGbjP,oBAEJ,IAAIuJ,YAGDvJ,uBACPA,eAAsC,IAAIuJ,QAEhCvJ,kBAAe,IAAIiC,MAEnBjC,qBAAkB,IAAIiC,MACtBjC,4BAAyB,IAAIiC,MAEvCjC,qBAAkB,IAAIuJ,YAkGpBvJ,KAAK6N,OAAS7N,KAAK2I,eAAeC,IAAI,eACtC5I,KAAKkP,SAAWlP,KAAK2I,eAAeC,IAAI,YACxC5I,KAAKgP,WAAahP,KAAK2I,eAAeC,IAAI,cAC1C5I,KAAKmP,sB1B9PT3P,sC0B8PS2P,WA3ML,OAAOnP,KAAKoP,aAAazG,iB1BnD7BnJ,e0BmD6BmJ,WAKzB,OAAO3I,KAAKmL,M1BxDhB3L,I0BwDgB2L,SAENxL,GACNK,KAAKmL,KAAOxL,I1B3DhBH,iB0B2DgBG,WAMZ,OAAOK,KAAKqP,Q1BjEhB7P,I0BiEgB6P,SAEJ1P,cACRK,KAAKqP,OAAS1P,EACdK,KAAKsP,MAAMC,UAAUpP,UAAWP,YAC9BI,EAAKwP,qB1BtEXhQ,kB0BsEWgQ,WAOP,OAAOxP,KAAKoL,S1B7EhB5L,I0B6EgB4L,SAEHzL,GACLA,KAAWK,KAAKoL,UAGpBpL,KAAKoL,QAAUzL,EACfK,KAAK2I,eAAeE,IAAI,cAAelJ,EAAO2H,cAC9CtH,KAAKqL,aAAaC,KAAK3L,M1BrF3BH,oB0BqF2BG,WAOvB,OAAOK,KAAKyP,W1B5FhBjQ,I0B4FgBiQ,SAED9P,GACPA,KAAWK,KAAKyP,YAGpBzP,KAAKyP,UAAY9P,EACjBK,KAAK0P,UAAU9E,KAAKjL,GACpBK,KAAK2I,eAAeE,IAAI,WAAYlJ,M1BpGxCH,sB0BoGwCG,WAMpC,OAAOK,KAAK2P,a1B1GhBnQ,I0B0GgBmQ,SAEChQ,GACTA,KAAWK,KAAK2P,cAGpB3P,KAAK2P,YAAchQ,EACnBK,KAAK4P,YAAYhF,KAAKjL,GACtBK,KAAK6P,gBAAgBvE,KAAK3L,GAC1BK,KAAK2I,eAAeE,IAAI,aAAclJ,M1BnH1CH,2B0BoKEsQ,WACE,MAAO,CACL,yBAA2B9P,KAAK6N,SAAW7N,KAAKgP,aAAehP,KAAK+P,cACpE,8BACE/P,KAAK6N,QAAU7N,KAAKgP,aACnBhP,KAAK+P,cAER,uBACE/P,KAAK6N,SACJ7N,KAAKgP,YACNhP,KAAKgQ,gBAAgBC,OACrBjQ,KAAK+P,cAEP,6BACE/P,KAAK6N,QACL7N,KAAKgP,YACLhP,KAAKgQ,gBAAgBC,OACrBjQ,KAAK+P,cAEP,6BAA8B/P,KAAK6N,SAAW7N,KAAKgP,aAAehP,KAAK+P,cACvE,kCAAoC/P,KAAK6N,QAAU7N,KAAKgP,aAAehP,KAAK+P,cAC5E,kCAAoC/P,KAAK6N,QAAU7N,KAAK+P,iB1BzL9DvQ,wB0ByL8DuQ,WAO1D,OAAI/P,KAAKkQ,QAAQC,QACa,IAAxBnQ,KAAKkQ,QAAQC,QAAgBnQ,KAAKoQ,aACpCpQ,KAAKqQ,aAAarQ,KAAKkQ,QAAQ,IAE1B,WAEF,W1BtMX1Q,6B0B8MuD8Q,SACnD3Q,GAEAK,KAAKuQ,U1BjNT/Q,2B0BoN0DgR,SACtD7Q,GAEAK,KAAKwP,mB1BvNThQ,2B0B0NkDiR,SAC9C9Q,GAEA,QAAIK,KAAK0Q,kBAAkBC,WAAqB,CAC9C,IAAM/Q,EAAiBI,KAAK4Q,OAAOC,YACjC7Q,KAAKgQ,gBAAgBW,WAAWG,KAChC,CACEC,eAAgB/Q,KAAKgQ,gBAAgBW,WAAWG,KAAKE,WACrDC,kBAAmBjR,KAAKkM,IAAI8E,gBAGhCtJ,OAAiB1H,KAAKkM,IAAK,CAACtM,GAAiB8H,kB1BrOnDlI,mB0BqOmDkI,WAM/C,OAAO1H,KAAKsP,MAAMzD,Q1B3OtBrM,oB0B2OsBqM,WAIlB,YAAKqE,QAAQC,OACTnQ,KAAKkR,UAAUtG,SACf5K,KAAKkR,UAAUtG,SACZ5K,KAAKkR,Y1BlPhB1R,oC0BiQU2R,sBACNnR,KAAKoR,+BAA8BC,MAAc,CAC/CrR,KAAKkM,IAAIoF,eAAeC,OACxBvR,KAAKgQ,kBAEJxP,QAAKC,KAAa,MAClBN,UAAWR,YACV,IAAMC,EAAiBD,EAAM,GAC7B,GAAKC,EAAL,CAIA,IAAMC,KAAoB6H,OAAY9H,EAAekR,KAAM9Q,EAAKkM,IAAI8E,YAC9DlR,KAA0B4H,OAAwB1H,EAAKkM,IAAK,CAACrM,IACnEG,EAAKwR,2BAA2B5G,QAAKlD,OAAqB1H,EAAKkM,IAAKpM,SALlEE,EAAKwR,2BAA2B5G,a1B1Q1CpL,sB0BoREgK,eAMM7J,EACAC,EAPN4J,OACExJ,KAAKsP,MAAMC,UAAUpP,UAAU,WAC7BH,EAAKoQ,iBAEPpQ,KAAKmR,yBAIDnR,KAAKyR,gCACPzR,KAAK0R,wBAAuBL,MAAc,CACxCrR,KAAK2R,eAAenR,QAClBoR,MAAK/R,YACHF,EAAeE,EACfD,EAAU,aAGdI,KAAKgQ,gBAAgBxP,QACnBoR,MAAK/R,YACHF,EAAeE,EACfD,EAAU,cAGdI,KAAKkM,IAAIoF,eAAeO,YACxB7R,KAAKsP,MAAMC,YACVpP,UAAU,kBAAMH,EAAK8R,oBAAoBnS,EAAcC,MAG5DI,KAAK+R,gBAAkB/R,KAAK2I,eAAeqJ,eACxCxR,QAAKyR,KAAWpS,kBAA6D,aAAtBA,EAAcqS,OACrE/R,UAAWN,YACVG,EAAKkP,SAAWrP,EAAOsS,eAG3BnS,KAAKoS,YAAYC,KAAK,CACpB,CACEzP,GAAI,OACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QAAQ,yBAC9C0R,KAAM,8BACNC,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,yBAEFuN,QAAS,kBACAnO,EAAK0Q,mBAEd8B,QAAS,WACPxS,EAAKwP,mBAGT,CACE5M,GAAI,cACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QACpC,4BAEF0R,KAAM,uBACNC,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,mCAEFuN,QAAS,kBACAnO,EAAK0Q,mBAEd8B,QAAS,WACP,IAAM3S,EAAiBG,EAAK4Q,OAAOC,YACjC7Q,EAAKgQ,gBAAgBW,WAAWG,KAChC,CACEC,eAAgB/Q,EAAKgQ,gBAAgBW,WAAWG,KAAKE,WACrDC,kBAAmBjR,EAAKkM,IAAI8E,gBAGhCtJ,OAAiB1H,EAAKkM,IAAK,CAACrM,GAAiB6H,cAGjD,CACE9E,GAAI,cACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QACpC,6BAEF2R,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,oCAEF0R,KAAM,eACNG,aAAc,kBACLzS,EAAK0S,UAEdF,QAAS,WACP,IADOG,EACD9S,EAAa,GADZ+S,IAEc5S,EAAKsP,MAAMzD,OAFzB,IAEP,2BAAuC,KAA5B/L,EAA4B6S,QAC/B5S,EAAiBC,EAAK4Q,OAAOC,YAAY/Q,EAAOgR,KAAM,CAC1DC,eAAgBjR,EAAOgR,KAAKE,WAC5BC,kBAAmBjR,EAAKkM,IAAI8E,aAE9BnR,EAAW8N,KAAK5N,IAPX,+BAOWA,EAElB2H,OAAiB1H,EAAKkM,IAAKrM,EAAY6H,cAG3C,CACE9E,GAAI,WACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QAAQ,uBAC9C2R,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,8BAEFiS,YACAC,eAAgB9S,KAAK0P,UACrB8C,QAAS,WACPxS,EAAKkP,UAAYlP,EAAKkP,SAClBlP,EAAKkP,eAAYlP,EAAK0Q,kBAAkBT,OAC1CjQ,EAAKqQ,aAAarQ,EAAKgQ,gBAAgBW,cAI7C,CACE/N,GAAI,aACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QAAQ,yBAC9C2R,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,gCAEF0R,KAAM,eACNnE,QAAS,kBACAnO,EAAK4P,YAAYpP,QAAK+J,KAAK1K,mBAAOA,IAAMG,EAAK+S,gBAEtDP,QAAS,WACPxS,EAAKgP,gBAGT,CACEpM,GAAI,iBACJwB,MAAOpE,KAAKU,gBAAgBC,UAAUC,QACpC,6BAEF2R,QAASvS,KAAKU,gBAAgBC,UAAUC,QACtC,oCAEF0R,KAAM,iBACNnE,QAAS,kBACAnO,EAAK4P,YAAYpP,QAAK+J,KAAK1K,mBAAMA,IAAMG,EAAK+S,gBAErDP,QAAS,WACPxS,EAAKgP,oB1B7ZfxP,yB0BmaEuL,WACM/K,KAAK0R,sBACP1R,KAAK0R,qBAAqB1G,cAExBhL,KAAKoR,6BACPpR,KAAKoR,4BAA4BpG,cAE/BhL,KAAK+R,iBACP/R,KAAK+R,gBAAgB/G,gB1B3a3BxL,iC0B+aUsS,SACNnS,EACAC,GAGA,GADAI,KAAKgT,uBACArT,IAAuB,aAAZC,IAA0BI,KAAKkP,UAA/C,CAIA,IAAMpP,KADc4H,OAAY/H,EAAOmR,KAAM9Q,KAAKkM,IAAI8E,YACvBiC,cAC/B,MAAIvL,OAAyB1H,KAAKkM,IAAKpM,EAAWoT,YAAiD,OAAS,CAC1G,IAAMnT,EAASD,EAAWoT,YACpBpJ,EAAI/J,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CoK,EAAIpK,EAAO,IAAMA,EAAO,GAAKA,EAAO,IAAM,EAC1CoT,EAAW,IAAIC,KAAU,CAC7B1O,KAAM,kCACN2O,SAAU,IAAIC,KAAQ,CAACxJ,EAAGK,MAE5BnK,KAAKuT,mCAAkC7L,OACrCyL,EACAnT,KAAKkM,IAAI8E,YAEXhR,KAAKuT,gCAAgCC,KAAKC,SACxC/L,OACEgM,OAAOC,OAAO,GACZ,CAAEC,QAAS5T,KAAKuT,iCACJ,aAAZ3T,EACEI,KAAK6T,WAAWC,2BAChB9T,KAAK6T,WAAWE,yBACxB/T,KAAKuT,gCAAgCC,KAAKC,MAAMO,UAAU,KAC1DhU,KAAKkM,IAAI+H,oBAAoBC,WAC3BlU,KAAKuT,gCACL7L,gB1B/cRlI,kC0BodUwT,WACFhT,KAAKuT,kCACPvT,KAAKkM,IAAI+H,oBAAoBE,cAAcnU,KAAKuT,iCAChDvT,KAAKuT,0C1BvdX/T,sB0B2dE4U,SAASzU,GACP,SAAO4H,MAAe5H,K1B5d1BH,yB0B+dE6U,SAAY1U,GACVK,KAAK2R,eAAe/G,KAAKjL,GACzBK,KAAKkM,IAAI+H,oBAAoBE,cAAcxU,EAAOmR,MAElDnR,EAAOmR,KAAK0C,KAAKC,SAAQ/L,OACvBgM,OAAOC,OAAO,GACZ,CAAEC,QAASjU,EAAOmR,MAClB9Q,KAAK6T,WAAWE,yBACpBpU,EAAOmR,KAAK0C,KAAKC,MAAMO,UAAU,KACjChU,KAAKkM,IAAI+H,oBAAoBC,WAAWvU,EAAOmR,KAAMpJ,c1BxezDlI,2B0B2eE8U,SAAc3U,EAA+BC,GAC3CI,KAAK2R,eAAe/G,cACfhL,IAASI,KAAKsP,MAAMvD,MAAMnD,IAAIjJ,GAAQ4U,WAG3CvU,KAAKkM,IAAI+H,oBAAoBE,cAAcxU,EAAOmR,MAElDnR,EAAOmR,KAAK0C,KAAKC,SAAQ/L,OACvBgM,OAAOC,OAAO,GACZ,CAAEC,QAASjU,EAAOmR,MAClB9Q,KAAK6T,WAAWjN,oBACpBjH,EAAOmR,KAAK0C,KAAKC,MAAMO,kBACvBhU,KAAKkM,IAAI+H,oBAAoBC,WAAWvU,EAAOmR,KAAMpJ,e1BvfzDlI,0B0B0fE6Q,SAAa1Q,GACXK,KAAKsP,MAAMvD,MAAMyI,OACf7U,EACA,CACE4U,WACAvI,cAAU,GAIdhM,KAAKgQ,gBAAgBpF,KAAKjL,GAC1BA,EAAWmR,KAAK2D,YAAgD,WAAlC9U,EAAOmR,KAAK2D,WAAWC,OACnD1U,KAAK2U,mBAEL3U,KAAK2U,mBAGP,IAhBWhV,EAgBLC,EAAW,GAhBND,IAiBWK,KAAKsP,MAAMzD,OAjBtBlM,IAiBX,gCAAWE,EAAX+U,QACM/U,EAAQ2T,KAAK5Q,KAAOjD,EAAO6T,KAAK5Q,IAClC/C,EAAQiR,KAAK0C,KAAKC,SAAQ/L,OACxBgM,OAAOC,OAAO,GAAI,CAAEC,QAAS/T,EAAQiR,MACnC9Q,KAAK6T,WAAWC,6BACpBjU,EAAQiR,KAAK0C,KAAKC,MAAMO,UAAU,MAElCnU,EAAQiR,KAAK0C,KAAKC,SAAQ/L,OACxBgM,OAAOC,OAAO,GACZ,CAAEC,QAAS/T,EAAQiR,MACnB9Q,KAAK6T,WAAWjN,oBAEtBhH,EAAS+N,KAAK9N,EAAQiR,OA7BbnR,8BAkCX,GAHAK,KAAKkM,IAAI+H,oBAAoBY,eAAejV,GAC5CI,KAAKkM,IAAI+H,oBAAoBa,YAAYlV,EAAU8H,YAE/C1H,KAAKkP,SAAU,CACjB,IAAMrP,EAAiBG,KAAK4Q,OAAOC,YACjC7Q,KAAKgQ,gBAAgBW,WAAWG,KAChC,CACEC,eAAgB/Q,KAAKgQ,gBAAgBW,WAAWG,KAAKE,WACrDC,kBAAmBjR,KAAKkM,IAAI8E,gBAGhCtJ,OAAiB1H,KAAKkM,IAAK,CAACrM,GAAiB6H,eAG/C1H,KAAK0Q,kBAAkB9F,SACvB5K,KAAKoQ,iB1BxiBT5Q,4B0B2iBEgQ,WACExP,KAAKgQ,gBAAgBpF,aACrB5K,KAAK0Q,kBAAkB9F,SACvB5K,KAAK2U,mBACL3U,KAAKsP,MAAMvD,MAAMwE,QAEjB,IANFf,EAMQ7P,EAAW,GANnB6P,IAOwBxP,KAAKsP,MAAMzD,OAPnC2D,IAOE,gCAAW5P,EAAXmV,QACEnV,EAAQkR,KAAK0C,KAAKC,SAAQ/L,OACxBgM,OAAOC,OAAO,GACZ,CAAEC,QAAShU,EAAQkR,MACnB9Q,KAAK6T,WAAWjN,oBACpBjH,EAASgO,KAAK/N,EAAQkR,OAZ1BtB,8BAcExP,KAAKkM,IAAI+H,oBAAoBe,YAAYrV,EAAU+H,WAAoB,S1BzjB3ElI,mB0B4jBE+Q,WACEvQ,KAAKgT,uBACLhT,KAAKkM,IAAI+H,oBAAoB1D,QAC7BvQ,KAAKsP,MAAMiB,QACXvQ,KAAKwP,iBACLxP,KAAK2U,qB1BjkBTnV,sB0BokBEyV,WACE,OAAOjV,KAAKoN,aAAaK,aAAenG,c1BrkB5C9H,uB0BukBEuT,WACE,OAAO/S,KAAKoN,aAAa2F,c1BxkB7BvT,iC0B2kBE0V,SAAoBvV,GACI,KAAlBA,EAAMwV,QACRnV,KAAKoV,iBACsB,KAAlBzV,EAAMwV,SACfnV,KAAKqV,e1B/kBX7V,4B0BmlBE4V,WACE,GAAKpV,KAAKgQ,gBAAgBC,MAA1B,CAGA,IAAItQ,EAAIK,KAAKkQ,QAAQoF,QAAQtV,KAAKgQ,gBAAgBC,OAC5CrQ,EAAiBI,KAAKkQ,UAAUvQ,GAClCC,GACFI,KAAKqQ,aAAazQ,M1B1lBxBJ,wB0B8lBE6V,WACE,GAAKrV,KAAKgQ,gBAAgBC,MAA1B,CAGA,IAAItQ,EAAIK,KAAKkQ,QAAQoF,QAAQtV,KAAKgQ,gBAAgBC,OAC5CrQ,EAAaI,KAAKkQ,UAAUvQ,GAC9BC,GACFI,KAAKqQ,aAAazQ,M1BrmBxBJ,oB0BymBE+V,WACE,IAAM5V,EAAiBK,KAAK4Q,OAAOC,YACjC7Q,KAAKgQ,gBAAgBW,WAAWG,KAChC,CACEC,eAAgB/Q,KAAKgQ,gBAAgBW,WAAWG,KAAKE,WACrDC,kBAAmBjR,KAAKkM,IAAI8E,gBAGhCtJ,OAAiB1H,KAAKkM,IAAK,CAACvM,GAAiB+H,c1BjnBjDlI,mB0BonBEgW,SAAM7V,GACAA,IAAWoP,EAAoB0G,aAAaC,MAC9C1V,KAAKoV,iBACIzV,IAAWoP,EAAoB0G,aAAaE,KACrD3V,KAAKqV,aACA1V,IAAeoP,EAAoB0G,aAAaG,GACrD5V,KAAK6N,UACIlO,IAAWoP,EAAoB0G,aAAaI,OACrD7V,KAAK6N,a1B5nBXrO,2B0BgoBEiP,SAAc9O,GACwB,oBAA/BA,EAAE+U,OAAeoB,YAGtB9V,KAAK6N,QAAU7N,KAAK6N,U1BpoBxBrO,6B0B2oBEuW,SAAgBpW,GACd,IAAMC,EAAOD,EAAOqW,MAAQ,GAC5BrW,EAAO6S,QAAP7S,UAAkBC,M1B7oBtBJ,4B0BgpBEmV,SAAehV,QACTA,GACFK,KAAK+P,iBACL/P,KAAKiW,uBAAuB3K,WAE5BtL,KAAK+P,iBACL/P,KAAKiW,uBAAuB3K,Y1BtpBlC9L,8B0B0pBE0W,WACE,SAAIlW,KAAK+P,gBAAiB/P,KAAK+S,e1B3pBnCvT,iC0BkqBE2P,WACMnP,KAAKgP,WACPhP,KAAKmW,kBAAoB,iBAGzBnW,KAAKmW,kBAAoB,iB1BvqB/B3W,2B0B4qBE4W,WACEpW,KAAK2I,eAAeE,IAAI,cAAe7I,KAAKgP,YAC5ChP,KAASgP,WACLhP,KAAKqW,eAELrW,KAAKsW,mB1BjrBb9W,0B0BqrBE6W,WACErW,KAAKgP,cACLhP,KAAKmP,wB1BvrBT3P,4B0B0rBE8W,WACEtW,KAAKgP,cACLhP,KAAKmP,0B1B5rBT3P,K0B2CSuP,gBAAe,CACpB2G,MAAO,aACPC,KAAM,YACNC,GAAI,UACJC,KAAM,oDALG9G,IAAmB9M,2EAAnB8M,GAAmB9D,qHAAnBrL,yBAAuBqC,MAAJgJ,CAAI,uCAAvBrL,uBAAqBqC,MAAFgJ,CAAE,+BAArBrL,uBAAqBqC,k0EDtDlCA,2CAoGAA,6CAAMA,oCAAkB,ywME5FpBA,8BAEEA,gFACFA,8BAFEA,+EAIFA,gCAQEA,qFAA+C,4FAA/CA,CAA+C,0GAA/CA,CAA+C,0DAA/CA,CAA+C,mEAA/CA,CAA+C,qFAQjDA,8BAdEA,8BAAsB,8BAAtBA,CAAsB,kCAAtBA,CAAsB,oBAAtBA,CAAsB,0BAAtBA,CAAsB,sBAAtBA,CAAsB,yDAAtBA,CAAsB,yFA8DtBA,qDAEEA,mBAAW,0CAAXA,CAAW,oEAKbA,wDAEEA,mBAAW,8BAAXA,CAAW,8BAAXA,CAAW,qDAMbA,gDAEEA,mBAAW,0CAAXA,CAAW,kFAyDbA,qBASEA,0GACAA,uBAGFA,aALEA,+EAMFA,+DAGEA,6BAA+B,cAA/BA,CAA+B,iCAA/BA,CAA+B,gBAA/BA,CAA+B,+CAA/BA,CAA+B,sBAA/BA,CAA+B,kBAA/BA,CAA+B,uBAA/BA,CAA+B,6EAWjCA,yCAKEA,kFACFA,8CAJEA,6BAA+B,iDAA/BA,CAA+B,sHA/CnCA,SACEA,qBAUEA,iIACAA,wCAIFA,QACAA,4BAcAA,mCAaAA,kBACAA,gDAOFA,wCAhDIA,4DAAyD,wGASvDA,6EAAqE,2CAKtEA,+CAeAA,qCAaAA,uFAULA,+BAKEA,kFAAuC,kFAGzCA,8CAPEA,kDACAA,wCAAgC,sBAAhCA,CAAgC,4DAHpCA,SACEA,sCASAA,mBAA6BA,8BAA4CA,QAC3EA,sCAPKA,4FAM0BA,kGAtFjCA,kCAGEA,uGAKAA,YACEA,qCAEEA,4FAAsD,8CACnCA,EADmCsU,MACnCC,6CADnBvU,CAAsD,+EAAtDA,CAAsD,mFAAtDA,CAAsD,4DAIrBA,EAJqBsU,MAIrBC,wDAInCvU,QAEAA,qDAqDFA,QAEAA,mDAaFA,8BAvFEA,qDAA6C,oCAA7CA,CAA6C,6CAA7CA,CAA6C,kDAA7CA,CAA6C,0IAczCA,yCAAwB,qCAAxBA,CAAwB,aAKXA,wDAuDFA,gGA4BfA,0CAGEA,4FACFA,6BAFEA,6DAMJA,8BAQEA,gFAA0C,oEAA1CA,CAA0C,4GAG5CA,8BAVEA,mBAAW,qBAAXA,CAAW,gEAAXA,CAAW,qDAAXA,CAAW,8CAAXA,CAAW,wGAAXA,CAAW,uDAaXA,+CACEA,kCAA0B,cAA1BA,CAA0B,6HC1HvBwU,G5B1GPjX,W4BmSEE,WACUC,EACDC,EACAC,EACAC,EACAC,EACA+J,EACAK,EACAgJ,EACCuD,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACDC,EACCC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,aA3BA7X,aACDA,sBACAA,mBACAA,oBACAA,oBACAA,yBACAA,aACAA,2BACCA,oBACAA,gBACAA,mBACAA,kBACAA,iBACAA,2BACAA,qBACAA,qBACAA,YACAA,uBACAA,sBACAA,4BACDA,oBACCA,oBACAA,sBACAA,+BACAA,sBACAA,6BACAA,yBACAA,oBApNHA,wBACAA,wBAA8C,IAAIuJ,YAClDvJ,oBAA2C,IAAIuJ,QAC/CvJ,yBAAsB,EACtBA,0BACAA,2BACAA,4BACAA,uBACAA,sBACAA,uCACAA,sCACAA,kCAAuC,gCAEvCA,gCAAuD,IAAIuJ,QAC3DvJ,gCACAA,sBAAgD,CACrD8X,SAAU,GACVC,gBAAiB,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,IAAK,MAEpC/X,wBAAqB,iBAErBA,gBAAaA,KAAK2I,eAAeC,IAAI,cACpC5I,yBAAsC,GACrCA,wBAA+C,IAAIuJ,IAC1DvJ,KAAK2I,eAAeC,IAAI,sBAGnB5I,mBAAgB,IAAIuJ,YACpBvJ,mBAAgB,GAChBA,uBAAoB,IAAIuJ,YACxBvJ,yBACAA,kBAAe,IACfA,kCACCA,mBAAgC,GACjCA,sBAEAA,sBAAmB,IAAIuH,KAAY,IAGlCvH,sBAQDA,qCAEAA,yCACAA,wBAAiD,IAAIuJ,YAIrDvJ,8BAoCCA,4BACLA,KAAK2I,eAAeC,IAAI,eA2HzB5I,KAAKgY,kBAAoBhY,KAAKkB,cAAcC,UAAU,qBACtDnB,KAAKiY,6BACHjY,KAAKkB,cAAcC,UAAU,oBAC/BnB,KAAKkY,4BAAqBlY,KAAKkB,cAAcC,UAAU,uBACrDnB,KAAKkB,cAAcC,UAAU,sBAC/BnB,KAAKmY,wCAAiCnY,KAAKkB,cAAcC,UAAU,mCACjEnB,KAAKkB,cAAcC,UAAU,kCAC/BnB,KAAKoY,wBAAiBpY,KAAKkB,cAAcC,UAAU,mBACjDnB,KAAKkB,cAAcC,UAAU,kBAC/BnB,KAAKqY,uBAAgBrY,KAAKkB,cAAcC,UAAU,kBAChDnB,KAAKkB,cAAcC,UAAU,iBAC/BnB,KAAKwC,cAAgBxC,KAAKkB,cAAcC,UAAU,qBAClDnB,KAAKyR,8BAAgCzR,KAAKkB,cAAcC,UAAU,iCAGlEnB,KAAKsY,+BAAiCtY,KAAKkB,cAAcC,UAAU,oCAC/DnB,KAAKsY,iCACPtY,KAAKsY,+BAAiCtY,KAAK2I,eAAeC,IAAI,oC5BlVpEpJ,2B4BkViH,WAtK7G,OAAOQ,KAAKuY,SAASrM,M5B5KzB1M,yB4B4KyB0M,WAIrB,OAAOlM,KAAKwY,eAAevI,O5BhL/BzQ,I4BgL+ByQ,SAGXtQ,GAChBK,KAAKwY,eAAe5N,KAAKjL,K5BpL7BH,gB4BoL6BG,WAIzB,OAAOK,KAAKkB,cAAcC,UAAU,SAAW,K5BxLnD3B,4B4BwLmD,WAI/C,OAAOQ,KAAKyY,mB5B5LhBjZ,I4B4LgBiZ,SAEO9Y,GACfA,KAAWK,KAAKyY,oBAGpBzY,KAAKyY,kBAAoB9Y,EACzBK,KAAK0Y,MAAMC,mB5BnMfnZ,sB4BwMEyV,WACE,OAAOjV,KAAKoN,aAAaK,aAAenG,c5BzM5C9H,sB4B4MEoZ,WACE,OAAO5Y,KAAKoN,aAAaK,aAAenG,c5B7M5C9H,yB4BgNEqZ,WACE,OAAO7Y,KAAKoN,aAAa0L,mBAAqBxR,iB5BjNlD9H,wB4BoNEuZ,WACE,OAAO/Y,KAAKoN,aAAa0L,mBAAqBxR,gB5BrNlD9H,yB4BqNkD8H,WAI9C,OACGtH,KAAKiV,YAAejV,KAAK4Y,YAAc5Y,KAAK+Y,eAC7C/Y,KAAKgZ,gB5B3NXxZ,kC4B2NWwZ,WAKP,OAAOhZ,KAAKwW,eAAeyC,wB5BhO/BzZ,I4BgO+ByZ,SAEFtZ,GACzBK,KAAKwW,eAAeyC,uBAAyBtZ,I5BnOjDH,2B4BmOiDG,WAI7C,W5BvOJH,uC4BuOW,WAIP,OAAOQ,KAAKkZ,wBAA0BlZ,KAAKmZ,+B5B3O/C3Z,yB4B2O+C2Z,WAI3C,OAAO5R,e5B/OX/H,8B4B+OW+H,WAIP,OAAOvH,KAAKoZ,gBAAkB7R,e5BnPlC/H,uB4BmPkC+H,WAI9B,OAAOvH,KAAKqZ,YAAY/J,Q5BvP5B9P,wC4BuP4B8P,WAIxB,OAAOtP,KAAKqZ,YAAYC,8BAA8BrJ,Q5B3P1DzQ,sB4B2P0DyQ,WAItD,OAAOjQ,KAAK6T,WAAWvE,Q5B/P3B9P,mB4B+P2B8P,WAIvB,OAAOtP,KAAKuL,UAAUC,U5BnQ1BhM,6B4BmQ0BgM,WAItB,IAAI7L,EACJ,gBAAIK,KAAKuZ,WAA2BvZ,KAAKuZ,UAAUC,YACjD7Z,EAAU,aAILA,I5B7QXH,0B4B6QWG,WAeP,OAAOK,KAAKwW,eAAelH,Q5B5R/B9P,qB4B4R+B8P,WAI3B,OAAOtP,KAAKwW,eAAeiD,WAAWxJ,Q5BhS1CzQ,sB4BsVEgK,sBACE1I,OAAO4Y,IAAS1Z,KAChBA,KAAKqZ,YAAYM,oBAAoB/O,KAAK5K,KAAK4Z,cAE/C5Z,KAAK6Z,oBAEL7Z,KAAK8Z,YAAYC,cAAc5Z,UAAWR,YACxCK,EAAKga,mBAGPha,KAAK8M,UAAY9M,KAAKia,aAAajN,SAAS7M,UACzCR,mBAA6BK,EAAKka,gBAAgBva,KAGrDK,KAAKma,iBAAiB9H,KAAK,CACzB,CACEzP,GAAI,cACJwB,MAAO,cACPoO,QAAS,kBAAMxS,EAAKoa,iBAAiBpa,EAAKqa,oBAE5C,CACEzX,GAAI,aACJwB,MAAO,YACPoO,QAAS,kBAAMxS,EAAKsa,eAAeta,EAAKqa,oBAE1C,CACEzX,GAAI,mBACJwB,MAAO,mBACPoO,QAAS,kBAAMxS,EAAKua,qBAAqBva,EAAKqa,sBAIlDra,KAAKwa,WAAWC,OACbja,QAAKka,QACLva,UAAU,YAAWP,aAATD,EAASC,YACpBI,EAAKkM,IAAIoF,eAAeqJ,QAAQ,GAAK/a,EAAa,IAAM,EAG1C,IAAZD,GACAC,IAAeD,GACfK,EAAKiV,YACLjV,EAAKgY,mBACLhY,EAAKkZ,wBACLlZ,EAAK4a,mBAEL5a,EAAK4a,uBAGX5a,KAAKkM,IAAI2O,GAAGnZ,KAAK,iBAAkB,WACjC1B,EAAK8a,oBAGP9a,KAAK+a,kBAAkB5a,UAAU,WAC/BH,EAAKqZ,YAAY2B,4BAGnBhb,KAAKqZ,YAAY4B,gBAAgB9a,UAAWR,YACtCA,GAAUK,EAAKiV,YACjBjV,EAAKkb,iBAITlb,KAAKwW,eAAe2E,kBAAkBvQ,KAAK5K,KAAKgY,mBAChDhY,KAAKwW,eAAelH,MAAM8L,OAAOjb,UAAWR,aACrCK,EAAKgY,oBAGVhY,EAAKwW,eAAe2E,kBAAkBvQ,MAAKjL,GACvCA,IACFK,EAAKkZ,2BAEPlZ,EAAKqb,2BAGPrb,KAAKsb,oBAAoB3N,KAAK3N,KAAKwW,eAAe+E,mBAAmBpb,UAAWR,YAC9EK,EAAKub,mBAAmB3Q,KAAKjL,GAC7BK,EAAKqb,2BAEPrb,KAAKsb,oBAAoB3N,KACvB3N,KAAKub,mBAAmBpb,UAAU,kBAAMH,EAAKqb,2BAG/Crb,KAAKwW,eAAeiD,WAAWtZ,UAAWR,wBACpCA,GACFK,EAAKwb,mBAAmB5Q,KAAKjL,GAC7BK,EAAKkZ,2BAEgC,QAAjCtZ,IAAU6b,MAAMpP,QAAQkN,qBAAS3Z,WAAEkY,YAA6C,QAAjCjY,IAAU4b,MAAMpP,QAAQkN,qBAAS1Z,WAAEkY,iBACpF/X,EAAK0b,iBAAmB,CACtB5D,SAA2C,QAAjChY,IAAU2b,MAAMpP,QAAQkN,qBAASzZ,WAAEgY,SAC7CC,gBAAkD,QAAjChY,IAAU0b,MAAMpP,QAAQkN,qBAASxZ,WAAEgY,iBAGtD/X,EAAK0b,iBAAmB,CACtB5D,SAAU,GACVC,gBAAiB,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,IAAK,OAI7C/X,EAAKkZ,4BAITlZ,KAAK2b,eAAiB3b,KAAKwW,eAAeoF,uBAAuBzb,UAC9DR,qBACKA,GACFK,EAAK6b,6BACL7b,EAAK8b,sCAEL9b,EAAK+b,8BACL/b,EAAK8b,uCAKX9b,KAAKgc,cAAgBhc,KAAKuL,UAAU0Q,aAAa9b,UAC9CR,YACKA,IACFK,EAAKkc,cACLlc,EAAKuL,UAAU0Q,aAAarR,YAKlC5K,KAAKmc,gCACH9K,MAAc,CACZrR,KAAKwY,eACLxY,KAAKoN,aAAaC,OAClBrN,KAAKoN,aAAagP,eAClB5b,QACAC,KAAa,KACbN,UAAWR,YACXK,EAAKqc,6BAEPrc,KAAKsc,SACLtc,KAAKuc,sBAAsBC,eAAerc,UAAUR,YAClD,GAAIA,EAAM,CACRK,EAAKyc,kBAAkBC,sBAAvB1c,OAAoDL,GACpDK,EAAKyc,kBAAkBC,sBAAsBC,OAAOhd,GACpD,IAAMC,EAAQD,EAAK8U,WAAWmI,QAAQC,UAAU,EAAE,GAC5Chd,EAAQF,EAAK8U,WAAWmI,QAAQC,UAAU,EAAE,GAC5C/c,EAAOH,EAAK8U,WAAWmI,QAAQC,UAAU,EAAE,IAC3C9c,EAAOJ,EAAK8U,WAAWmI,QAAQC,UAAU,GAAG,IAC5C/S,EAAWnK,EAAK8U,WAAWqI,SAC3B3S,EAAW4S,KAAKC,MAAMlT,EAAS,KAC/BqJ,EAAQnT,EAAKid,YAAYnT,EAAS,IAAK,GAC7C9J,EAAKkd,YAALld,UAAsBJ,EAAtBI,YAA+BH,EAA/BG,YAAwCF,EAAxCE,YAAgDD,EAAhDC,aACRmK,EADQnK,YACImT,EADJnT,aAERL,EAAK8U,WAAW0I,SAFRnd,WAIAA,EAAKkd,qBAIPld,KAAK2I,eAAeC,IAAI,yBAC1B5I,KAAKwL,QAAQ4R,aAAa,wB5BjfhC5d,yB4BqfEyd,SAAYtd,EAAKC,GACf,OAAOyd,OAAO1d,GAAK2d,SAAS1d,EAAc,O5Btf9CJ,oB4ByfU8c,eAcAvc,EACA+J,EAfAwS,OAOAzc,EAAK,CAAC,OAAO,MAAM,MAAM,KAAK,OAC9BC,EAAW,IALJ,CACX,gBAAiB,QAAS,WAAY,WACtC,QAAS,QAAS,QAAS,QAAS,WAAY,QAAS,QAAS,QAAS,SAIxEoM,IAAInM,YACPF,EAAGqM,IAAIpC,mBAAKhK,EAAS6N,KAAT7N,qFAA4BC,EAA5BD,YAAmCgK,EAAnChK,iBAGV,kBAAmByd,YAGrBA,UAAUC,cAAcC,MAAMC,KAAMvT,YAClCF,QAAQC,IAAI,wBACZlK,EAAK2d,KAAK/U,IAAI,aAAapI,QACzBod,KAAWzK,YACT,IAAMuD,EAAS,GACXC,KACJ,GAAIxD,EAAM,CAERrJ,EAAiBqJ,EAAK0K,QAAQpT,QAC9B,IAAMmM,EAAoB5W,EAAK2I,eAAeC,IAAI,qBAClD,GAAIkB,IAAmB8M,EAAmB,CAUxC,GATEzD,EAAa2K,YAAoB5R,IAAK2K,YACd,aAApBA,EAAWnS,OACW,SAApBmS,EAAWnS,OACbiS,EAAmBE,EAAWkH,KAAKC,OAAOnH,EAAWoH,OAAO9N,OAAS,GAEhD0G,EAAWkH,KAAKC,OAAOnH,EAAWoH,OAAOC,OAAOnH,mBAAKA,IAC7D7K,IAAI,SAAC6K,EAAIC,GAAL,OAAWN,EAAO/I,KAAK3N,EAAK2d,KAAK/U,IAAImO,GAAKvW,QAAK2d,KAAM,YAGxExH,EAAkB,CACpB,IAAME,EAAU7W,EAAKU,gBAAgBC,UAAUC,QAAQ,2BACvDb,EAAkBC,EAAKoe,eACpBC,KAAKxH,SAAoB,CAAEyH,kBAAsBC,eAAoBC,eAAmBC,kBAE7F,OAAOC,KAAPC,aAAcjI,IAIlB,OAAOgI,KAAPC,aAAcjI,QAEhBkH,KAAWzK,YACT,GAAIA,EAAMhD,OAAS,GAAKrQ,EAASqQ,OAAS,EAAG,CAC3C,IAAMuG,EAAU1W,EAAKU,gBAAgBC,UAAUC,QAAQ,2BACvDb,EAAkBC,EAAKoe,eACpBC,KAAK3H,SAAoB,CAAE4H,kBAAsBC,eAAoBC,eAAmBC,kBAC3F,IAAM9H,EAAU,GAChB,SAASzK,IAAI,SAAC0K,EAAIC,GAAL,OAAWF,EAAQhJ,KAC9B3N,EAAK2d,KAAK/U,IAAIgO,GAAKpW,QACjBod,KAAU9G,mBACD9W,EAAK4e,aAAapK,OAAOoC,EAAKC,EAAGC,EAAG,SAAiB,4BAI3D4H,KAJ2DC,aAIpDhI,GAEhB,SAAOrN,MAAG6J,MAGb3S,QAAK2d,KAAM,MACXhe,UAAU,WACT,GAAIJ,EAAiB,CACnBC,EAAKoe,eAAerV,OAAQhJ,EAAwB8e,SACpD,IAAM1L,EAAUnT,EAAKU,gBAAgBC,UAAUC,QAAQ,+BACvDZ,EAAKoe,eAAeU,QAAQ3L,SAAoB,CAAE4L,QAAS,MACvDjV,GACF9J,EAAK2I,eAAeE,IAAI,oBAAqBiB,U5BjkB3DtK,sC4B0kBEwf,SAAyBrf,GACvBK,KAAKif,sBAAwBtf,EAC7BK,KAAKqc,6B5B5kBT7c,sC4B+kBE6c,sBACMrc,KAAKiV,aAAejV,KAAK6Y,cAC3BqG,QAAQC,UAAUzB,KAAK,kBAAM1d,EAAKof,mBAAmBxU,eAErDsU,QAAQC,UAAUzB,KAAK,kBAAM1d,EAAKof,mBAAmBxU,KAAK5K,EAAKqf,2B5BnlBrE7f,iC4BulBE8f,WACE,IAAM3f,EAAOK,KAAKwb,mBAAmBvL,MACrC,OAAItQ,EAAI4f,mBAAmBtP,MACzBtQ,EAAQ6f,YAAYpE,OAAOnL,QAAUtQ,EAAI8b,MAAMgE,QAC7Czf,KAAK0f,6BAA+B,6BAEpC1f,KAAK0f,6BAA+B,GAGtC1f,KAAK0f,6BAA+B,gCAE/B/f,EAAI4f,mBAAmBtP,Q5BlmBlCzQ,gC4BqmBEmgB,SAAmBhgB,GACjB,OAAIA,aAAqB+H,Q5BtmB7BlI,wB4B4mBE0U,SAAWvU,GACT,IAAIC,EAAU,CACZ0F,KAAM,UACNmP,WAAY,IAEd7U,EAAQ6U,WAAazU,KAAK4f,wBAAwBjgB,EAAU8b,OAC5Dzb,KAAKwW,eAAeqJ,+BAA+BjV,SACnDjL,EAAUmgB,YAAYlgB,EAASD,K5BnnBnCH,qC4BsnBEogB,SAAwBjgB,GACtB,IAAIC,EAAa,GACjB,SAAMyM,QAAQ0T,cAAcC,aAAaC,QAAQpgB,aAC1CA,EAAMqgB,SAAWrgB,EAAM4f,UAC1B7f,EAAWC,EAAM6E,MAAQ,MAGtB9E,I5B7nBXJ,6B4BgoBE2gB,SAAgBxgB,GACdK,KAAKogB,mBAAqBzgB,I5BjoB9BH,8B4BooBE6gB,WACErgB,KAAKsgB,2BAA2B1V,W5BroBpCpL,gC4BwoBE+gB,SAAmB5gB,cACaK,KAAKwgB,uBAAnC,IACM3gB,EAA8C,GAEpD,MAAIG,KAAKwb,mBAAmBvL,iBAAiBvI,OAAgB1H,KAAKwb,mBAAmBvL,iBAAiBvI,QAC/F1H,KAAKwb,mBAAmBvL,MAAMwQ,8BAEjC9gB,GAAUA,EAAO+gB,MAAO,CAC1B,IAAM5gB,EAAUH,EAAO+gB,MAAMxU,IAAKpC,YAChC,GACEA,GACAA,EAAI+Q,IACJ/Q,EAAI+Q,GAAG8F,gBAAgBC,cAAcnF,OACrC3R,EAAI+Q,GAAG8F,gBAAgBC,cAAcnF,MAAMgE,QAC3C,CACA,IAAMtV,EAAKL,EAAI+Q,GACT1H,EAAoBrJ,EAAI+Q,GAAG8F,gBAAgBC,cAAcnF,MACzD/E,KAAUhP,OACdyC,EACAgJ,EAAkBjH,IAAI8E,WACtBmC,EAAkB0H,IAGpBnE,EAAQlD,KAAK3N,MAAQ7F,EAAK6gB,aAAaC,yBACrC3N,GAEFuD,EAAQlD,KAAKpP,MACXpE,EAAK6gB,aAAaE,cAAcrK,EAASvD,IACzCuD,EAAQlD,KAAKpP,MACf,IAAIuS,EAAoB9W,EAAuBmhB,KAC5CpK,mBAAMA,EAAExS,QAAUsS,EAAQlD,KAAKyN,cAElC,OAAKtK,IACHA,EAAoB,IAAIjP,MAAkB,CACxCtD,MAAOsS,EAAQlD,KAAKyN,cAEtBphB,EAAuB8N,KAAKgJ,OAEvBjP,OAAsBgP,EAASC,SAK/BrN,MAAGxJ,GAIGK,UAAW2J,YAC1B9J,EAAKwa,WAAWnI,KAAKvI,Q5BxrB7BtK,yB4B6rBEuL,WACE/K,KAAK8M,UAAU9B,cACfhL,KAAK2b,eAAe3Q,cACpBhL,KAAKgc,cAAchR,cACnBhL,KAAKsb,oBAAoBpP,IAAIvM,mBAAKA,EAAEqL,gBACpChL,KAAKmc,6BAA6BnR,gB5BlsBtCxL,mC4BwsBU0hB,WACNlhB,KAAKmhB,cAAclB,QAAStgB,mBAAsBA,EAAIqL,gBACtDhL,KAAKmhB,cAAgB,K5B1sBzB3hB,6B4B6sBEqP,WACE7O,KAAKkb,iB5B9sBT1b,kC4BitBE4hB,WACEphB,KAAKqhB,kB5BltBT7hB,yC4BqtBE8hB,WACEthB,KAAK+b,gC5BttBTvc,yC4BytBEuc,WACE/b,KAAKmZ,kC5B1tBT3Z,wC4B6tBEqc,WACE7b,KAAKmZ,kC5B9tBT3Z,wB4BiuBE+hB,SAAW5hB,cACqBK,KAAKwgB,uBAAnC,IACM3gB,EAA8C,GAkB9CE,EAAkBJ,EAjBF6hB,SAAStV,IAAK/B,YAClC,IAAIgJ,EAAoBtT,EAAuBmhB,KAC5CtK,mBAAMA,EAAEtS,QAAU+F,EAAQqJ,KAAKyN,cAElC,IAAIjhB,EAAKyhB,0BAA0BtX,KAC7BnK,EAAK0hB,gCAAoC1hB,EAAKuZ,UAA2BoI,4BAI/E,OAAKxO,IACHA,EAAoB,IAAIzL,MAAkB,CACxCtD,MAAO+F,EAAQqJ,KAAKyN,cAEtBphB,EAAuB8N,KAAKwF,OAEvBzL,OAAsByC,EAASgJ,KAER+K,OAAO/T,4BAAKA,OAEjCb,MAAGvJ,GAIGI,UAAWgK,YAC1BnK,EAAKwa,WAAWnI,KAAKlI,O5B5vB3B3K,gC4BgwBEoiB,SAAmBjiB,UACG,QAAhBC,OAAKiiB,uBAAWjiB,WAAEkiB,SAAUniB,IAASK,KAAK6hB,YAAYC,QACxD9hB,KAAKqZ,YAAY0I,qCAGnB/hB,KAAKqZ,YAAY2I,cAAcriB,GAE3BA,EAD4BsiB,QAAQ,aAAc,IAAIC,OACnC/R,OAAS,EAC9BnQ,KAAKmiB,gBAGPniB,KAAKoiB,mB5B3wBT5iB,sB4B8wBE6iB,SAAS1iB,GACP,IAIIG,EAJEF,EAAUD,EAAMuQ,QAEhBrQ,MAAmB6H,OAAgB/H,EAAM2iB,SAASC,QAItDziB,EADED,EACeG,KAAKwiB,oBACnBC,oBACAvE,OAAOxW,OAEO1H,KAAKwiB,oBACnBC,oBACAvE,OAAOxW,OAGZ,IAAM3H,EAAaC,KAAK0iB,YAAYnT,UAAUU,MAC3CiO,OACEpU,mBACCA,EAAOyY,SAAW5iB,EAAM2iB,SAASC,QACjCziB,EAAe4N,SAAS5D,EAAOyY,UAElCvE,OAAOpe,GACVI,KAAK0iB,YAAYC,WAAW5iB,K5BryBhCP,iD4BwyBEojB,SAAoCjjB,GAClCK,KAAKqZ,YAAYwJ,+BAA+BljB,K5BzyBpDH,oC4B4yBEsjB,WACE9iB,KAAK+a,kBAAkBnQ,W5B7yB3BpL,0B4BgzBU0b,WACNlb,KAAKgZ,iBACLhZ,KAAKkM,IAAIoF,eAAeqJ,QAAQ,GAAK,I5BlzBzCnb,yB4BqzBU0c,WACNlc,KAAKgZ,iBACLhZ,KAAKkM,IAAIoF,eAAeqJ,QAAQ,GAAK3a,KAAKiV,WAAa,EAAI,M5BvzB/DzV,2B4B0zBU6hB,WACNrhB,KAAKgZ,cAAgBhZ,KAAKkb,eAAiBlb,KAAKkc,cAChDlc,KAAKqc,6B5B5zBT7c,yB4B+zBSujB,SAAYpjB,GACbA,GAAsB,kBAAdA,EAAK+E,MAA4B1E,KAAKgjB,WAChDhjB,KAAKgjB,UAAUC,cAAcC,qBAAqB,SAAS,GAAGxc,U5Bj0BpElH,qC4Bq0BU2jB,SAAwBxjB,YACR,QAAlBE,EAAY,QAAZD,EAAO,MAAPD,WAASuM,eAAGtM,WAAEwjB,gBAAIvjB,WAAEwjB,aACtBrjB,KAAKqjB,WAAa1jB,EAAQuM,IAAIkX,KAAKC,WAAWtd,OAC9C/F,KAAKsjB,WAAa3jB,EAAQuM,IAAIkX,KAAKC,WAAWE,OAC9CvjB,KAAKwjB,SAAW7jB,EAAQuM,IAAIkX,KAAKC,WAAWI,OAE5CzjB,KAAKqjB,kBACLrjB,KAAKsjB,kBACLtjB,KAAKwjB,mB5B70BXhkB,6B4Bk1BU0a,SAAgBva,cAEtB,GADAK,KAAKkhB,iCACDvhB,EAeJ,IAZKK,KAAK6T,WAAWvE,MAAMoU,OACzB1jB,KAAK6T,WAAWvE,MAAMqU,YAGxB3jB,KAAKmjB,wBAAwBxjB,GAE7BK,KAAK4jB,MAAMC,YAAYrjB,QAAKC,KAAa,MAAMN,UAAWP,cACnDA,EAAQsN,SAActN,EAAQsN,UAAevN,EAAQmkB,MACxD9jB,EAAK+jB,sBAAsBnkB,KAI3BI,KAAKga,cAAe,CACtB,IAAMpa,EAAiBI,KAAKwL,QAAQwY,QAAQ,kBAIxClkB,GAH0BF,EAC1BA,EAAeyM,QACf,IACmC4X,0BAEvC,IAAKnkB,EAEH,IADA,IACAokB,MADwB,CAAC,WAAY,MAAO,aAAc,aAC1DA,oBAAWpa,OACT,GAAI9J,KAAKwL,QAAQwY,QAAQla,GAAW,CAClChK,EAAagK,EACb,OAKFhK,GACFE,KAAKwL,QAAQ4R,aAAatd,GAI9BE,KAAKga,oB5Bz3BTxa,4B4B43BU4iB,aAEHpiB,KAAKwL,QAAQE,YAAYuE,OACc,kBAAxCjQ,KAAKwL,QAAQE,YAAYuE,MAAMvL,OAE/B1E,KAAKwL,QAAQ4R,aAAa,iBAE5Bpd,KAAKkc,gB5Bn4BT1c,+B4Bs4BE2kB,SAAkBxkB,GAChBK,KAAKkM,IAAIoF,eAAeqJ,QAAQ,GAAKhb,EAAS,IAAM,EACpDK,KAAKokB,kCACLpkB,KAAK4a,iBAAmBjb,I5Bz4B5BH,6C4B44BU4kB,WAEJpkB,KAAKiV,YACLjV,KAAKgY,mBACLhY,KAAKkZ,wBACLlZ,KAAK4a,mBAEL5a,KAAKkZ,6B5Bn5BX1Z,2B4Bu5BS2iB,WACLniB,KAAKkM,IAAImY,qBAAqB9T,QAC9BvQ,KAAK0iB,YAAYnS,QACjBvQ,KAAKqZ,YAAYiL,0BACjBtkB,KAAKqZ,YAAY0I,uC5B35BrBviB,kC4B85BUghB,WACN,OAAOxgB,KAAKwiB,oBACT+B,aACAvD,KACErhB,mBACCA,aAAwB+H,U5Bn6BlClI,+B4Bu6BEglB,SAAkB7kB,GAChBK,KAAKqa,iBAAmBra,KAAKykB,mBAAmB9kB,K5Bx6BpDH,gC4B26BUilB,SAAmB9kB,GACzB,IAAMC,EAAmBD,EACnBE,EAAqBG,KAAK0kB,WAAWzB,cAAc0B,wBACzD/kB,EAAiBwI,EACfxI,EAAiBwI,EACjBvI,EAAmB+kB,KAClB9jB,OAAO+jB,SAAW/jB,OAAOgkB,aAC5BllB,EAAiBkH,EACflH,EAAiBkH,EACjBjH,EAAmBklB,MAClBjkB,OAAOkkB,SAAWlkB,OAAOmkB,aAC5B,IAAMnlB,EAAQ,CAACF,EAAiBkH,EAAGlH,EAAiBwI,GAE9CrI,EAAQC,KAAKkM,IAAI2O,GAAGqK,uBAAuBplB,GAC3CgK,EAAO9J,KAAKkM,IAAI8E,WACtB,OAAOmU,MAAiBplB,EAAO+J,EAAM,e5B17BzCtK,4B4B67BU8a,SAAe3a,GACrBmB,OAAOskB,KAAK1d,6BAAmC/H,EAAM,GAAIA,EAAM,O5B97BnEH,kC4Bi8BU+a,SAAqB5a,GAC3BmB,OAAOskB,KAAK1d,8BAAoC/H,EAAM,GAAIA,EAAM,O5Bl8BpEH,8B4Bq8BE4a,SAAiBza,GACfK,KAAKqlB,cAAgB1lB,EAAMuM,IAAKtM,mBAAMA,EAAE0lB,QAAQ,KAAIC,KAAK,Q5Bt8B7D/lB,mC4By8BE6b,WACE,IAAM1b,EAASK,KAAK6T,WAAWvE,MAAMC,UAAUU,MAAME,OAAS,EAC1DnQ,KAAKgY,mBAAqBhY,KAAKwW,eAAe2E,kBAAkBlL,MAClEjQ,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,uBAE5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,uBAGjD/I,KAASgY,mBAAqBhY,KAAKkZ,uBAC7BlZ,KAAKub,mBAAmBtL,OAC1BjQ,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,8BAC5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,sBAE/C/I,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,oBAC5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,+BAG7C/I,KAAKub,mBAAmBtL,MAC1BjQ,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,8BAE/C/I,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,oBAInD/I,KAASgZ,cACPhZ,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,kBAE5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,kBAGjD/I,KAASgZ,gBAAkBhZ,KAAKiV,WAC9BjV,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,6BAE5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OACtC,6BAIC/I,KAAK4a,mBAAoBjb,GAAWK,KAAKkZ,uBAG5ClZ,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OAAO,2BAF/C/I,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,4BAM3CzlB,KAAK4a,kBACNjb,IACCK,KAAKiV,YAAcjV,KAAK4Y,YAAc5Y,KAAKgZ,iBAC3ChZ,KAAKkZ,uBAENlZ,KAAK0kB,WAAWzB,cAAcuC,UAAUC,IAAI,4BAE5CzlB,KAAK0kB,WAAWzB,cAAcuC,UAAUzc,OACtC,8B5B9/BRvJ,iC4BmgCE6f,WACE,OAAKrf,KAAKgZ,cASChZ,KAAKgZ,cACVhZ,KAAKif,uBAAyBjf,KAAKoN,aAAa2F,YAC3C,qBAEL/S,KAAKgP,WACA,cAEA,yBAfLhP,KAAKif,uBAAyBjf,KAAKoN,aAAa2F,YAC3C,cAEL/S,KAAKgP,WACA,eAEA,a5B3gCfxP,0C4ByhCEkmB,SAA6B/lB,GAC3BK,KAAK2I,eAAeE,IAAI,8BAA+BlJ,GACvDK,KAAKsY,+BAAiC3Y,I5B3hC1CH,qC4B8hCEmmB,WACE,WAAI3lB,KAAKgZ,mBACHhZ,KAAKkZ,uBACA,OAEF,oBAELlZ,KAAKgZ,oBAA0BhZ,KAAKiV,gBAClCjV,KAAKkZ,uBACA,UAEF,2BAELlZ,KAAKgZ,oBAA0BhZ,KAAKiV,gBAClCjV,KAAKkZ,uBACA,SAEA,sB5B/iCf1Z,kC4BojCEomB,WAEE,OAAI5lB,KAAKkZ,uBACPlZ,KAASub,mBAAmBtL,MAC1BjQ,KAAS4a,iBACE,mCAEA,mCAGP5a,KAAK4a,iBACE,0BAEA,0BAIJ,gB5BrkCfpb,iC4B0kCEqmB,WACE,QAAI7lB,KAAKiV,iBAAuBjV,KAAK4a,uBAC/B5a,KAAKgZ,oBACHhZ,KAAKkZ,wBACHlZ,KAAK6T,WAAWvE,MAAMC,UAAUU,MAAME,OAAS,EACjD,MAAO,Q5B/kCnB3Q,gC4BqlCEsmB,WACE,OAAO9lB,KAAKkZ,uBACVlZ,KAAKub,mBAAmBtL,MAAQ,wCAA0C,8BAC1E,uB5BxlCNzQ,yC4B2lCEumB,WAEE,OAAI/lB,KAAKiV,WAEPjV,KAASwW,eAAe2E,kBAAkBlL,WACxCjQ,KAASkZ,uBAC8C,IAArDlZ,KAAS6T,WAAWvE,MAAMC,UAAUU,MAAME,OAC/B,sBAEA,qBAG0C,IAAjDnQ,KAAK6T,WAAWvE,MAAMC,UAAUU,MAAME,OAC/B,8BAEA,+BAKwC,IAArDnQ,KAAS6T,WAAWvE,MAAMC,UAAUU,MAAME,OAC/B,qBAEA,sBAIbnQ,KAASwW,eAAe2E,kBAAkBlL,MACxCjQ,KAASkZ,uBACHlZ,KAAKub,mBAAmBtL,MACjB,wCAEA,8BAGF,sBAGF,uB5BjoCjBzQ,6B4BuoCUsb,sBACN9a,KAAK4jB,MAAMC,YAAY1jB,UAAWR,YAChCK,EAAK6hB,YAAcliB,EACnBK,EAAKgmB,iBACLhmB,EAAKimB,mBACLjmB,EAAKkmB,iBACLlmB,EAAKmmB,0B5B7oCX3mB,iC4BipCU2mB,WACN,GAAInmB,KAAK6hB,YAAYuE,WAAe,CAClC,IAAMzmB,EAAeK,KAAK6hB,YAAYuE,WAAcC,MAAM,KACpDzmB,EAAWulB,MACfxlB,EACA,YACAK,KAAKkM,IAAI8E,YAEXhR,KAAKkM,IAAIoF,eAAegV,aAAa1mB,M5BzpC3CJ,+B4B6pCU+mB,WACNC,WAAW,WACT,IAAM7mB,EAAkB8mB,SACrBvD,qBAAqB,2BACrBwD,KAAK,GACJ/mB,GACFA,EAAWgnB,SAEZ,K5BrqCPnnB,4B4BwqCU0mB,sBACN,GAA+B,MAA3BlmB,KAAK6hB,YAAY+E,IAAiB5mB,KAAK6mB,iBACzC,IAAMlnB,EAAaK,KAAK0iB,YAAYoE,UAAUC,OAC3CvmB,QACCyR,KAAWrS,mBAAiC,IAApBA,EAASuQ,YACjC1P,KAAa,QACbumB,MAAK,IAEN7mB,UAAWP,YACVD,EAAWqL,cACPpL,EAASuQ,SAAWnQ,EAAKinB,4BAC3BjnB,EAAKumB,oBACLvmB,EAAKinB,kC5BprCjBznB,8B4B0rCUymB,sBACN,GAAIjmB,KAAK6hB,YAAYC,OAAW,CAK9B,GAJA9hB,KAAK6mB,oBACkC,MAAnC7mB,KAAK6hB,YAAYqF,YACnBlnB,KAAKqZ,YAAY8N,mCAEfnnB,KAAK6hB,YAAYC,SAAc9hB,KAAK6hB,YAAY4B,MAAsC,MAA3BzjB,KAAK6hB,YAAY+E,GAC9E,IAAMjnB,EAAaK,KAAK0iB,YAAYoE,UAAUC,OAC3CvmB,QACCyR,KAAWrS,mBAAiC,IAApBA,EAASuQ,YACjC1P,KAAa,QACbumB,MAAK,IAEN7mB,UAAWP,YACVD,EAAWqL,cACX,IAAMnL,EAA0BD,EAC7Bse,OAAOne,mBAAKA,EAAEqnB,OAAO5T,KAAK6T,WAAa3f,QACvCwE,IAAKnM,mBACJ,IAAIkP,MAAkB4B,YAAY9Q,EAAOqnB,OAAOtW,KAAM,CACpDC,eAAgBhR,EAAOqnB,OAAOtW,KAAKE,WACnCC,kBAAmBjR,EAAKkM,IAAI8E,eAG5BlR,KAAc4H,OAAwB1H,EAAKkM,IAAKrM,GACtDG,EAAKkM,IAAIoF,eAAegV,aAAaxmB,KAG3CE,KAAKqlB,cAAgBrlB,KAAK6hB,YAAYC,OAED,MAAnC9hB,KAAK6hB,YAAYyF,YACnBtnB,KAAKqZ,YAAYC,8BAA8B1O,W5BxtCrDpL,4B4B4tCUwmB,sBAkBN,GAjBIhmB,KAAK6hB,YAAY0F,MACnBvnB,KAAKwnB,cAAchnB,QACjByR,KAAUtS,4BAAKA,OACf8nB,SACAtnB,UAAUR,YACLA,GACHK,EAAKwL,QAAQ4R,aAAapd,EAAK6hB,YAAY0F,QAKb,MAAhCvnB,KAAK6hB,YAAY6F,SACnBlB,WAAW,WACTxmB,EAAKkc,eACJ,KAGDlc,KAAK6hB,YAAY8F,QAAY,CAC/B,IAGI7nB,EAHAH,KACEC,EAAaI,KAAK6hB,YAAY8F,QAAWtB,MAAM,KAC/CxmB,EAAiBG,KAAK6hB,YAAY+F,eAEpC/nB,IACFC,EAAkB+nB,SAAShoB,EAAewmB,MAAM,WAAW,GAAI,KAEjErmB,KAAK8nB,eAAeC,WAAWC,kBAC5BxnB,QAAKyR,KAAUlS,mBAASA,OAAO0nB,SAC/BtnB,UAAWJ,YACNA,IAASJ,IACXA,KACAC,EAAWsM,IAAI,SAACpC,EAAOK,GACjBA,EAAI,MACNzC,OAAe1H,EAAK8nB,eAAeC,cAGvCvB,WAAW,WACT5mB,EAAWsM,IAAI,SAACpC,EAAOK,GACrB,IAAMgJ,EAAOnT,EAAK8nB,eAAeC,WAAWlc,MAAMmV,KAAKtK,mBAAKA,EAAEuR,WAAa9d,IAC3EgJ,EAAK+U,KAAOpe,EACZqJ,EAAKgV,YAAcre,EAAMuc,MAAM,KAC/BrmB,EAAK8nB,eAAeC,WAAWvT,OAAOrB,MAEJ,KAAnCnT,EAAK8nB,eAAeM,iBAI7BpoB,KAAK8nB,eAAeO,mBAAmB5N,OACpCja,QAAKyR,KAAUlS,mBAAKA,EAAI,OAAI0nB,SAC5BtnB,UAAUJ,YACLA,GAAK,GACPC,EAAK8nB,eAAeQ,mBAAmB1d,SAI7C5K,KAAK8nB,eAAeO,mBAAmB5N,OACpCja,QAAKyR,KAAUlS,mBAAKA,EAAI,OAAI0nB,SAC5BtnB,UAAU,WACLL,IACFE,EAAK8nB,eAAeO,mBAAmB9Y,UAAUU,MAAM/D,IAAInM,mBAAKA,EAAE0U,WAAWnI,YAC7EtM,EAAK8nB,eAAeO,mBAAmB9Y,UAAUU,MAAMnQ,GAAiB2U,WAAWnI,UACnFtM,EAAK8nB,eAAeQ,mBAAmB1d,a5BzxCnDpL,mC4B+xCUukB,SAAsBpkB,GAC5BK,KAAKuoB,4BAA4B5oB,EAAQ,OACzCK,KAAKuoB,4BAA4B5oB,EAAQ,QACzCK,KAAKuoB,4BAA4B5oB,EAAQ,cACzCK,KAAKuoB,4BAA4B5oB,EAAQ,mBACzCK,KAAKuoB,4BAA4B5oB,EAAQ,kBACzCK,KAAKwoB,sBAAsB7oB,K5BryC/BH,2B4BwyCEipB,SAAc9oB,EAAMC,GAClB,IAAIC,EACJ,OAAID,EAAI8N,SAAS,OAEf7N,EADmB,IAAI6oB,MAAW,CAAEC,WAAY/oB,EAAIymB,MAAM,KAAK,KACvCzd,IAAIjJ,IAEvBE,I5B9yCXL,yC4BizCU+oB,SAA4B5oB,EAAgBC,OAC9CC,EACAC,EAF8CF,OAGlD,OAAQA,OACD,OACED,EAAOwM,QAAaxM,EAAOipB,YAAiBjpB,EAAOkpB,SACtD/oB,EAAU,SACVD,EAAqBF,EAAOipB,UAAe,YAAc,UAE3D,UACG,OACCjpB,EAAOmpB,YAAiBnpB,EAAOopB,UACjCjpB,EAAU,UACVD,EAAqB,cAEvB,UACG,aACCF,EAAOqpB,cAAmBrpB,EAAOspB,YACnCnpB,EAAU,YACVD,EAAqB,gBAEvB,UACG,kBACCF,EAAOupB,eAAoBvpB,EAAOwpB,aACpCrpB,EAAU,aACVD,EAAqB,iBAEvB,UACG,iBACCF,EAAOypB,eAAoBzpB,EAAO0pB,aACpCvpB,EAAU,aACVD,EAAqB,iBAI3B,GAAKA,GAAuBC,EAA5B,CAGA,IAAMC,EAAkBJ,EAAOE,GAAoBwmB,MAAM,OACnDvc,EAAOnK,EAAOG,GAASumB,MAAM,KAE/Blc,EAAM,EACVL,EAAKmW,QAAS9M,YACZ,IAAIuD,EAAMvD,EACJwD,EACJ3W,EAAKyoB,cAAc,UAAW/R,IAC9B1W,EAAKyoB,cAAc,UAAW/R,WAE5BC,IACFD,EAAMA,EAAIuL,QAAQ,WAAatL,EAAS,IAAIsL,QAAQ,WAAatL,EAAS,KAM5E3W,EAHoCspB,uBAClCvpB,EAAgBoK,IAEK8V,QAASpJ,YAC9B,IAAMC,EAAeD,EAAMwP,MAAM,SAC3BtP,EAAewS,qBAA4B,CAC/CjkB,OACA3C,IAAK+T,EACL+E,MAAO3E,EAAa,GACpB1R,OAAiB,QAATxF,EAAiB,CAAE4pB,OAAQ1S,EAAa,aAE5CE,KAAKtP,OAA4BqP,GACjCE,EAAajX,EAAKypB,8BAA8B9pB,EAAQqX,GAC9DhX,EAAK0pB,gBACHhT,EACAI,EAAa,GACblX,EACA+W,EACAM,EACAH,EAAa,GAAK+Q,SAAS/Q,EAAa,GAAI,cAGhD3M,GAAO,O5B33Cb3K,mC4B+3CUgpB,SAAsB7oB,cAC5B,GAAIA,EAAOgqB,OAAW,CACpB,IAAM/pB,EAAMD,EAAOgqB,OACb9pB,EAAYD,EAAIgqB,YAAY,KAC5B9pB,EAAWF,EAAIiqB,MAAMhqB,EAAY,EAAGD,EAAIuQ,QAE9CnQ,KAAK2d,KAAK/U,IAAV5I,UAAiBJ,GAAO,CAAEkqB,aAAc,SAAU3pB,UAAWJ,YAC3D,IAAM+J,EAAO,IAAIigB,KAAK,CAAChqB,GAAOD,EAAU,CACtCwF,KAAMvF,EAAKuF,KACX0kB,aAAcngB,KAAKogB,QAErBjqB,EAAKkqB,cAALlqB,OAA0B8J,GAAM3J,UAC7BgK,mBAAwBnK,EAAKmqB,oBAAoBrgB,EAAMK,IACvDA,mBAAiBnK,EAAKoqB,kBAAkBtgB,EAAMK,U5B54CzD3K,iC4Bk5CU2qB,SAAoBxqB,EAAYC,MACtC8H,OACE/H,EACAC,EACAI,KAAKkM,IACLlM,KAAKoe,eACLpe,KAAKU,mB5Bx5CXlB,+B4B45CU4qB,SAAkBzqB,EAAYC,MACpC8H,OACE/H,EACAC,EACAI,KAAKoe,eACLpe,KAAKU,mB5Bj6CXlB,oC4Bq6CU8pB,SAAuB3pB,GAC7B,IAAIC,EAAqBD,EACzB,OAGAC,GAHAA,EAAqBA,EAAmByqB,WAAW,KAC/CzqB,EAAmB0qB,OAAO,GAC1B1qB,GACoC2qB,SAAS,KAC7C3qB,EAAmBiqB,MAAM,GAAG,GAC5BjqB,GACsBymB,MAAM,O5B76CpC7mB,6B4B+6CUkqB,SACN/pB,EACAC,EACAC,EACAC,GAEAgK,WADA/J,IACA+J,kGAEA,GAAK9J,KAAKga,cAAV,CAGA,IAAM7P,EAAsB,CAC1BqgB,2BACAC,kBACAC,eACAplB,OACA3C,OAEIwQ,EAAyB,eAATtT,GAAkC,oBAATA,GAAuC,mBAATA,EACzE6W,EAAgB,CAClBjM,QAAkB,SAAT5K,EAAkB,eAC3B8qB,YAAWxX,EACXyX,YAAazX,EAAe,kBAC5BsI,MAAO7b,GAEI,QAATC,IACF6W,EAAgB,CAAEtR,OAAQ,CAAEokB,OAAQ5pB,EAAMirB,QAAS/qB,KAGrD4W,EAAgB6S,qBAA4B7V,OAAOC,OAAO,GAAI+C,EAAevM,IAE7EnK,KAAKmhB,cAAcxT,KACjB3N,KAAK8qB,aACFC,iBAAiB,CAChBC,OAAQlhB,EACR2V,QAAS1f,EACTggB,kBAED5f,UAAWwW,YACV3W,EAAKkM,IAAI+e,SAAStU,S5Bt9C5BnX,2C4B29CUiqB,SACN9pB,EACAC,GAEA,IAAMC,EAAcF,EAChBG,KACJ,IAAKD,IAAgBD,EACnB,OAAOE,EAET,IAAIC,EAAwB,GACxB+J,EAAyB,GACzBK,EAA0B,GAC1BgJ,EAA4B,GAChC,OAAItT,EAAYqrB,gBACdnrB,EAAwBF,EAAYqrB,eAElCrrB,EAAYsrB,kBACdrhB,EAAyBjK,EAAYsrB,iBAKT,MAA1BprB,IACFD,MAE6B,MAA3BgK,IACFhK,MAIFqK,EAAgBpK,EAAsBsmB,MAAM,KAC5ClT,EAAkBrJ,EAAuBuc,MAAM,MAC3Clc,EAAcmL,QAAQ1V,IAAkB,GAAMuK,EAAcmL,QAAQ1V,EAAewrB,aAAc,KACnGtrB,OAEEqT,EAAgBmC,QAAQ1V,IAAkB,GAAMuT,EAAgBmC,QAAQ1V,EAAewrB,aAAc,KACvGtrB,MAEKA,I5BjgDXN,+B4BogDUqa,yBACO,QAATla,OAAKkD,gBAAIlD,WAAEgD,KACb3C,KAAK8Z,YAAYuR,QAAQlrB,UAAWP,YAC9BA,GACFI,EAAKsrB,wBAITtrB,KAAKsrB,wB5B5gDX9rB,iC4BghDU8rB,sBACN,GAAItrB,KAAK8K,qBAAqBhC,mBAAoB,CAChD,IAAMnJ,EAAsCK,KAAK8K,qBAAqB3J,YAEtEnB,KAAKwnB,cAAc5c,KACf5K,KAAKurB,aAAanG,KAClB/b,GACA1J,IAGFK,KAAKwnB,cAAcvX,MAAMub,cAAcrrB,UAAWP,YAClDI,EAAK8K,qBAAqB3B,2BAC1BnJ,EAAKwnB,cAAc5c,kB5B5hD3BpL,uC4BiiDUiiB,SAA0B9hB,GAChC,GAAIK,KAAKuZ,UAAW,CAClB,IAAM3Z,EAAeD,EAAQ6T,KAAKyN,YAElC,OADiBjhB,KAAKuZ,UAAUnV,QACfxE,EAMnB,W5B3iDJJ,0C4B8iDUkiB,WACN,GAAG1hB,KAAKuZ,UAAW,CACjB,IAAM5Z,EAAYK,KAAKuZ,UACvB,GAAG5Z,EAAU2M,QAAU3M,EAAU4f,mBAAmBtP,OAASjQ,KAAKwW,eAAeyC,uBAC/E,SAGJ,W5BrjDJzZ,uC4BwjDEisB,SAA0B9rB,cACxB,GAAkB,MAAdA,WAAgBwQ,OAApB,WACsBxQ,GADtB,yBACaC,EADb8rB,QAEU7rB,EAAoBG,EAAK2rB,eAAe9f,MAAMmV,KAAKlhB,mBAAaF,EAAMyM,QAAQkN,UAAUqS,YAAYle,SAAS5N,EAAU8C,MAC5G,MAAjB/C,KAAmB2T,KAAKqY,cAAcC,QAAQ7L,QAAQngB,aAEnC,SAAbA,EAAIwF,MAAgC,iBAAbxF,EAAIwF,OAC7BtF,EAAK+rB,wBAAwBC,gBAAgBlsB,EAAImsB,SAASC,OAAO/rB,UAAUJ,YACzED,EAAIqsB,aAAepsB,OAN3B,2BAAoCqsB,IADtC,oC5BzjDJ5sB,K4BgkDiCO,sBC1kDjCkC,gEDoHawU,IAAexU,mXAAfwU,GAAexL,mDA8DMhJ,OA9DNgJ,gBA4DOhJ,iBAEDA,mmHDpLlCA,mCACEA,+BAEEA,0BAEEA,gCAASrC,sBACXqC,QAEAA,oCAKAA,mCAkBAA,yBAEEA,4DAA0B,gCACZrC,mBAChBqC,QAEAA,+BAmBEA,iCAASrC,iBAATqC,CAA4B,kCAGZrC,wBAHhBqC,CAA4B,qCAMRrC,2BANpBqC,CAA4B,qCAQRrC,4BAEpBqC,8BACAA,6BAGAA,gCACAA,6BACAA,mCACAA,iCAIAA,2CAMAA,mCACAA,6CAQAA,sCAMAA,uCAIFA,QAEAA,8CAMFA,QACFA,QAEAA,6DA2FAA,6CAEEA,2EAEAA,mBACEA,sBAGEA,oEACAA,wBACFA,QACFA,QAEAA,oEAMFA,QAEAA,wDAaAA,mEA1OMA,wCAIgBA,wCAKDA,uCAmBfA,4BAAW,0BAQXA,kDAAiC,mCAAjCA,CAAiC,kEAAjCA,CAAiC,2BAAjCA,CAAiC,4BAAjCA,CAAiC,uBAAjCA,CAAiC,mBAAjCA,CAAiC,+BAAjCA,CAAiC,iCAAjCA,CAAiC,YAAjCA,CAAiC,mBAAjCA,CAAiC,sDAAjCA,CAAiC,4CAAjCA,CAAiC,qCA0BKA,4CACrBA,4BAAW,2CAGTA,4BACHA,4BACMA,4BACFA,4BAAW,0CAAXA,CAAW,0CAK5BA,4CAKkBA,oEAAmD,aAErEA,6CAQAA,kCAKsBA,4BAAW,mDAAXA,CAAW,oBAOpCA,wDAAuC,gGAS1CA,4FA2FDA,gCAAoB,yCAajBA,yDAOaA,glbCrHJ,CEhGL,IACLgM,OAAQ,qBAAsB,IAC5BA,OACE,UACAA,OAAM,CACJ8W,KAAM,MACN,YAAa,aAGjB9W,OACE,kBACAA,OAAM,CACJ8W,KAAM,MACNsH,OAAQ,MACR,YAAa,aAGjBpe,OACE,gBACAA,OAAM,CACJE,QAAS,aAGbF,OACE,YACAA,OAAM,CACJ8W,KAAM,0BAGV9W,OACE,aACAA,OAAM,CACJ8W,KAAM,QACN,YAAa,2BAGjB9W,OACE,yBACAA,OAAM,CACJ8W,KAAM,QACNsH,OAAQ,MACR,YAAa,2BAGjBpe,OAAW,YAAUA,OAAQ,eAE/BA,OAAQ,eAAgB,IACtBA,OACE,UACAA,OAAM,CACJoe,OAAQ,aAGZpe,OACE,WACAA,OAAM,CACJoe,OAAQ,YAQT,IACLpe,OAAQ,0BAA2B,IACjCA,OACE,UACAA,OAAM,CACJE,QAAS,aAGbF,OAAW,eAAaA,OAAQ,WAChCA,OAAW,YAAUA,OAAQ,eAE/BA,OAAQ,oBAAqB,IAC3BA,OACE,kBACAA,OAAM,CACJ8W,KAAM,YAGV9W,OACE,cACAA,OAAM,CACJ8W,KAAM,YAGV9W,OACE,iBACAA,OAAM,CACJ8W,KAAM,YAGV9W,OACE,iBACAA,OAAM,CACJ8W,KAAM,0BAGV9W,OACE,qBACAA,OAAM,CACJ8W,KAAM,0BAGV9W,OACE,wBACAA,OAAM,CACJ8W,KAAM,0BAGV9W,OAAW,iCAA+BA,OAAQ,aAClDA,OAAW,iCAA+BA,OAAQ,aAClDA,OAAW,iCAA+BA,OAAQ,aAClDA,OAAW,iCAA+BA,OAAQ,aAClDA,OAAW,uCAAqCA,OAAQ,aACxDA,OAAW,uCAAqCA,OAAQ,eAI1DA,OAAQ,oBAAqB,IAC3BA,OACE,iBACAA,OAAM,CACJoe,OAAQ,UAGZpe,OACE,6BACAA,OAAM,CACJoe,OAAQ,QACRrB,OAAQ,YAGZ/c,OACE,6BACAA,OAAM,CACJoe,OAAQ,QACRrB,OAAQ,UAGZ/c,OACE,sCACAA,OAAM,CACJoe,OAAQ,QACRrB,OAAQ,YAGZ/c,OACE,sCACAA,OAAM,CACJoe,OAAQ,QACRrB,OAAQ,UAGd/c,OAAW,gCAA8BA,OAAQ,YACjDA,OAAW,wDAAsDA,OAAQ,aACzEA,OAAW,wDAAsDA,OAAQ,aACzEA,OAAW,0EAAwEA,OAAQ,aAC3FA,OAAW,0EAAwEA,OAAQ,aAMtF,IACLA,OAAQ,kBAAmB,IACzBA,OAAM,WAASA,OAAM,QACrBA,OACE,wBACAA,OAAM,CACJoe,OAAQ,YAGZpe,OACE,iCACAA,OAAM,CACJoe,OAAQ,cAGZpe,OACE,2CACAA,OAAM,CACJoe,OAAQ,cAGZpe,OACE,yBACAA,OAAM,CACJoe,OAAQ,aAGZpe,OACE,wBACAA,OAAM,CACJoe,OAAQ,cAGZpe,OACE,MACAA,OAAM,CACJoe,OAAQ,oBAGZpe,OACE,kCACAA,OAAM,CACJoe,OAAQ,2BAGZpe,OACE,iCACAA,OAAM,CACJoe,OAAQ,4BAGZpe,OAAW,YAAUA,OAAQ,eAE/BA,OAAQ,gBAAiB,IACvBA,OACE,SACAA,OAAM,CACJoe,OAAQ,aAGZpe,OAAW,YAAUA,OAAQ,gBAM1BA,OAAQ,gBAAiB,IAC9BA,OACE,UACAA,OAAM,CACJ8W,KAAM,aAGV9W,OACE,WACAA,OAAM,CACJ8W,KAAM,cAGV9W,OAAW,YAAUA,OAAQ,eAKxBA,OAAQ,gBAAiB,IAC9BA,OAAM,WAASA,OAAM,QACrBA,OACE,wBACAA,OAAM,CACJoe,OAAQ,MACR,cAAe,YAGnBpe,OACE,iCACAA,OAAM,CACJoe,OAAQ,QACR,cAAe,cAGnBpe,OACE,2CACAA,OAAM,CACJoe,OAAQ,QACR,cAAe,cAGnBpe,OAAW,YAAUA,OAAQ,eAKxBA,OAAQ,YAAa,IAC1BA,OACE,UACAA,OAAM,CACJ8W,KAAM,UAGV9W,OACE,WACAA,OAAM,CACJ8W,KAAM,UAGV9W,OAAW,YAAUA,OAAQ,eAIxBA,OAAQ,YAAa,IAC1BA,OACE,OACAA,OAAM,CACJoe,OAAQ,UAGZpe,OAAW,YAAUA,OAAQ,gB9B9SjCzO,I+BSO8sB,G/BTP9sB,W+BaEE,WACYC,EACFC,EACAC,EACAC,EACAC,EACA+J,EACAK,EACAgJ,EACAuD,aARE1W,uBACFA,qBACAA,wBACAA,gCACAA,gBACAA,oBACAA,mBACAA,sBACAA,kBAXFA,gBAAa,aAanBA,KAAKusB,WAAWlsB,kBAChBL,KAAKU,gBAAgBC,UAAU6rB,eAAexsB,KAAKU,gBAAgB+rB,eAAetsB,YAElFH,KAAK0sB,WAAa1sB,KAAKkB,cAAcC,UAAU,QAE/CnB,KAAK2sB,kBACL3sB,KAAK4sB,kBACL5sB,KAAK6sB,wBAEL7sB,KAAK8sB,yBAAyBC,SAE9B/sB,KAAKgtB,mB/BnCTxtB,yC+BsCUmtB,sBACN3sB,KAAKU,gBAAgBC,UAAUiI,IAAI5I,KAAKkB,cAAcC,UAAU,UAAUhB,UAAUR,YAC9EA,IACFK,EAAKitB,aAAaC,SAASvtB,GAC3BK,EAAKmtB,YAAYC,OAAO,CAAE1oB,KAAM,QAAS2oB,QAAS1tB,S/B1C1DH,6B+B+CUotB,WACN,IAAMjtB,EAAQK,KAAKkB,cAAcC,UAAU,UAAYnB,KAAKstB,WACxD3tB,GACFK,KAAKutB,SAASC,SAAS/G,SAASgH,KAAM9tB,K/BlD5CH,mC+BsDUqtB,WACN,IAAMltB,EAAcK,KAAKkB,cAAcC,UAAU,eAC7CxB,GACFK,KAAKmtB,YAAYC,OAAO,CAAE1oB,KAAM,cAAe2oB,QAAS1tB,M/BzD9DH,8B+B6DUwtB,sBAQN,GAPmBzD,eAAoB,CACrChf,GAAI,OACJmjB,OAAQ,MACRC,QAAS,MACTC,OAAQ,SAGM,CACd,IAAMhuB,EAAYI,KAAKU,gBAAgBC,UACjCd,EAASD,EAAUgJ,IAAI,oBACvB9I,EAAWF,EAAUgJ,IAAI,yBAC/B8V,MAAI7e,EAAQC,GACTU,QACC+J,KAAI,+BAAuB,CACzBnG,MADEypB,KAEFC,QAFED,SAKL1tB,UAAWJ,mBACVC,EAAKoe,eAAe2P,MAAMhuB,EAAI+tB,QAAS/tB,EAAIqE,MAAO,CAChD2a,QAAS,c/BlFrBvf,K+BkFqB8sB,uCAzERA,IAAYrqB,qIAAZqqB,GAAYrhB,iJFrBzBhJ,yBAEAA,kCAEAA,+BAFgBA,wW7BUhBzC,IgC0DOwuB,GhC1DPxuB,wBgC0DOwuB,uCAAMA,iCAASC,WAFR3B,oCApBD,IACThlB,MAAqB,CACnB4mB,QAAS9rB,MACT+rB,KAAM,yBAER7mB,QACAI,YACAA,YACAA,YACAA,YACAA,YACAA,YACAA,YACAA,YACAA,SACA,CAAC0mB,QAASnsB,MAAiBosB,WASxB,SAA+BtgB,EAAkCpO,EAAwBC,GAC9F,OAAO,kBAAM,IAAIsf,QAAcrf,YAC3BkO,EAAgBpN,UAAU6rB,eAAeze,EAAgB0e,eAAetsB,UAAU,WAChF8J,QAAQoU,KAARpU,oCAA0C8D,EAAgB0e,cAA1DxiB,iBACAtK,EAAWsB,iBACVnB,YACDmK,QAAQqkB,MAARrkB,wBAA+B8D,EAAgB0e,cAA/CxiB,iCACC,WACDpK,EAAQ,YAjBkD0uB,KAAM,CAACjnB,KAAiB7H,EAAYwC,OAAWusB,WAAO,EACpH9mB,OAAwB,CACtBymB,KAAM,8BAETM,SAhCQ,CACPnvB,KACAovB,KACAC,aAAqB,IACrBC,eACAtnB,eACAA,KACAC,KACAA,KACAY,EACA7I,KACAuvB,cAA6B,iBAAkB,CAAEvqB,QAASlC,aAAwB0sB,qBAAsB,wCCtCxG1sB,iBACFH,SAGF3C,OACGyvB,gBAAgBf,IADnB1uB,MAESyO,mBAAO9D,QAAQC,IAAI6D,4BCd5B,OACA,uBACA,yBACA,yBACA,sBACA,sBACA,8BACA,kBACA,uBACA,yBACA,0BACA,uBACA,sBACA,8BACA,mBAIA,cACA,WACA,YAEA,cACA,cACA,8CACA,gCACAzG,EAEA,YAEArF,kBACA,uBAEAA,YACAzC,YACAyC,kCCnCA,OACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,YACA,eACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,YACA,eACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,sBACA,mBACA,sBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,eACA,kBACA,gBACA,aACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,YACA,eACA,YACA,eACA,YACA,eACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,iBACA,oBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,aACA,gBACA,YACA,eACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,cACA,iBACA,aACA,gBACA,cACA,iBACA,cACA,mBACA,sBACA,iBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,mBACA,sBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,oBAIA,cACA,WACA,YAEA,cACA,cACA,8CACA,gCACAqF,EAEA,YAEArF,kBACA,uBAEAA,YACAzC,YACAyC","names":["_","T","b","B","constructor","t","n","o","i","r","this","isEnabled","Te","subscribe","checkForUpdate","checkForUpdates","updates","available","pipe","z","languageService","translate","instant","confirm","window","location","reload","initPwaPrompt","configService","getConfig","platform","IOS","addEventListener","preventDefault","promptEvent","listenToUserAction","once","showPrompt","prompt","userChoice","analyticsService","trackEvent","outcome","e","factory","fac","ce","production","igo","app","forceCoordsNA","analytics","provider","url","id","auth","tokenKey","allowAnonymous","trustHosts","hostsByKey","domainRegFilters","keyProperty","keyValue","catalog","sources","depot","importExport","formats","clientSideFileSizeMaxMb","language","prefix","interactiveTour","activateInteractiveTour","tourInMobile","pathToConfigFile","searchSources","nominatim","storedqueries","title","searchUrl","enabled","storedquery_id","srsname","fields","name","defaultValue","splitPrefix","resultTitle","storedqueriesreverse","order","showInPointerSummary","longField","latField","icherche","params","limit","type","coordinatesreverse","icherchereverse","ilayer","cadastre","projections","code","alias","def","extent","searchOverlayStyle","base","markerColor","markerOpacity","markerOutlineColor","fillColor","fillOpacity","strokeColor","strokeOpacity","strokeWidth","focus","selection","queryOverlayStyle","I","x","D","O","M","xe","ke","Ee","E","h","d","W","_e","l","L","N","F","H","J","oe","A","we","Q","y","R","igoVersionDifferentFromStorage","isVersionDifferentFromStorage","setStorageConfig","nbVisit","Number","storageService","get","set","hasWelcomeWindow","remove","disableClose","autoFocus","maxWidth","afterClosedWelcomeWindow","showAgain","q","se","w","ngOnInit","computeHtml","closeWelcomeWindow","dialog","closeAll","Date","p","isNaN","getDate","console","log","m","getMonth","getFullYear","title$$","ie","description","version","releaseDate","html$","next","setShowAgain","welcomeWindowService","ngOnDestroy","unsubscribe","selectors","V","_map","_opened","openedChange","emit","toolState","toolbox","activeTool$$","activeTool$","catalogState","catalogStore","all","_step","state","selected","title$","map","layers","_step2","options","active","toolChange","onPreviousButtonClick","activatePreviousTool","onUnselectButtonClick","deactivateTool","X","ngAfterViewInit","context$$","contextService","context$","handleContextChange","context","media$$","mediaService","media$","mapOverlay","_step3","media","getMedia","includes","push","G","opened","withHeader","a","arguments","s","opacity","display","changeDetection","K","_expanded","expandedChange","expanded","onToggleClick","ee","_backdropShown","maximized","onBackdropClick","backdropShown","P","fullExtent","Ce","zoomAuto","setResizeWindowIcon","storageState","_store","store","entities$","unselectResult","_zoomAuto","zoomAuto$","_fullExtent","fullExtent$","fullExtentEvent","getClassPanel","isHtmlDisplay","resultSelected$","value","results","length","initialized","selectResult","onEscapeHandler","clear","onBackHandler","onZoomHandler","isResultSelected$","getValue","format","readFeature","data","dataProjection","projection","featureProjection","multiple$","monitorResultOutOfView","isSelectedResultOutOfView$$","he","viewController","state$","isSelectedResultOutOfView$","hasFeatureEmphasisOnSelection","resultOrResolution$$","focusedResult$","Pe","resolution$","buildResultEmphasis","storageChange$$","storageChange$","j","key","currentValue","actionStore","load","icon","tooltip","handler","availability","multiple","_step4","_iterator4","checkbox","checkCondition","isDesktop","clearFeatureEmphasis","getGeometry","getExtent","u","nt","geometry","ot","abstractFocusedOrSelectedResult","meta","style","Object","assign","feature","queryState","queryOverlayStyleSelection","queryOverlayStyleFocus","setZIndex","queryResultsOverlay","addFeature","removeFeature","getTitle","focusResult","unfocusResult","focused","update","properties","target","setHtmlDisplay","_step5","removeFeatures","addFeatures","_step6","setFeatures","isMobile","handleKeyboardEvent","keyCode","previousResult","nextResult","indexOf","zoomTo","swipe","SWIPE_ACTION","RIGHT","LEFT","UP","DOWN","className","onTriggerAction","args","windowHtmlDisplayEvent","isHtmlAndDesktop","iconResizeWindows","resizeWindows","reduceWindow","enlargeWindows","oxw","workspaceState","te","g","f","C","S","k","Z","le","ue","Rt","Zt","zt","It","Dt","Wt","Lt","Ht","Jt","Qt","Yt","Nt","pageSize","pageSizeOptions","hasExpansionPanel","hasHomeExtentButton","hasGeolocateButton","showRotationButtonIfNoRotation","showMenuButton","showSearchBar","igoSearchPointerSummaryEnabled","mapState","sidenavOpened$","_toastPanelOpened","cdRef","detectChanges","isTablet","isLandscape","getOrientation","isPortrait","sidenavOpened","workspacePanelExpanded","expansionPanelExpanded","toastPanelForExpansionOpened","actionbarMode","searchState","searchResultsGeometryEnabled$","workspace","hasWidget","workspace$","IGO","searchTermSplitter$","termSplitter","initWelcomeWindow","authService","authenticate$","contextLoaded","contextState","onChangeContext","contextMenuStore","searchCoordinate","contextMenuCoord","openGoogleMaps","openGoogleStreetView","queryStore","count$","$e","padding","toastPanelOpened","ol","readQueryParams","onSettingsChange$","setSearchSettingsChange","selectedResult$","closeSidenav","workspaceEnabled$","empty$","updateMapBrowserClass","workspaceMaximize$$","workspaceMaximize$","selectedWorkspace$","layer","paginatorOptions","activeWidget$$","activeWorkspaceWidget$","openToastPanelForExpansion","showToastPanelForExpansionToggle","closeToastPanelForExpansion","openSidenav$$","openSidenav$","openSidenav","sidenavMediaAndOrientation$$","orientation$","computeToastPanelOffsetX","initSW","mapRtssProximityState","currentRTSSCh$","mapProximityState","proximityFeatureStore","insert","num_rts","substring","chainage","Math","floor","padWithZero","infoContent","distance","activateTool","String","padStart","navigator","serviceWorker","ready","then","http","me","appData","assetGroups","urls","concat","files","filter","ve","messageService","info","disableTimeOut","progressBar","closeButton","tapToDismiss","ae","apply","geoDBService","toastId","success","timeOut","setToastPanelHtmlDisplay","toastPanelHtmlDisplay","Promise","resolve","toastPanelOffsetX$","getToastPanelExtent","workspaceVisibility","inResolutionRange$","entityStore","visible","workspaceNotAvailableMessage","isEditionWorkspace","createFeatureProperties","rowsInMapExtentCheckCondition$","editFeature","sourceOptions","sourceFields","forEach","primary","paginatorChange","workspacePaginator","entitySortChange","workspaceEntitySortChange$","entitySelectChange","getQuerySearchSource","getLayerWksOptionTabQuery","added","getProperties","_featureStore","queryService","getAllowedFieldsAndAlias","getQueryTitle","find","sourceTitle","cancelOngoingAddLayer","addedLayers$$","onToggleSidenavClick","toggleSidenav","onDeactivateWorkspaceWidget","onMapQuery","features","getFeatureIsSameActiveWks","getWksActiveOpenInResolution","getLayerWksOptionMapQuery","onSearchTermChange","routeParams","search","deactivateCustomFilterTermStrategy","setSearchTerm","replace","trim","onClearSearch","onBeforeSearch","onSearch","research","source","searchSourceService","getEnabledSources","searchStore","updateMany","onSearchResultsGeometryStatusChange","setSearchResultsGeometryStatus","onSearchSettingsChange","toolChanged","searchBar","nativeElement","getElementsByTagName","computeHomeExtentValues","view","homeExtent","homeCenter","center","homeZoom","zoom","empty","softClear","route","queryParams","uri","readLayersQueryParams","getTool","toolToOpenOnContextChange","_i2","toastOpenedChange","handleExpansionAndToastOnMobile","searchResultsOverlay","setSelectedResult","getSources","onContextMenuOpen","getClickCoordinate","mapBrowser","getBoundingClientRect","top","scrollY","pageYOffset","left","scrollX","pageXOffset","getCoordinateFromPixel","Se","open","searchBarTerm","toFixed","join","classList","add","onPointerSummaryStatusChange","getExpansionPanelStatus","getToastPanelOffsetY","getToastPanelStatus","getControlsOffsetY","getBaselayersSwitcherStatus","readToolParams","readSearchParams","readFocusFirst","computeZoomToExtent","zoomExtent","split","zoomToExtent","computeFocusFirst","setTimeout","document","item","click","sf","termDefinedInUrl","stateView","all$","ye","termDefinedInUrlTriggered","exactMatch","activateCustomFilterTermStrategy","entity","dataType","searchGeom","tool","matDialogRef$","re","sidenav","routing","routingOptions","parseInt","directionState","stopsStore","storeInitialized$","position","text","coordinates","debounceTime","routesFeatureStore","zoomToActiveRoute$","readLayersQueryParamsByType","readVectorQueryParams","getQueryParam","be","fromString","wmsLayers","wmsUrl","wmtsLayers","wmtsUrl","arcgisLayers","arcgisUrl","iarcgisLayers","iarcgisUrl","tarcgisLayers","tarcgisUrl","extractLayersByService","de","LAYERS","computeLayerVisibilityFromUrl","addLayerFromURL","vector","lastIndexOf","slice","responseType","File","lastModified","now","importService","onFileImportSuccess","onFileImportError","startsWith","substr","endsWith","optionsFromCapabilities","optionsFromApi","crossOrigin","queryable","queryFormat","VERSION","layerService","createAsyncLayer","zIndex","addLayer","visiblelayers","invisiblelayers","toString","logged$","createWelcomeWindow","dialogWindow","afterClosed","refreshRelationsWorkspace","_step7","workspaceStore","workspaceId","tableTemplate","columns","editionWorkspaceService","getDomainValues","relation","table","domainValues","_loop","bottom","ne","pwaService","getTranslation","getLanguage","authConfig","readTitleConfig","readThemeConfig","readDescriptionConfig","analyticsListenerService","listen","detectOldBrowser","titleService","setTitle","metaService","addTag","content","themeClass","renderer","addClass","body","chrome","firefox","safari","_ref4","message","alert","Y","bootstrap","default","path","provide","useFactory","error","deps","multi","imports","v","$","pe","ge","registrationStrategy","bootstrapModule"],"sources":["webpack:///$_lazy_route_resources|lazy|groupOptions:%20%7B%7D|namespace%20object","webpack:///src/app/services/pwa.service.ts","webpack:///src/environments/environment.github.ts","webpack:///src/app/pages/portal/map-overlay/map-overlay.module.ts","webpack:///src/app/pages/portal/expansion-panel/expansion-panel.module.ts","webpack:///src/app/pages/portal/toast-panel/toast-panel.module.ts","webpack:///src/app/pages/portal/sidenav/sidenav.module.ts","webpack:///src/app/pages/portal/toast-panel-for-expansion/toast-panel-for-expansion.module.ts","webpack:///src/app/pages/portal/welcome-window/welcome-window.module.ts","webpack:///src/app/pages/portal/portal.module.ts","webpack:///src/app/pages/portal/welcome-window/welcome-window.service.ts","webpack:///src/app/pages/portal/welcome-window/welcome-window.component.html","webpack:///src/app/pages/portal/welcome-window/welcome-window.component.ts","webpack:///src/app/pages/portal/sidenav/sidenav.component.html","webpack:///src/app/pages/portal/sidenav/sidenav.component.ts","webpack:///src/app/pages/portal/map-overlay/map-overlay.component.html","webpack:///src/app/pages/portal/map-overlay/map-overlay.component.ts","webpack:///src/app/pages/portal/toast-panel-for-expansion/toast-panel-for-expansion.component.ts","webpack:///src/app/pages/portal/expansion-panel/expansion-panel-header.component.html","webpack:///src/app/pages/portal/toast-panel-for-expansion/toast-panel-for-expansion.component.html","webpack:///src/app/pages/portal/toast-panel-for-expansion/toast-panel-for-expansion.animations.ts","webpack:///src/app/pages/portal/expansion-panel/expansion-panel-header.component.ts","webpack:///src/app/pages/portal/expansion-panel/expansion-panel.component.ts","webpack:///src/app/pages/portal/expansion-panel/expansion-panel.component.html","webpack:///src/app/pages/portal/expansion-panel/expansion-panel.animations.ts","webpack:///src/app/pages/portal/toast-panel/toast-panel.component.html","webpack:///src/app/pages/portal/toast-panel/toast-panel.component.ts","webpack:///src/app/pages/portal/portal.component.html","webpack:///src/app/pages/portal/portal.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/pages/portal/portal.animation.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/main.ts","webpack:///node_modules/@igo2/core/locale|sync|/^/.*/.json$","webpack:///node_modules/moment/locale|sync|/^/.*$"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 98255;\nmodule.exports = webpackEmptyAsyncContext;","import { Injectable } from '@angular/core';\r\nimport { Platform } from '@angular/cdk/platform';\r\nimport { AnalyticsService, ConfigService, LanguageService } from '@igo2/core';\r\nimport { SwUpdate } from '@angular/service-worker';\r\nimport { interval } from 'rxjs';\r\nimport { debounceTime } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PwaService {\r\n  promptEvent: any;\r\n  constructor(\r\n    private platform: Platform,\r\n    private analyticsService: AnalyticsService,\r\n    public updates: SwUpdate,\r\n    public languageService: LanguageService,\r\n    private configService: ConfigService\r\n  ) {\r\n    if (updates.isEnabled) {\r\n      interval(60 * 1000 * 2).subscribe(() => updates.checkForUpdate());\r\n    }\r\n  }\r\n\r\n  public checkForUpdates(): void {\r\n\r\n    if (this.updates.isEnabled) {\r\n      this.updates.available\r\n      .pipe(debounceTime(25000))\r\n      .subscribe(() => {\r\n        const title = this.languageService.translate.instant('pwa.new-version-title');\r\n        const body = this.languageService.translate.instant('pwa.new-version');\r\n        const message = `${title} ${body}`;\r\n          if(confirm(message)) {\r\n              window.location.reload();\r\n          }\r\n      });\r\n  }\r\n  }\r\n\r\n  public async initPwaPrompt() {\r\n    const promotePWA = this.configService.getConfig('promotePWA');\r\n    if (promotePWA) {\r\n      if (!this.platform.IOS) {\r\n        window.addEventListener('beforeinstallprompt', (event: any) => {\r\n          event.preventDefault();\r\n          this.promptEvent = event;\r\n          this.listenToUserAction();\r\n        }, { once: true });\r\n      }\r\n    }\r\n  }\r\n\r\n  private listenToUserAction() {\r\n    window.addEventListener('click', () => { this.showPrompt(); }, { once: true });\r\n  }\r\n\r\n  private async showPrompt() {\r\n    this.promptEvent.prompt();\r\n    const outcome = await this.promptEvent.userChoice;\r\n    this.analyticsService.trackEvent('app', 'installPwa', outcome.outcome);\r\n    this.promptEvent = undefined;\r\n  }\r\n}\r\n","import { AuthOptions } from '@igo2/auth';\r\nimport { AnalyticsOptions, LanguageOptions } from '@igo2/core';\r\nimport {\r\n  SearchSourceOptions,\r\n  CatalogServiceOptions,\r\n  Projection,\r\n  ImportExportServiceOptions,\r\n  CommonVectorStyleOptions\r\n} from '@igo2/geo';\r\n\r\ninterface Environment {\r\n  production: boolean;\r\n  igo: {\r\n    app: {\r\n      forceCoordsNA: boolean;\r\n    };\r\n    analytics: AnalyticsOptions\r\n    auth?: AuthOptions;\r\n    catalog?: CatalogServiceOptions;\r\n    importExport?: ImportExportServiceOptions;\r\n    language?: LanguageOptions;\r\n    searchSources?: { [key: string]: SearchSourceOptions };\r\n    projections?: Projection[];\r\n    interactiveTour?: { activateInteractiveTour: boolean, tourInMobile: boolean; pathToConfigFile: string };\r\n    depot?: { url: string; trainingGuides?: string[]; };\r\n    queryOverlayStyle?: {\r\n      base?: CommonVectorStyleOptions,\r\n      selection?: CommonVectorStyleOptions,\r\n      focus?: CommonVectorStyleOptions\r\n    };\r\n    searchOverlayStyle?: {\r\n      base?: CommonVectorStyleOptions,\r\n      selection?: CommonVectorStyleOptions,\r\n      focus?: CommonVectorStyleOptions\r\n    };\r\n  };\r\n}\r\n\r\nexport const environment: Environment = {\r\n  production: true,\r\n  igo: {\r\n    app: {\r\n      forceCoordsNA: true\r\n    },\r\n    analytics: {\r\n      provider: \"matomo\",\r\n      url: \"https://geoegl.msp.gouv.qc.ca/matomo/\",\r\n      id: \"38\"\r\n    },\r\n    auth: {\r\n      // url: '/apis/users',\r\n      tokenKey: 'id_token_igo',\r\n      allowAnonymous: true,\r\n      trustHosts: ['geoegl.msp.gouv.qc.ca']\r\n      ,hostsByKey: [{\r\n        domainRegFilters: '(https:\\/\\/|http:\\/\\/)?(.*geoegl.msp.gouv.qc.ca\\/apis)(.*)',\r\n        keyProperty: 'key',\r\n        keyValue: 'd8UA0Y9iMIynBa',\r\n     }]\r\n    },\r\n    catalog: {\r\n      sources: []\r\n    },\r\n    depot: {\r\n      url: '/apis/depot'\r\n    },\r\n    importExport: {\r\n      url: 'https://geoegl.msp.gouv.qc.ca/apis/ogre',\r\n      formats: ['GeoJSON'],\r\n      clientSideFileSizeMaxMb: 75\r\n    },\r\n    language: {\r\n      prefix: ['./locale/', './locale/offline/']\r\n    },\r\n    interactiveTour: {\r\n      activateInteractiveTour: false,\r\n      tourInMobile: true,\r\n      pathToConfigFile: './config/interactiveTour.json'\r\n    },\r\n    searchSources: {\r\n      nominatim: {\r\n        available: false\r\n      },\r\n      storedqueries: {\r\n        title: 'Rseau routier Transports Qubec',\r\n        searchUrl: 'https://ws.mapserver.transports.gouv.qc.ca/swtq',\r\n        available: true,\r\n        enabled: true,\r\n        storedquery_id: 'rtss',\r\n        srsname: 'epsg:4326',\r\n        fields: [\r\n          { name: 'rtss', defaultValue: '-99' },\r\n          { name: 'chainage', defaultValue: '0', splitPrefix: '\\\\+' }\r\n        ],\r\n        resultTitle: 'title'\r\n      } as any,\r\n      storedqueriesreverse: {\r\n        order: 1,\r\n        showInPointerSummary: false,\r\n        title: 'Limite territoriale MTQ (par coordonnes)',\r\n        searchUrl: 'https://ws.mapserver.transports.gouv.qc.ca/swtq',\r\n        enabled: true,\r\n        available: true,\r\n        storedquery_id: 'dgt_latlon',\r\n        srsname: 'epsg:4326',\r\n        longField: 'long',\r\n        latField: 'lat',\r\n        resultTitle: 'nom_unite_'\r\n      } as any,\r\n      icherche: {\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche',\r\n        order: 2,\r\n        params: {\r\n          limit: '8',\r\n          type:'adresses,codes-postaux,routes,intersections,municipalites,mrc,regadmin,lieux,sorties-autoroute,bornes-km'\r\n        }\r\n      },\r\n      coordinatesreverse: {\r\n        showInPointerSummary: true\r\n      },\r\n      icherchereverse: {\r\n        showInPointerSummary: true,\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/terrapi',\r\n        order: 3,\r\n        enabled: true\r\n      },\r\n      ilayer: {\r\n        searchUrl: 'https://geoegl.msp.gouv.qc.ca/apis/icherche/layers',\r\n        available: false,\r\n        order: 4,\r\n        params: {\r\n          limit: '5'\r\n        }\r\n      },\r\n      cadastre: {\r\n        enabled: false\r\n      }\r\n    },\r\n    projections: [\r\n      {\r\n        code: 'EPSG:32198',\r\n        alias: 'Quebec Lambert',\r\n        def:\r\n          '+proj=lcc +lat_1=60 +lat_2=46 +lat_0=44 +lon_0=-68.5 +x_0=0 +y_0=0 \\\r\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\r\n        extent: [-799574, 45802, 891595.4, 1849567.5]\r\n      },\r\n      {\r\n        code: 'EPSG:3798',\r\n        alias: 'MTQ Lambert',\r\n        def:\r\n          '+proj=lcc +lat_1=50 +lat_2=46 +lat_0=44 +lon_0=-70 +x_0=800000 +y_0=0 \\\r\n          +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\r\n        extent: [31796.5834, 158846.2231, 1813323.4284, 2141241.0978]\r\n      }\r\n    ],\r\n    searchOverlayStyle: {\r\n      base: {\r\n        markerColor: '#5ed0fb', // marker fill\r\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#a7e7ff', // marker contour\r\n        fillColor: '#5ed0fb', // poly\r\n        fillOpacity: 0.2, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#5ed0fb', // line and poly\r\n        strokeOpacity: 0.7, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      focus: {\r\n        markerColor: '#00A1DE', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#DFF7FF', // marker contour\r\n        fillColor: '#00A1DE', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#00A1DE', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      selection: {\r\n        markerColor: '#FFFF33', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#000000', // marker contour\r\n        fillColor: '#FFFF33', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#FFFF33', // line and poly\r\n        strokeOpacity: 0.75, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 4 // line and poly\r\n      }\r\n    },\r\n    queryOverlayStyle: {\r\n      base: {\r\n        markerColor: '#136dbd', // marker fill\r\n        markerOpacity: 0.8, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#a7e7ff', // marker contour\r\n        fillColor: '#136dbd', // poly\r\n        fillOpacity: 0, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#136dbd', // line and poly\r\n        strokeOpacity: 1, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 2 // line and poly\r\n      },\r\n      focus: {\r\n        markerColor: '#00A1DE', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#DFF7FF', // marker contour\r\n        fillColor: '#00A1DE', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#00A1DE', // line and poly\r\n        strokeOpacity: 0.6, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 7 // line and poly\r\n      },\r\n      selection: {\r\n        markerColor: '#02f7e7', // marker fill\r\n        markerOpacity: 1, // marker opacity not applied if a rgba markerColor is provided\r\n        markerOutlineColor: '#000000', // marker contour\r\n        fillColor: '#02f7e7', // poly\r\n        fillOpacity: 0.3, // poly fill opacity not applied if a rgba fillColor is provided\r\n        strokeColor: '#02f7e7', // line and poly\r\n        strokeOpacity: 0.8, // line and poly not applied if a rgba strokeColor is provided\r\n        strokeWidth: 10 // line and poly\r\n      }\r\n    }\r\n  }\r\n};\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n\r\nimport { MapOverlayComponent } from './map-overlay.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [MapOverlayComponent],\r\n  declarations: [MapOverlayComponent]\r\n})\r\nexport class MapOverlayModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatListModule } from '@angular/material/list';\r\nimport { MatMenuModule } from '@angular/material/menu';\r\nimport { MatSelectModule } from '@angular/material/select';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoBackdropModule } from '@igo2/common';\r\n\r\nimport { ExpansionPanelComponent } from './expansion-panel.component';\r\nimport { ExpansionPanelHeaderComponent } from './expansion-panel-header.component';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatMenuModule,\r\n    MatListModule,\r\n    MatSelectModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule,\r\n    IgoBackdropModule\r\n  ],\r\n  exports: [ExpansionPanelComponent],\r\n  declarations: [ExpansionPanelComponent, ExpansionPanelHeaderComponent]\r\n})\r\nexport class AppExpansionPanelModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatMenuModule } from '@angular/material/menu';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\n\r\nimport { IgoPanelModule, IgoStopPropagationModule, IgoActionModule } from '@igo2/common';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoFeatureModule, IgoSearchResultsModule } from '@igo2/geo';\r\n\r\nimport { ToastPanelComponent } from './toast-panel.component';\r\nimport { MatBadgeModule } from '@angular/material/badge';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatBadgeModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatTooltipModule,\r\n    MatMenuModule,\r\n    IgoLanguageModule,\r\n    IgoPanelModule,\r\n    IgoStopPropagationModule,\r\n    IgoActionModule,\r\n    IgoFeatureModule,\r\n    IgoSearchResultsModule\r\n  ],\r\n  exports: [ToastPanelComponent],\r\n  declarations: [ToastPanelComponent]\r\n})\r\nexport class AppToastPanelModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSidenavModule } from '@angular/material/sidenav';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\n\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport {\r\n  IgoPanelModule,\r\n  IgoFlexibleModule,\r\n  IgoToolModule,\r\n  IgoInteractiveTourModule,\r\n  IgoHomeButtonModule\r\n} from '@igo2/common';\r\nimport { IgoFeatureModule } from '@igo2/geo';\r\nimport { IgoContextManagerModule } from '@igo2/context';\r\n\r\nimport { SidenavComponent } from './sidenav.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    MatSidenavModule,\r\n    MatTooltipModule,\r\n    IgoLanguageModule,\r\n    IgoPanelModule,\r\n    IgoFlexibleModule,\r\n    IgoContextManagerModule,\r\n    IgoToolModule,\r\n    IgoFeatureModule,\r\n    IgoInteractiveTourModule,\r\n    IgoHomeButtonModule\r\n  ],\r\n  exports: [SidenavComponent],\r\n  declarations: [SidenavComponent]\r\n})\r\nexport class AppSidenavModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\n\r\nimport { IgoPanelModule, IgoStopPropagationModule } from '@igo2/common';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\n\r\nimport { ToastPanelForExpansionComponent } from './toast-panel-for-expansion.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    MatButtonModule,\r\n    IgoLanguageModule,\r\n    IgoPanelModule,\r\n    IgoStopPropagationModule\r\n  ],\r\n  exports: [ToastPanelForExpansionComponent],\r\n  declarations: [ToastPanelForExpansionComponent]\r\n})\r\nexport class AppToastPanelForExpansionModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatToolbarModule } from '@angular/material/toolbar';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\n\r\nimport { WelcomeWindowComponent } from './welcome-window.component';\r\nimport { IgoLanguageModule } from '@igo2/core';\r\nimport { IgoInteractiveTourModule, IgoCustomHtmlModule } from '@igo2/common';\r\n\r\n@NgModule({\r\n  imports: [\r\n    IgoLanguageModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    MatDialogModule,\r\n    IgoInteractiveTourModule,\r\n    IgoCustomHtmlModule,\r\n    MatButtonModule,\r\n    MatTooltipModule,\r\n    MatIconModule,\r\n    MatToolbarModule\r\n  ],\r\n  declarations: [WelcomeWindowComponent],\r\n  exports: [WelcomeWindowComponent]\r\n})\r\nexport class IgoWelcomeWindowModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatSidenavModule } from '@angular/material/sidenav';\r\nimport { MatTooltipModule } from '@angular/material/tooltip';\r\nimport { MatDialogModule } from '@angular/material/dialog';\r\n\r\nimport { IgoCoreModule } from '@igo2/core';\r\nimport {\r\n  IgoActionModule,\r\n  IgoWorkspaceModule,\r\n  IgoEntityModule,\r\n  IgoPanelModule,\r\n  IgoBackdropModule,\r\n  IgoFlexibleModule,\r\n  IgoContextMenuModule,\r\n  IgoToolModule,\r\n  IgoEntityTableModule,\r\n  IgoEntityTablePaginatorModule,\r\n  IgoInteractiveTourModule\r\n} from '@igo2/common';\r\n\r\nimport {\r\n  IgoGeoWorkspaceModule,\r\n  IgoFeatureModule,\r\n  IgoImportExportModule,\r\n  IgoMapModule,\r\n  IgoQueryModule,\r\n  IgoSearchModule\r\n} from '@igo2/geo';\r\nimport {\r\n  IgoContextManagerModule,\r\n  IgoContextMapButtonModule\r\n} from '@igo2/context';\r\n\r\nimport { IgoIntegrationModule } from '@igo2/integration';\r\n\r\nimport { MapOverlayModule } from './map-overlay/map-overlay.module';\r\nimport { AppExpansionPanelModule } from './expansion-panel/expansion-panel.module';\r\nimport { AppToastPanelModule } from './toast-panel/toast-panel.module';\r\nimport { AppSidenavModule } from './sidenav/sidenav.module';\r\n\r\nimport { PortalComponent } from './portal.component';\r\nimport { AppToastPanelForExpansionModule } from './toast-panel-for-expansion/toast-panel-for-expansion.module';\r\n\r\nimport { WelcomeWindowComponent } from './welcome-window/welcome-window.component';\r\nimport { IgoWelcomeWindowModule } from './welcome-window/welcome-window.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MatTooltipModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatSidenavModule,\r\n    MatDialogModule,\r\n    IgoCoreModule,\r\n    IgoFeatureModule,\r\n    IgoImportExportModule,\r\n    IgoMapModule,\r\n    IgoQueryModule.forRoot(),\r\n    IgoSearchModule.forRoot(),\r\n    IgoActionModule,\r\n    IgoWorkspaceModule,\r\n    IgoEntityModule,\r\n    IgoGeoWorkspaceModule,\r\n    IgoPanelModule,\r\n    IgoToolModule,\r\n    IgoContextMenuModule,\r\n    IgoBackdropModule,\r\n    IgoFlexibleModule,\r\n    IgoIntegrationModule,\r\n    AppExpansionPanelModule,\r\n    AppToastPanelModule,\r\n    AppToastPanelForExpansionModule,\r\n    AppSidenavModule,\r\n    MapOverlayModule,\r\n    IgoContextManagerModule,\r\n    IgoContextMapButtonModule,\r\n    IgoEntityTableModule,\r\n    IgoEntityTablePaginatorModule,\r\n    IgoInteractiveTourModule,\r\n    IgoWelcomeWindowModule\r\n  ],\r\n  exports: [PortalComponent],\r\n  declarations: [PortalComponent],\r\n  entryComponents: [WelcomeWindowComponent]\r\n})\r\nexport class PortalModule {}\r\n","import { Injectable } from '@angular/core';\r\n\r\nimport { ConfigService, StorageService } from '@igo2/core';\r\nimport { MatDialogConfig } from '@angular/material/dialog';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WelcomeWindowService {\r\n  nbVisit: number;\r\n  showAgain: boolean;\r\n  igoVersionDifferentFromStorage = false;\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    private storageService: StorageService\r\n  ) {\r\n    this.igoVersionDifferentFromStorage = this.isVersionDifferentFromStorage();\r\n    this.setStorageConfig();\r\n  }\r\n\r\n  setStorageConfig() {\r\n    this.nbVisit = Number(this.storageService.get('welcomeWindow_nbVisit'));\r\n    if (!this.nbVisit) {\r\n      this.nbVisit = 0;\r\n    }\r\n\r\n    this.storageService.set('welcomeWindow_nbVisit', (this.nbVisit += 1));\r\n    this.storageService.set(\r\n      'version',\r\n      this.configService.getConfig('version.lib')\r\n    );\r\n  }\r\n\r\n  isVersionDifferentFromStorage(): boolean {\r\n    if (\r\n      this.storageService.get('version') &&\r\n      this.storageService.get('version') !==\r\n        this.configService.getConfig('version.lib')\r\n    ) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  hasWelcomeWindow(): boolean {\r\n    if (\r\n      this.storageService.get('welcomeWindow_showAgain') === false ||\r\n      this.storageService.get('welcomeWindow_showAgain') === 'false'\r\n    ) {\r\n      if (\r\n        this.nbVisit >=\r\n        this.configService.getConfig('welcomeWindow.nbVisitToShowAgain')\r\n      ) {\r\n        this.storageService.set('welcomeWindow_nbVisit', 0);\r\n        this.storageService.remove('welcomeWindow_showAgain');\r\n        return true;\r\n      } else if (\r\n        this.configService.getConfig('welcomeWindow.showAgainOnNewIGOVersion')\r\n      ) {\r\n        if (this.igoVersionDifferentFromStorage) {\r\n          this.storageService.set('welcomeWindow_nbVisit', 0);\r\n          this.storageService.remove('welcomeWindow_showAgain');\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    if (typeof this.configService.getConfig('welcomeWindow.nbVisitToShow') !== 'undefined' ) {\r\n      if (this.nbVisit > this.configService.getConfig('welcomeWindow.nbVisitToShow') ) {\r\n        this.storageService.set('welcomeWindow_showAgain', false);\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return this.configService.getConfig('welcomeWindow');\r\n  }\r\n\r\n  getConfig(): MatDialogConfig {\r\n    const dialogConfig = new MatDialogConfig();\r\n\r\n    dialogConfig.disableClose = true;\r\n    dialogConfig.autoFocus = true;\r\n    dialogConfig.maxWidth = '500px';\r\n\r\n    return dialogConfig;\r\n  }\r\n\r\n  afterClosedWelcomeWindow() {\r\n    this.storageService.set('welcomeWindow_showAgain', this.showAgain);\r\n  }\r\n}\r\n","<div class=\"welcome-window\"  *ngIf=\"html$ | async\">\r\n\r\n  <mat-toolbar color=\"primary\">\r\n    <h2>{{'welcomeWindow.title' | translate}}</h2>\r\n    <span class=\"spacer\"></span>\r\n\r\n    <label>\r\n      <input id=\"doNotShowCheck\" type=\"checkbox\" [(ngModel)]=\"showAgain\" (click)=\"setShowAgain()\">\r\n      {{'welcomeWindow.notShowCheck' | translate}}\r\n    </label>\r\n  </mat-toolbar>\r\n\r\n  <div mat-dialog-content class=\"text\">\r\n    <igo-custom-html class=\"mat-typography\"\r\n    [html]=\"html$ | async\">\r\n    </igo-custom-html>\r\n  </div>\r\n\r\n  <p></p>\r\n  <div class=\"button-container\">\r\n    <igo-interactive-tour\r\n      id=\"tour-button\"\r\n      styleButton = \"raised\"\r\n      [discoverTitleInLocale$]=\"discoverTitleInLocale$\"\r\n      (click)= \"closeWelcomeWindow()\">\r\n    </igo-interactive-tour>\r\n\r\n  <button mat-raised-button class=\"button-close\" color=\"primary\" mat-dialog-close>{{'welcomeWindow.closeButton' | translate}}</button>\r\n  </div>\r\n\r\n</div>\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ConfigService, LanguageService } from '@igo2/core';\r\nimport { BehaviorSubject, Observable, of, Subscription } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { WelcomeWindowService } from './welcome-window.service';\r\n\r\n@Component({\r\n  selector: 'app-welcome-window',\r\n  templateUrl: './welcome-window.component.html',\r\n  styleUrls: ['./welcome-window.component.scss']\r\n})\r\nexport class WelcomeWindowComponent implements OnInit, OnDestroy {\r\n  // isVisible = true;\r\n  showAgain = false;\r\n  public discoverTitleInLocale$: Observable<string> =\r\n    of(this.configService.getConfig('welcomeWindow.discoverTitleInLocale') || this.configService.getConfig('title'));\r\n  private title$$: Subscription;\r\n  public html$: BehaviorSubject<string> = new BehaviorSubject(undefined);\r\n\r\n  constructor(\r\n    public dialog: MatDialog,\r\n    private welcomeWindowService: WelcomeWindowService,\r\n    private configService: ConfigService,\r\n    protected languageService: LanguageService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.computeHtml();\r\n  }\r\n\r\n  closeWelcomeWindow() {\r\n    this.dialog.closeAll();\r\n  }\r\n\r\n  private computeHtml() {\r\n    let deltaDay = 0;\r\n    let isDateParsable = true;\r\n    let releaseDate = new Date(this.configService.getConfig('version.releaseDate'));\r\n\r\n    const releaseDateAppConfig = this.configService.getConfig('version.releaseDateApp');\r\n\r\n\r\n    if (releaseDateAppConfig) {\r\n      const releaseDateApp = new Date(releaseDateAppConfig);\r\n      if (isNaN(releaseDateApp.getDate())) {\r\n        console.log('The releaseDateApp config is not a valid date format');\r\n        isDateParsable = false;\r\n      } else {\r\n        deltaDay = 1;\r\n        releaseDate = releaseDateApp;\r\n      }\r\n    }\r\n\r\n    let releaseDateString = '';\r\n\r\n    if (isDateParsable) {\r\n      let day: any = releaseDate.getDate() + deltaDay;\r\n      if (day < 10) {\r\n        day = '0' + day;\r\n      }\r\n      let month: any = releaseDate.getMonth() + 1;\r\n      if (month < 10) {\r\n        month = '0' + month;\r\n      }\r\n      const year = releaseDate.getFullYear();\r\n      releaseDateString = `${year}-${month}-${day}`;\r\n    } else {\r\n      releaseDateString = releaseDateAppConfig;\r\n    }\r\n\r\n    this.title$$ = this.languageService.translate.get(this.configService.getConfig('title') || '')\r\n      .pipe(\r\n        map(title => {\r\n          return this.languageService.translate.instant('welcomeWindow.html', {\r\n            title,\r\n            description: this.configService.getConfig('description') || '',\r\n            version: this.configService.getConfig('version.app') || this.configService.getConfig('version.lib') || '',\r\n            releaseDate: releaseDateString || ''\r\n          });\r\n        })\r\n      ).subscribe((r) => this.html$.next(r));\r\n\r\n    return this.html$;\r\n\r\n  }\r\n\r\n  setShowAgain() {\r\n    this.welcomeWindowService.showAgain = this.showAgain;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.title$$) {\r\n      this.title$$.unsubscribe();\r\n    }\r\n  }\r\n}\r\n","<mat-sidenav\r\n  mode=\"side\"\r\n  [autoFocus]=\"false\"\r\n  [(opened)]=\"opened\">\r\n\r\n  <div class=\"app-sidenav-content\">\r\n\r\n      <div #content class=\"app-content\" [ngClass]=\"{toolActivated: toolbox.activeTool$ | async}\">\r\n\r\n        <igo-home-button\r\n          *ngIf=\"toolbox.activeTool$ | async\"\r\n          (unselectButton)=\"onUnselectButtonClick()\">\r\n        </igo-home-button>\r\n\r\n        <igo-panel [title]=\"title$ | async | translate\">\r\n          <button *ngIf=\"toolbox.activeTool$ | async\"\r\n            mat-icon-button\r\n            panelLeftButton\r\n            tooltip-position=\"below\"\r\n            matTooltipShowDelay=\"500\"\r\n            [matTooltip]=\"'igo.context.sidenav.goBack' | translate\"\r\n            (click)=\"onPreviousButtonClick()\">\r\n            <mat-icon svgIcon=\"arrow-left\"></mat-icon>\r\n          </button>\r\n\r\n          <igo-interactive-tour\r\n            panelRightButton\r\n            styleButton = 'icon'>\r\n          </igo-interactive-tour>\r\n\r\n          <!-- <button *ngIf=\"toolbox.activeTool$ | async\"\r\n            mat-icon-button\r\n            panelRightButton\r\n            tooltip-position=\"below\"\r\n            matTooltipShowDelay=\"500\"\r\n            [matTooltip]=\"'igo.context.sidenav.mainMenu' | translate\"\r\n            (click)=\"onUnselectButtonClick()\">\r\n            <mat-icon svgIcon=\"close\"></mat-icon>\r\n          </button> -->\r\n\r\n          <igo-toolbox\r\n            class=\"igo-toolbox\"\r\n            color=\"primary\"\r\n            [animate]=\"true\"\r\n            [toolbox]=\"toolbox\">\r\n          </igo-toolbox>\r\n\r\n        </igo-panel>\r\n    </div>\r\n  </div>\r\n</mat-sidenav>\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  OnInit,\r\n  OnDestroy,\r\n  EventEmitter,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { BehaviorSubject, Subscription } from 'rxjs';\r\n\r\nimport { Tool, Toolbox } from '@igo2/common';\r\nimport { IgoMap } from '@igo2/geo';\r\nimport { ToolState, CatalogState } from '@igo2/integration';\r\nimport { ConfigService } from '@igo2/core';\r\n\r\n@Component({\r\n  selector: 'app-sidenav',\r\n  templateUrl: './sidenav.component.html',\r\n  styleUrls: ['./sidenav.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SidenavComponent implements OnInit, OnDestroy {\r\n  title$: BehaviorSubject<string> = new BehaviorSubject<string>(undefined);\r\n\r\n  private activeTool$$: Subscription;\r\n\r\n  @Input()\r\n  get map(): IgoMap {\r\n    return this._map;\r\n  }\r\n  set map(value: IgoMap) {\r\n    this._map = value;\r\n  }\r\n  private _map: IgoMap;\r\n\r\n  @Input()\r\n  get opened(): boolean {\r\n    return this._opened;\r\n  }\r\n  set opened(value: boolean) {\r\n    if (value === this._opened) {\r\n      return;\r\n    }\r\n\r\n    this._opened = value;\r\n    this.openedChange.emit(this._opened);\r\n  }\r\n  private _opened: boolean;\r\n\r\n  @Output() openedChange = new EventEmitter<boolean>();\r\n  @Output() toolChange = new EventEmitter<Tool>();\r\n\r\n  get toolbox(): Toolbox {\r\n    return this.toolState.toolbox;\r\n  }\r\n\r\n  constructor(\r\n    private toolState: ToolState,\r\n    private configService: ConfigService,\r\n    private catalogState: CatalogState) {}\r\n\r\n  ngOnInit() {\r\n    this.activeTool$$ = this.toolbox.activeTool$.subscribe((tool: Tool) => {\r\n      const sidenavTitle = this.configService.getConfig('sidenavTitle') || 'IGO';\r\n      if (tool) {\r\n        if (tool.name === 'catalogBrowser') {\r\n          for (const catalog of this.catalogState.catalogStore.all()) {\r\n            if (this.catalogState.catalogStore.state.get(catalog).selected === true) {\r\n              this.title$.next(catalog.title);\r\n            }\r\n          }\r\n        } else if (tool.name === 'activeTimeFilter' || tool.name === 'activeOgcFilter') {\r\n          for (const layer of this.map.layers) {\r\n            if (layer.options.active === true) {\r\n              this.title$.next(layer.title);\r\n            }\r\n          }\r\n        } else {\r\n          this.title$.next(tool.title);\r\n        }\r\n      } else {\r\n        this.title$.next(sidenavTitle);\r\n      }\r\n      this.toolChange.emit(tool);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.activeTool$$.unsubscribe();\r\n  }\r\n\r\n  onPreviousButtonClick() {\r\n    this.toolbox.activatePreviousTool();\r\n  }\r\n\r\n  onUnselectButtonClick() {\r\n    this.toolbox.deactivateTool();\r\n  }\r\n}\r\n","<ng-container *ngFor=\"let element of mapOverlay; let i = index\">\r\n  <div class=\"mapOverlayDefault\" [ngClass]=\"element.cssClass\"\r\n       [style.position]=\"element.fixed ? 'fixed' : 'absolute'\"\r\n       [style.marginLeft]=\"element.marginLeft\"\r\n       [style.marginRight]=\"element.marginRight\"\r\n       [style.marginTop]=\"element.marginTop\"\r\n       [style.marginBottom]=\"element.marginBottom\"\r\n       [style.fontSize]=\"element.fontSize\">\r\n    <a *ngIf=\"element.link; else templateNoLink\"\r\n        target=\"_blank\" [href]='element.link'>\r\n        {{ element.text }}\r\n        <ng-container *ngIf=\"element.imgSrc\">\r\n          <img [src]=\"element.imgSrc\"\r\n               [alt]=\"element.alt\"\r\n               [ngStyle]=\"{ 'width': element.imgSize }\">\r\n        </ng-container>\r\n    </a>\r\n\r\n\r\n  <ng-template #templateNoLink>\r\n    {{ element.text }}\r\n    <ng-container *ngIf=\"element.imgSrc\">\r\n      <img [src]=\"element.imgSrc\" [alt]=\"element.alt\" [ngStyle]=\"{ 'width': element.imgSize }\">\r\n    </ng-container>\r\n\r\n  </ng-template>\r\n  </div>\r\n</ng-container>\r\n","import { Component, AfterViewInit, OnDestroy } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { Context, ContextService } from '@igo2/context';\r\nimport { MediaService, ConfigService } from '@igo2/core';\r\nimport { MapOverlay } from './map-overlay.interface';\r\n\r\n@Component({\r\n  selector: 'app-map-overlay',\r\n  templateUrl: './map-overlay.component.html',\r\n  styleUrls: ['./map-overlay.component.scss']\r\n})\r\n\r\nexport class MapOverlayComponent implements AfterViewInit, OnDestroy {\r\n  public mapOverlay: MapOverlay[] = [];\r\n  private context$$: Subscription;\r\n  private media$$: Subscription;\r\n  private context: Context;\r\n\r\n  constructor(\r\n    private contextService: ContextService,\r\n    private mediaService: MediaService,\r\n    private configService: ConfigService\r\n  ) { }\r\n\r\n  ngAfterViewInit() {\r\n    this.context$$ = this.contextService.context$.subscribe(context => {\r\n        this.handleContextChange(context);\r\n        this.context = context;\r\n        }\r\n    );\r\n    this.media$$ = this.mediaService.media$.subscribe(media =>\r\n      this.handleContextChange(this.context)\r\n    );\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.context$$.unsubscribe();\r\n    this.media$$.unsubscribe();\r\n  }\r\n\r\n  private handleContextChange(context: Context) {\r\n    let mapOverlay = [];\r\n    if (context !== undefined) {\r\n      this.mapOverlay = [];\r\n\r\n      if (context['mapOverlay']) {\r\n        mapOverlay = context['mapOverlay'];\r\n      } else if (this.configService.getConfig('mapOverlay')) {\r\n        mapOverlay = this.configService.getConfig('mapOverlay');\r\n      }\r\n      for (const overlay of mapOverlay) {\r\n\r\n        // If no media define use default to desktop, display only if current media is on context definition\r\n        if ((!overlay.media && this.mediaService.getMedia() === 'desktop') ||\r\n        (overlay.media && overlay.media.includes(this.mediaService.getMedia()))) {\r\n          this.mapOverlay.push(overlay);\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\nimport { showContent } from './toast-panel-for-expansion.animations';\r\n\r\n\r\n@Component({\r\n  selector: 'app-toast-panel-for-expansion',\r\n  templateUrl: './toast-panel-for-expansion.component.html',\r\n  styleUrls: ['./toast-panel-for-expansion.component.scss'],\r\n  animations: [showContent()],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ToastPanelForExpansionComponent {\r\n\r\n  @Input()\r\n  set opened(value: boolean) {\r\n    if (value === this._opened) {\r\n      return;\r\n    }\r\n    this._opened = value;\r\n    this.openedChange.emit(this._opened);\r\n  }\r\n  get opened(): boolean { return this._opened; }\r\n  private _opened: boolean;\r\n\r\n  @Input() title: string;\r\n\r\n  @Input() withHeader: boolean;\r\n\r\n  @Output() openedChange = new EventEmitter<boolean>();\r\n\r\n  @HostBinding('class.toast-panel-for-expansion-opened')\r\n  get hasOpenedClass() {\r\n    return this.opened;\r\n  }\r\n\r\n  @HostBinding('style.visibility')\r\n  get displayStyle() {\r\n    return (this.withHeader || this.opened) ? 'visible' : 'hidden';\r\n  }\r\n\r\n  constructor() {}\r\n\r\n}\r\n","<div>\r\n  <div class=\"app-expansion-panel-trigger-container\">\r\n    <button mat-icon-button (click)=\"onToggleClick()\" \r\n    [matTooltip]=\"(!expanded ? 'workspace.open' : 'workspace.close') | translate\"\r\n    color=\"primary\">\r\n      <mat-icon *ngIf=\"!expanded\" svgIcon=\"launch\"></mat-icon>\r\n      <mat-icon *ngIf=\"expanded\" style=\"transform: rotate(180deg)\" svgIcon=\"launch\"></mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <div class=\"app-expansion-panel-content\">\r\n    <ng-content></ng-content>\r\n  </div>\r\n</div>\r\n","<igo-panel [title]=\"title\" [withHeader]=\"withHeader\">\r\n\r\n  <div #content [@showContent]=\"opened\">\r\n    <ng-content></ng-content>\r\n  </div>\r\n</igo-panel>\r\n","import {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function showContent(\r\n  duration = '50ms',\r\n  delay = '280ms',\r\n  easing = 'ease-in-out'\r\n): AnimationTriggerMetadata {\r\n  return trigger('showContent', [\r\n    state('true', style({\r\n      opacity: 1,\r\n      display: 'block'\r\n    })),\r\n    state('false', style({\r\n      opacity: 0,\r\n      display: 'none'\r\n    })),\r\n    transition('false => true', animate(`${duration} ${delay} ${easing}`)),\r\n    transition('true => false', animate('0ms'))\r\n  ]);\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-expansion-panel-header',\r\n  templateUrl: './expansion-panel-header.component.html',\r\n  styleUrls: ['./expansion-panel-header.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ExpansionPanelHeaderComponent {\r\n  @Input()\r\n  get expanded(): boolean {\r\n    return this._expanded;\r\n  }\r\n  set expanded(value: boolean) {\r\n    if (value === this._expanded) {\r\n      return;\r\n    }\r\n\r\n    this._expanded = value;\r\n    this.expandedChange.emit(this._expanded);\r\n  }\r\n  private _expanded: boolean;\r\n\r\n  @Output() expandedChange = new EventEmitter<boolean>();\r\n\r\n  @HostBinding('class.app-expansion-panel-header-expanded')\r\n  get hasExpandedClass() {\r\n    return this.expanded;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  onToggleClick() {\r\n    this.expanded = !this.expanded;\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  ChangeDetectionStrategy\r\n} from '@angular/core';\r\n\r\nimport { showContent } from './expansion-panel.animations';\r\n\r\n@Component({\r\n  selector: 'app-expansion-panel',\r\n  templateUrl: './expansion-panel.component.html',\r\n  styleUrls: ['./expansion-panel.component.scss'],\r\n  animations: [showContent()],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ExpansionPanelComponent {\r\n  @Input()\r\n  get expanded(): boolean {\r\n    return this._expanded;\r\n  }\r\n  set expanded(value: boolean) {\r\n    if (value === this._expanded) {\r\n      return;\r\n    }\r\n\r\n    this._expanded = value;\r\n    this.expandedChange.emit(this._expanded);\r\n  }\r\n  private _expanded: boolean;\r\n\r\n  @Input() maximized: Boolean = false;\r\n\r\n  @Input()\r\n  get backdropShown(): boolean {\r\n    return this._backdropShown;\r\n  }\r\n  set backdropShown(value: boolean) {\r\n    this._backdropShown = value;\r\n  }\r\n  private _backdropShown: boolean;\r\n\r\n  @Output() expandedChange = new EventEmitter<boolean>();\r\n\r\n  @HostBinding('class.app-expansion-panel-expanded')\r\n  get hasExpandedClass() {\r\n    return this.expanded && !this.maximized;\r\n  }\r\n\r\n  @HostBinding('class.app-expansion-panel-expanded-maximized')\r\n  get hasExpandedFullClass() {\r\n    return this.expanded && this.maximized;\r\n  }\r\n\r\n  constructor() {}\r\n\r\n  onBackdropClick() {\r\n    this.expanded = false;\r\n    this.backdropShown = false;\r\n  }\r\n}\r\n","<div>\r\n\r\n  <div class=\"app-expansion-panel-container\">\r\n    <igo-backdrop\r\n      [shown]=\"backdropShown\"\r\n      (click)=\"onBackdropClick()\">\r\n    </igo-backdrop>\r\n\r\n    <app-expansion-panel-header [(expanded)]=\"expanded\">\r\n      <ng-content select=\"[expansionPanelHeader]\"></ng-content>\r\n    </app-expansion-panel-header>\r\n\r\n    <div\r\n      class=\"app-expansion-panel-content mat-elevation-z4\"\r\n      [@showContent]=\"expanded\">\r\n      <ng-content></ng-content>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n","import {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function showContent(\r\n  duration = '150ms',\r\n  delay = '300ms',\r\n  easing = 'ease-in-out'\r\n): AnimationTriggerMetadata {\r\n  return trigger('showContent', [\r\n    state(\r\n      'true',\r\n      style({\r\n        opacity: 1,\r\n        display: 'block'\r\n      })\r\n    ),\r\n    state(\r\n      'false',\r\n      style({\r\n        opacity: 0,\r\n        display: 'none'\r\n      })\r\n    ),\r\n    transition('false => true', animate(`${duration} ${delay} ${easing}`)),\r\n    transition('true => false', animate('0ms'))\r\n  ]);\r\n}\r\n","<ng-template #toast>\r\n  <igo-panel\r\n    *ngIf=\"store.entities$ | async\"\r\n    [ngClass] = \"getClassPanel()\"\r\n    [title]=\"resultSelected$.value ? getTitle(resultSelected$.value) :('toastPanel.title' | translate )\"\r\n    (click)=\"onToggleClick($event)\"\r\n    tabindex=\"0\"\r\n    (keydown)=\"handleKeyboardEvent($event)\">\r\n\r\n    <igo-actionbar\r\n      id=\"igo-actionbar\"\r\n      panelLeftButton\r\n      [store]=\"actionStore\"\r\n      [withIcon]=\"true\"\r\n      [icon]=\"icon\"\r\n      [withTitle]=\"actionbarMode === 'overlay'\"\r\n      [horizontal]=\"true\"\r\n      [mode]=\"actionbarMode\">\r\n    </igo-actionbar>\r\n\r\n    <button\r\n      *ngIf=\"resultSelected$.value\"\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      panelLeftButton\r\n      [matTooltip]=\"((isSelectedResultOutOfView$ | async) ? 'toastPanel.zoomOnFeatureTooltipOutOfView' : 'toastPanel.zoomOnFeatureTooltip') | translate\"\r\n      matTooltipShowDelay=\"500\"\r\n      (click)=\"zoomTo()\">\r\n      <mat-icon\r\n      [matBadge]=\"(isSelectedResultOutOfView$ | async) ? '!' : ''\"\r\n      matBadgeColor=\"accent\"\r\n      matBadgeSize=\"small\"\r\n      [matBadgeHidden]=\"(isSelectedResultOutOfView$ | async)!==true\"     \r\n      svgIcon=\"magnify-plus-outline\"></mat-icon>\r\n    </button>\r\n\r\n    <button\r\n      *ngIf=\"resultSelected$.value\"\r\n      [disabled]=\"results[0].meta.id === resultSelected$.value.meta.id\"\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      panelLeftButton\r\n      [matTooltip]=\"'toastPanel.previousFeatureTooltip' | translate\"\r\n      matTooltipShowDelay=\"500\"\r\n      (click)=\"previousResult()\">\r\n      <mat-icon svgIcon=\"chevron-left\"></mat-icon>\r\n    </button>\r\n\r\n    <button\r\n      *ngIf=\"resultSelected$.value\"\r\n      [disabled]=\"results[results.length-1].meta.id === resultSelected$.value.meta.id\"\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      panelRightButton\r\n      [matTooltip]=\"'toastPanel.nextFeatureTooltip' | translate\"\r\n      matTooltipShowDelay=\"500\"\r\n      (click)=\"nextResult()\">\r\n      <mat-icon svgIcon=\"chevron-right\"></mat-icon>\r\n    </button>\r\n\r\n    <button\r\n     *ngIf = \"isDesktop()\"\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      panelRightButton\r\n      (click)=\"resizeWindows()\"\r\n      [matTooltip]=\"((this.fullExtent$ | async) ? 'toastPanel.standardExtentTooltip' : 'toastPanel.fullExtentTooltip') | translate\"\r\n      matTooltipShowDelay=\"500\">\r\n      <mat-icon svgIcon={{iconResizeWindows}}></mat-icon>\r\n    </button>\r\n    <button\r\n      mat-icon-button\r\n      igoStopPropagation\r\n      panelRightButton\r\n      (click)=\"clear()\">\r\n      <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n\r\n    <div #content class=\"toast-content\">\r\n\r\n      <igo-feature-details\r\n        *ngIf=\"resultSelected$.value\"\r\n        [feature]=\"resultSelected$.value.data\"\r\n        (htmlDisplayEvent)=setHtmlDisplay($event)>\r\n      </igo-feature-details>\r\n\r\n      <igo-search-results\r\n        *ngIf=\"!resultSelected$.value\"\r\n        [map]=\"map\"\r\n        [store]=\"store\"\r\n        [showIcons]=\"true\"\r\n        [withZoomButton]=\"withZoomButton\"\r\n        (resultFocus)=\"focusResult($event)\"\r\n        (resultUnfocus)=\"unfocusResult($event, true)\"\r\n        (resultSelect)=\"selectResult($event)\">\r\n      </igo-search-results>\r\n    </div>\r\n  </igo-panel>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isMobile(); else toast\"\r\nclass=\"swipe-fix\"\r\n(swipeleft)=\"swipe($event.type)\"\r\n(swiperight)=\"swipe($event.type)\"\r\n(swipeup)=\"swipe($event.type)\"\r\n(swipedown)=\"swipe($event.type)\">\r\n\r\n<ng-template [ngTemplateOutlet]=\"toast\"></ng-template>\r\n</div>\r\n","import {\r\n  Component,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  HostBinding,\r\n  HostListener,\r\n  ChangeDetectionStrategy,\r\n  OnInit,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { BehaviorSubject, Observable, combineLatest, Subscription } from 'rxjs';\r\nimport { debounceTime, map, skipWhile, tap } from 'rxjs/operators';\r\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\r\nimport olFeature from 'ol/Feature';\r\nimport olPoint from 'ol/geom/Point';\r\n\r\nimport {\r\n  getEntityTitle,\r\n  EntityStore,\r\n  ActionStore,\r\n  Action,\r\n  ActionbarMode\r\n} from '@igo2/common';\r\nimport {\r\n  Feature,\r\n  SearchResult,\r\n  IgoMap,\r\n  FeatureMotion,\r\n  moveToOlFeatures,\r\n  featureToOl,\r\n  featuresAreTooDeepInView,\r\n  featureFromOl,\r\n  getCommonVectorStyle,\r\n  getCommonVectorSelectedStyle,\r\n  featuresAreOutOfView,\r\n  computeOlFeaturesExtent\r\n} from '@igo2/geo';\r\nimport {\r\n  Media,\r\n  MediaService,\r\n  LanguageService,\r\n  StorageService,\r\n  StorageScope,\r\n  StorageServiceEvent\r\n} from '@igo2/core';\r\nimport { QueryState, StorageState } from '@igo2/integration';\r\n\r\n@Component({\r\n  selector: 'app-toast-panel',\r\n  templateUrl: './toast-panel.component.html',\r\n  styleUrls: ['./toast-panel.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ToastPanelComponent implements OnInit, OnDestroy {\r\n  static SWIPE_ACTION = {\r\n    RIGHT: 'swiperight',\r\n    LEFT: 'swipeleft',\r\n    UP: 'swipeup',\r\n    DOWN: 'swipedown'\r\n  };\r\n\r\n  get storageService(): StorageService {\r\n    return this.storageState.storageService;\r\n  }\r\n\r\n  @Input()\r\n  get map(): IgoMap {\r\n    return this._map;\r\n  }\r\n  set map(value: IgoMap) {\r\n    this._map = value;\r\n  }\r\n  private _map: IgoMap;\r\n\r\n  @Input()\r\n  get store(): EntityStore<SearchResult<Feature>> {\r\n    return this._store;\r\n  }\r\n  set store(value: EntityStore<SearchResult<Feature>>) {\r\n    this._store = value;\r\n    this.store.entities$.subscribe((_entities) => {\r\n      this.unselectResult();\r\n    });\r\n  }\r\n  private _store: EntityStore<SearchResult<Feature>>;\r\n\r\n  @Input()\r\n  get opened(): boolean {\r\n    return this._opened;\r\n  }\r\n  set opened(value: boolean) {\r\n    if (value !== !this._opened) {\r\n      return;\r\n    }\r\n    this._opened = value;\r\n    this.storageService.set('toastOpened', value, StorageScope.SESSION);\r\n    this.openedChange.emit(value);\r\n  }\r\n  private _opened = true;\r\n\r\n  @Input() hasFeatureEmphasisOnSelection: Boolean = false;\r\n\r\n  get zoomAuto(): boolean {\r\n    return this._zoomAuto;\r\n  }\r\n  set zoomAuto(value) {\r\n    if (value !== !this._zoomAuto) {\r\n      return;\r\n    }\r\n    this._zoomAuto = value;\r\n    this.zoomAuto$.next(value);\r\n    this.storageService.set('zoomAuto', value);\r\n  }\r\n  private _zoomAuto = false;\r\n\r\n  // To allow the toast to use much larger extent on the map\r\n  get fullExtent(): boolean {\r\n    return this._fullExtent;\r\n  }\r\n  set fullExtent(value) {\r\n    if (value !== !this._fullExtent) {\r\n      return;\r\n    }\r\n    this._fullExtent = value;\r\n    this.fullExtent$.next(value);\r\n    this.fullExtentEvent.emit(value);\r\n    this.storageService.set('fullExtent', value);\r\n  }\r\n  private _fullExtent = false;\r\n\r\n  public fullExtent$: BehaviorSubject<boolean> = new BehaviorSubject(\r\n    this.fullExtent\r\n  );\r\n  public isHtmlDisplay = false;\r\n  public iconResizeWindows = '';\r\n\r\n  public icon = 'menu';\r\n\r\n  public actionStore = new ActionStore([]);\r\n  public actionbarMode = ActionbarMode.Overlay;\r\n\r\n  private multiple$ = new BehaviorSubject(false);\r\n  private isResultSelected$ = new BehaviorSubject(false);\r\n  public isSelectedResultOutOfView$ = new BehaviorSubject(false);\r\n  private isSelectedResultOutOfView$$: Subscription;\r\n  private storageChange$$: Subscription;\r\n  private initialized = true;\r\n\r\n  private format = new olFormatGeoJSON();\r\n\r\n  private resultOrResolution$$: Subscription;\r\n  private focusedResult$: BehaviorSubject<\r\n    SearchResult<Feature>\r\n  > = new BehaviorSubject(undefined);\r\n  private abstractFocusedOrSelectedResult: Feature;\r\n\r\n  public withZoomButton = true;\r\n  zoomAuto$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n\r\n  @Output() openedChange = new EventEmitter<boolean>();\r\n\r\n  @Output() fullExtentEvent = new EventEmitter<boolean>();\r\n  @Output() windowHtmlDisplayEvent = new EventEmitter<boolean>();\r\n\r\n  resultSelected$ = new BehaviorSubject<SearchResult<Feature>>(undefined);\r\n\r\n  // @HostBinding('class.app-toast-panel-opened')\r\n  // get hasOpenedClass() {\r\n  //   return this.opened;\r\n  // }\r\n\r\n  // @HostBinding('class.app-full-toast-panel-collapsed')\r\n  // get hasFullCollapsedClass() {\r\n  //   return !this.opened && this.fullExtent;\r\n  // }\r\n  getClassPanel() {\r\n    return {\r\n      'app-toast-panel-opened' : this.opened && !this.fullExtent && !this.isHtmlDisplay,\r\n      'app-full-toast-panel-opened' :\r\n        this.opened && this.fullExtent &&\r\n        !this.isHtmlDisplay,\r\n\r\n      'app-toast-panel-html' :\r\n        this.opened &&\r\n        !this.fullExtent &&\r\n        this.resultSelected$.value &&\r\n        this.isHtmlDisplay,\r\n\r\n      'app-toast-panel-html-large' :\r\n        this.opened &&\r\n        this.fullExtent &&\r\n        this.resultSelected$.value &&\r\n        this.isHtmlDisplay,\r\n\r\n      'app-toast-panel-collapsed': !this.opened && !this.fullExtent && !this.isHtmlDisplay,\r\n      'app-full-toast-panel-collapsed' : !this.opened && this.fullExtent && !this.isHtmlDisplay,\r\n      'app-toast-panel-html-collapsed' : !this.opened && this.isHtmlDisplay\r\n    };\r\n  }\r\n\r\n\r\n  @HostBinding('style.visibility')\r\n  get displayStyle() {\r\n    if (this.results.length) {\r\n      if (this.results.length === 1 && this.initialized) {\r\n        this.selectResult(this.results[0]);\r\n      }\r\n      return 'visible';\r\n    }\r\n    return 'hidden';\r\n  }\r\n\r\n  // @HostBinding('class.app-full-toast-panel-opened')\r\n  // get hasFullOpenedClass() {\r\n  //   return this.opened && this.fullExtent;\r\n  // }\r\n\r\n  @HostListener('document:keydown.escape', ['$event']) onEscapeHandler(\r\n    event: KeyboardEvent\r\n  ) {\r\n    this.clear();\r\n  }\r\n\r\n  @HostListener('document:keydown.backspace', ['$event']) onBackHandler(\r\n    event: KeyboardEvent\r\n  ) {\r\n    this.unselectResult();\r\n  }\r\n\r\n  @HostListener('document:keydown.z', ['$event']) onZoomHandler(\r\n    event: KeyboardEvent\r\n  ) {\r\n    if (this.isResultSelected$.getValue() === true) {\r\n      const localOlFeature = this.format.readFeature(\r\n        this.resultSelected$.getValue().data,\r\n        {\r\n          dataProjection: this.resultSelected$.getValue().data.projection,\r\n          featureProjection: this.map.projection\r\n        }\r\n      );\r\n      moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Default);\r\n    }\r\n  }\r\n\r\n  get results(): SearchResult<Feature>[] {\r\n    // return this.store.view.filter((e) => e.meta.dataType === FEATURE).all();\r\n    return this.store.all();\r\n  }\r\n\r\n  get multiple(): Observable<boolean> {\r\n    this.results.length\r\n      ? this.multiple$.next(true)\r\n      : this.multiple$.next(false);\r\n    return this.multiple$;\r\n  }\r\n\r\n  constructor(\r\n    public mediaService: MediaService,\r\n    public languageService: LanguageService,\r\n    private storageState: StorageState,\r\n    private queryState: QueryState\r\n  ) {\r\n    this.opened = this.storageService.get('toastOpened') as boolean;\r\n    this.zoomAuto = this.storageService.get('zoomAuto') as boolean;\r\n    this.fullExtent = this.storageService.get('fullExtent') as boolean;\r\n    this.setResizeWindowIcon();\r\n  }\r\n\r\n  private monitorResultOutOfView() {\r\n    this.isSelectedResultOutOfView$$ = combineLatest([\r\n      this.map.viewController.state$,\r\n      this.resultSelected$\r\n    ])\r\n      .pipe(debounceTime(100))\r\n      .subscribe((bunch) => {\r\n        const selectedResult = bunch[1];\r\n        if (!selectedResult) {\r\n          this.isSelectedResultOutOfView$.next(false);\r\n          return;\r\n        }\r\n        const selectedOlFeature = featureToOl(selectedResult.data, this.map.projection);\r\n        const selectedOlFeatureExtent = computeOlFeaturesExtent(this.map, [selectedOlFeature]);\r\n        this.isSelectedResultOutOfView$.next(featuresAreOutOfView(this.map, selectedOlFeatureExtent));\r\n      });\r\n  }\r\n\r\n\r\n  ngOnInit() {\r\n    this.store.entities$.subscribe(() => {\r\n      this.initialized = true;\r\n    });\r\n    this.monitorResultOutOfView();\r\n\r\n    let latestResult;\r\n    let trigger;\r\n    if (this.hasFeatureEmphasisOnSelection) {\r\n      this.resultOrResolution$$ = combineLatest([\r\n        this.focusedResult$.pipe(\r\n          tap((res) => {\r\n            latestResult = res;\r\n            trigger = 'focused';\r\n          })\r\n        ),\r\n        this.resultSelected$.pipe(\r\n          tap((res) => {\r\n            latestResult = res;\r\n            trigger = 'selected';\r\n          })\r\n        ),\r\n        this.map.viewController.resolution$,\r\n        this.store.entities$\r\n      ]).subscribe(() => this.buildResultEmphasis(latestResult, trigger));\r\n    }\r\n\r\n    this.storageChange$$ = this.storageService.storageChange$\r\n      .pipe(skipWhile((storageChange: StorageServiceEvent) => storageChange.key !== 'zoomAuto'))\r\n      .subscribe((change) => {\r\n        this.zoomAuto = change.currentValue;\r\n      });\r\n\r\n    this.actionStore.load([\r\n      {\r\n        id: 'list',\r\n        title: this.languageService.translate.instant('toastPanel.backToList'),\r\n        icon: 'format-list-bulleted-square',\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.listButton'\r\n        ),\r\n        display: () => {\r\n          return this.isResultSelected$;\r\n        },\r\n        handler: () => {\r\n          this.unselectResult();\r\n        }\r\n      },\r\n      {\r\n        id: 'zoomFeature',\r\n        title: this.languageService.translate.instant(\r\n          'toastPanel.zoomOnFeature'\r\n        ),\r\n        icon: 'magnify-plus-outline',\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.zoomOnFeatureTooltip'\r\n        ),\r\n        display: () => {\r\n          return this.isResultSelected$;\r\n        },\r\n        handler: () => {\r\n          const localOlFeature = this.format.readFeature(\r\n            this.resultSelected$.getValue().data,\r\n            {\r\n              dataProjection: this.resultSelected$.getValue().data.projection,\r\n              featureProjection: this.map.projection\r\n            }\r\n          );\r\n          moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Zoom);\r\n        }\r\n      },\r\n      {\r\n        id: 'zoomResults',\r\n        title: this.languageService.translate.instant(\r\n          'toastPanel.zoomOnFeatures'\r\n        ),\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.zoomOnFeaturesTooltip'\r\n        ),\r\n        icon: 'magnify-scan',\r\n        availability: () => {\r\n          return this.multiple;\r\n        },\r\n        handler: () => {\r\n          const olFeatures = [];\r\n          for (const result of this.store.all()) {\r\n            const localOlFeature = this.format.readFeature(result.data, {\r\n              dataProjection: result.data.projection,\r\n              featureProjection: this.map.projection\r\n            });\r\n            olFeatures.push(localOlFeature);\r\n          }\r\n          moveToOlFeatures(this.map, olFeatures, FeatureMotion.Zoom);\r\n        }\r\n      },\r\n      {\r\n        id: 'zoomAuto',\r\n        title: this.languageService.translate.instant('toastPanel.zoomAuto'),\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.zoomAutoTooltip'\r\n        ),\r\n        checkbox: true,\r\n        checkCondition: this.zoomAuto$,\r\n        handler: () => {\r\n          this.zoomAuto = !this.zoomAuto;\r\n          if (this.zoomAuto && this.isResultSelected$.value === true) {\r\n            this.selectResult(this.resultSelected$.getValue());\r\n          }\r\n        }\r\n      },\r\n      {\r\n        id: 'fullExtent',\r\n        title: this.languageService.translate.instant('toastPanel.fullExtent'),\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.fullExtentTooltip'\r\n        ),\r\n        icon: 'arrow-expand',\r\n        display: () => {\r\n          return this.fullExtent$.pipe(map((v) => !v && !this.isDesktop()));\r\n        },\r\n        handler: () => {\r\n          this.fullExtent = true;\r\n        }\r\n      },\r\n      {\r\n        id: 'standardExtent',\r\n        title: this.languageService.translate.instant(\r\n          'toastPanel.standardExtent'\r\n        ),\r\n        tooltip: this.languageService.translate.instant(\r\n          'toastPanel.standardExtentTooltip'\r\n        ),\r\n        icon: 'arrow-collapse',\r\n        display: () => {\r\n          return this.fullExtent$.pipe(map((v) => v && !this.isDesktop()));\r\n        },\r\n        handler: () => {\r\n          this.fullExtent = false;\r\n        }\r\n      }\r\n    ]);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.resultOrResolution$$) {\r\n      this.resultOrResolution$$.unsubscribe();\r\n    }\r\n    if (this.isSelectedResultOutOfView$$) {\r\n      this.isSelectedResultOutOfView$$.unsubscribe();\r\n    }\r\n    if (this.storageChange$$) {\r\n      this.storageChange$$.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private buildResultEmphasis(\r\n    result: SearchResult<Feature>,\r\n    trigger: 'selected' | 'focused' | undefined\r\n  ) {\r\n    this.clearFeatureEmphasis();\r\n    if (!result || (trigger === 'selected' && this.zoomAuto)) {\r\n      return;\r\n    }\r\n    const myOlFeature = featureToOl(result.data, this.map.projection);\r\n    const olGeometry = myOlFeature.getGeometry();\r\n    if (featuresAreTooDeepInView(this.map, olGeometry.getExtent() as [number, number, number, number], 0.0025)) {\r\n      const extent = olGeometry.getExtent();\r\n      const x = extent[0] + (extent[2] - extent[0]) / 2;\r\n      const y = extent[1] + (extent[3] - extent[1]) / 2;\r\n      const feature1 = new olFeature({\r\n        name: 'abstractFocusedOrSelectedResult',\r\n        geometry: new olPoint([x, y])\r\n      });\r\n      this.abstractFocusedOrSelectedResult = featureFromOl(\r\n        feature1,\r\n        this.map.projection\r\n      );\r\n      this.abstractFocusedOrSelectedResult.meta.style =\r\n        getCommonVectorSelectedStyle(\r\n          Object.assign({},\r\n            { feature: this.abstractFocusedOrSelectedResult },\r\n            trigger === 'selected' ?\r\n              this.queryState.queryOverlayStyleSelection :\r\n              this.queryState.queryOverlayStyleFocus));\r\n      this.abstractFocusedOrSelectedResult.meta.style.setZIndex(2000);\r\n      this.map.queryResultsOverlay.addFeature(\r\n        this.abstractFocusedOrSelectedResult,\r\n        FeatureMotion.None\r\n      );\r\n    }\r\n  }\r\n\r\n  private clearFeatureEmphasis() {\r\n    if (this.abstractFocusedOrSelectedResult) {\r\n      this.map.queryResultsOverlay.removeFeature(this.abstractFocusedOrSelectedResult);\r\n      this.abstractFocusedOrSelectedResult = undefined;\r\n    }\r\n  }\r\n\r\n  getTitle(result: SearchResult) {\r\n    return getEntityTitle(result);\r\n  }\r\n\r\n  focusResult(result: SearchResult<Feature>) {\r\n    this.focusedResult$.next(result);\r\n    this.map.queryResultsOverlay.removeFeature(result.data);\r\n\r\n    result.data.meta.style = getCommonVectorSelectedStyle(\r\n      Object.assign({},\r\n        { feature: result.data },\r\n        this.queryState.queryOverlayStyleFocus));\r\n    result.data.meta.style.setZIndex(2000);\r\n    this.map.queryResultsOverlay.addFeature(result.data, FeatureMotion.None);\r\n  }\r\n\r\n  unfocusResult(result: SearchResult<Feature>, force?) {\r\n    this.focusedResult$.next(undefined);\r\n    if (!force && this.store.state.get(result).focused) {\r\n      return;\r\n    }\r\n    this.map.queryResultsOverlay.removeFeature(result.data);\r\n\r\n    result.data.meta.style = getCommonVectorStyle(\r\n      Object.assign({},\r\n        { feature: result.data },\r\n        this.queryState.queryOverlayStyle));\r\n    result.data.meta.style.setZIndex(undefined);\r\n    this.map.queryResultsOverlay.addFeature(result.data, FeatureMotion.None);\r\n  }\r\n\r\n  selectResult(result: SearchResult<Feature>) {\r\n    this.store.state.update(\r\n      result,\r\n      {\r\n        focused: true,\r\n        selected: true\r\n      },\r\n      true\r\n    );\r\n    this.resultSelected$.next(result);\r\n    if (result.data.properties && result.data.properties.target === 'iframe') {\r\n      this.setHtmlDisplay(true);\r\n    } else {\r\n      this.setHtmlDisplay(false);\r\n    }\r\n\r\n    const features = [];\r\n    for (const feature of this.store.all()) {\r\n      if (feature.meta.id === result.meta.id) {\r\n        feature.data.meta.style = getCommonVectorSelectedStyle(\r\n          Object.assign({}, { feature: feature.data },\r\n            this.queryState.queryOverlayStyleSelection));\r\n        feature.data.meta.style.setZIndex(2000);\r\n      } else {\r\n        feature.data.meta.style = getCommonVectorStyle(\r\n          Object.assign({},\r\n            { feature: feature.data },\r\n            this.queryState.queryOverlayStyle));\r\n      }\r\n      features.push(feature.data);\r\n    }\r\n    this.map.queryResultsOverlay.removeFeatures(features);\r\n    this.map.queryResultsOverlay.addFeatures(features, FeatureMotion.None);\r\n\r\n    if (this.zoomAuto) {\r\n      const localOlFeature = this.format.readFeature(\r\n        this.resultSelected$.getValue().data,\r\n        {\r\n          dataProjection: this.resultSelected$.getValue().data.projection,\r\n          featureProjection: this.map.projection\r\n        }\r\n      );\r\n      moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Default);\r\n    }\r\n\r\n    this.isResultSelected$.next(true);\r\n    this.initialized = false;\r\n  }\r\n\r\n  unselectResult() {\r\n    this.resultSelected$.next(undefined);\r\n    this.isResultSelected$.next(false);\r\n    this.setHtmlDisplay(false);\r\n    this.store.state.clear();\r\n\r\n    const features = [];\r\n    for (const feature of this.store.all()) {\r\n      feature.data.meta.style = getCommonVectorStyle(\r\n        Object.assign({},\r\n          { feature: feature.data },\r\n          this.queryState.queryOverlayStyle));\r\n      features.push(feature.data);\r\n    }\r\n    this.map.queryResultsOverlay.setFeatures(features, FeatureMotion.None, 'map');\r\n  }\r\n\r\n  clear() {\r\n    this.clearFeatureEmphasis();\r\n    this.map.queryResultsOverlay.clear();\r\n    this.store.clear();\r\n    this.unselectResult();\r\n    this.setHtmlDisplay(false);\r\n  }\r\n\r\n  isMobile(): boolean {\r\n    return this.mediaService.getMedia() === Media.Mobile;\r\n  }\r\n  isDesktop(): boolean {\r\n    return this.mediaService.isDesktop();\r\n  }\r\n\r\n  handleKeyboardEvent(event) {\r\n    if (event.keyCode === 37) {\r\n      this.previousResult();\r\n    } else if (event.keyCode === 39) {\r\n      this.nextResult();\r\n    }\r\n  }\r\n\r\n  previousResult() {\r\n    if (!this.resultSelected$.value) {\r\n      return;\r\n    }\r\n    let i = this.results.indexOf(this.resultSelected$.value);\r\n    const previousResult = this.results[--i];\r\n    if (previousResult) {\r\n      this.selectResult(previousResult);\r\n    }\r\n  }\r\n\r\n  nextResult() {\r\n    if (!this.resultSelected$.value) {\r\n      return;\r\n    }\r\n    let i = this.results.indexOf(this.resultSelected$.value);\r\n    const nextResult = this.results[++i];\r\n    if (nextResult) {\r\n      this.selectResult(nextResult);\r\n    }\r\n  }\r\n\r\n  zoomTo() {\r\n    const localOlFeature = this.format.readFeature(\r\n      this.resultSelected$.getValue().data,\r\n      {\r\n        dataProjection: this.resultSelected$.getValue().data.projection,\r\n        featureProjection: this.map.projection\r\n      }\r\n    );\r\n    moveToOlFeatures(this.map, [localOlFeature], FeatureMotion.Zoom);\r\n  }\r\n\r\n  swipe(action: string) {\r\n    if (action === ToastPanelComponent.SWIPE_ACTION.RIGHT) {\r\n      this.previousResult();\r\n    } else if (action === ToastPanelComponent.SWIPE_ACTION.LEFT) {\r\n      this.nextResult();\r\n    } else if (action === ToastPanelComponent.SWIPE_ACTION.UP) {\r\n      this.opened = true;\r\n    } else if (action === ToastPanelComponent.SWIPE_ACTION.DOWN) {\r\n      this.opened = false;\r\n    }\r\n  }\r\n\r\n  onToggleClick(e: MouseEvent) {\r\n    if ((e.target as any).className !== 'igo-panel-title') {\r\n      return;\r\n    }\r\n    this.opened = !this.opened;\r\n  }\r\n\r\n  /**\r\n   * Invoke the action handler\r\n   * @internal\r\n   */\r\n  onTriggerAction(action: Action) {\r\n    const args = action.args || [];\r\n    action.handler(...args);\r\n  }\r\n\r\n  setHtmlDisplay(value: boolean) {\r\n    if (value === true) {\r\n      this.isHtmlDisplay = true;\r\n      this.windowHtmlDisplayEvent.emit(true);\r\n    } else {\r\n      this.isHtmlDisplay = false;\r\n      this.windowHtmlDisplayEvent.emit(false);\r\n    }\r\n  }\r\n\r\n  isHtmlAndDesktop(): boolean {\r\n    if (this.isHtmlDisplay && this.isDesktop()) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  setResizeWindowIcon() {\r\n    if (this.fullExtent) {\r\n      this.iconResizeWindows = 'arrow-collapse';\r\n      // this.iconResizeWindows = 'vector-arrange-below';\r\n    } else {\r\n      this.iconResizeWindows = 'arrow-expand';\r\n      // this.iconResizeWindows = 'crop-square';\r\n    }\r\n  }\r\n\r\n  resizeWindows() {\r\n    this.storageService.set('fullExtent', !this.fullExtent);\r\n    if (this.fullExtent) {\r\n        this.reduceWindow();\r\n    } else {\r\n        this.enlargeWindows();\r\n      }\r\n  }\r\n\r\n  reduceWindow() {\r\n    this.fullExtent = false;\r\n    this.setResizeWindowIcon();\r\n  }\r\n\r\n  enlargeWindows() {\r\n    this.fullExtent = true;\r\n    this.setResizeWindowIcon();\r\n  }\r\n\r\n}\r\n","<mat-sidenav-container class=\"app-main-container\">\r\n  <mat-sidenav-content>\r\n\r\n    <igo-backdrop\r\n      [shown]=\"backdropShown\"\r\n      (click)=\"onBackdropClick()\">\r\n    </igo-backdrop>\r\n\r\n    <igo-menu-button *ngIf=\"showMenuButton\"\r\n      [sidenavOpened]=\"sidenavOpened\"\r\n      (openSidenav)=\"onToggleSidenavClick()\">\r\n    </igo-menu-button>\r\n\r\n    <igo-search-bar *ngIf=\"showSearchBar\"\r\n      #searchBar\r\n      [term]=\"searchBarTerm\"\r\n      [termSplitter]=\"termSplitter\"\r\n      [minLength]=\"minSearchTermLength\"\r\n      [searchSettings]=\"true\"\r\n      [forceNA]=\"forceCoordsNA\"\r\n      [store]=\"searchStore\"\r\n      (searchTermChange)=\"onSearchTermChange($event)\"\r\n      [pointerSummaryEnabled]=\"igoSearchPointerSummaryEnabled\"\r\n      (pointerSummaryStatus)=\"onPointerSummaryStatusChange($event)\"\r\n      [searchResultsGeometryEnabled]=\"searchResultsGeometryEnabled\"\r\n      (searchResultsGeometryStatus)=\"onSearchResultsGeometryStatusChange($event)\"\r\n      (search)=\"onSearch($event)\"\r\n      (clearFeature)=\"onClearSearch()\"\r\n      (searchSettingsChange)=\"onSearchSettingsChange()\">\r\n    </igo-search-bar>\r\n\r\n    <app-sidenav\r\n      [map]=\"map\"\r\n      [(opened)]=\"sidenavOpened\"\r\n      (toolChange)=\"toolChanged($event)\">\r\n    </app-sidenav>\r\n\r\n    <igo-map-browser\r\n      igoMapOffline\r\n      igoWorkspaceUpdator\r\n      [workspaceStore]=\"workspaceStore\"\r\n      igoSearchPointerSummary\r\n      [igoSearchPointerSummaryDelay]=\"500\"\r\n      [igoSearchPointerSummaryEnabled]=igoSearchPointerSummaryEnabled\r\n      igoHoverFeature\r\n      [igoHoverFeatureDelay]=\"250\"\r\n      [igoHoverFeatureEnabled]=\"true\"\r\n      #mapBrowser\r\n      igoQuery\r\n      [waitForAllQueries]=\"true\"\r\n      [queryFeatures]=\"true\"\r\n      [queryFeaturesHitTolerance]=\"15\"\r\n      igoMapContext\r\n      igoLayerContext\r\n      igoDropGeoFile\r\n      [allowedExtensions]=\"['json', 'geojson', 'kml', 'gpx']\"\r\n      (query)=\"onMapQuery($event)\"\r\n      [map]=\"map\"\r\n      [igoContextMenu]=contextMenu\r\n      (menuPosition)=\"onContextMenuOpen($event)\"\r\n      [ngClass]=\"{'igo-attribution-offset': map.getBaseLayers().length > 1}\"\r\n      [@mapStateX]=\"sidenavOpened ? 'right' : 'left'\"\r\n      (@mapStateX.start)=\"updateMapBrowserClass()\"\r\n      [@mapStateY]=\"getControlsOffsetY()\"\r\n      (@mapStateY.start)=\"updateMapBrowserClass()\">\r\n\r\n      <igo-info-section class=\"rtssOverlay\" [infoContent]=\"infoContent\"></igo-info-section>\r\n      <igo-zoom-button [map]=\"map\" color=\"primary\"\r\n        [@controlsOffsetY]=\"getControlsOffsetY()\">\r\n      </igo-zoom-button>\r\n      <igo-swipe-control [map]=\"map\"></igo-swipe-control>\r\n      <igo-map-center [map]=\"map\"></igo-map-center>\r\n      <igo-wake-lock-button [map]=\"map\" color=\"primary\"></igo-wake-lock-button>\r\n      <igo-offline-button [map]=\"map\" color=\"primary\"\r\n        [@controlsOffsetY]=\"getControlsOffsetY()\"\r\n        [@mobileOffsetY]=\"getToastPanelStatus()\">\r\n      </igo-offline-button>\r\n      <igo-geolocate-button\r\n        *ngIf=\"hasGeolocateButton\"\r\n        [map]=\"map\" color=\"primary\"\r\n        [@controlsOffsetY]=\"getControlsOffsetY()\"\r\n        [@mobileOffsetY]=\"getToastPanelStatus()\">\r\n      </igo-geolocate-button>\r\n      <igo-rotation-button [showIfNoRotation]=\"showRotationButtonIfNoRotation\" [map]=\"map\" color=\"primary\"></igo-rotation-button>\r\n      <igo-home-extent-button\r\n        *ngIf=\"hasHomeExtentButton\"\r\n        [map]=\"map\"\r\n        [extentOverride]=\"homeExtent\"\r\n        [centerOverride]=\"homeCenter\"\r\n        [zoomOverride]=\"homeZoom\"\r\n        color=\"primary\">\r\n      </igo-home-extent-button>\r\n      <igo-user-button\r\n        *ngIf=\"auth.url\"\r\n        [map]=\"map\" color=\"primary\"\r\n        [@controlsOffsetY]=\"getControlsOffsetY()\"\r\n        [@mobileOffsetY]=\"getToastPanelStatus()\">\r\n      </igo-user-button>\r\n      <igo-baselayers-switcher [map]=\"map\"\r\n        [@controlsOffsetY]=\"getBaselayersSwitcherStatus()\"\r\n        [useStaticIcon]=\"true\">\r\n      </igo-baselayers-switcher>\r\n    </igo-map-browser>\r\n\r\n    <app-map-overlay\r\n      [@controlStateY]=\"getControlsOffsetY()\"\r\n      [@controlStateX]=\"(mediaService.media$ | async) !== 'mobile' &&\r\n                              sidenavOpened ? 'right' : 'left'\">\r\n    </app-map-overlay>\r\n\r\n  </mat-sidenav-content>\r\n</mat-sidenav-container>\r\n\r\n<app-expansion-panel\r\n  *ngIf=\"hasExpansionPanel && (workspaceState.workspaceEnabled$ | async)\"\r\n  [backdropShown]=\"expansionPanelBackdropShown\"\r\n  [(expanded)]=\"expansionPanelExpanded\"\r\n  [maximized]=\"workspaceMaximize$ | async\"\r\n  [@expansionPanelSize]=\"getExpansionPanelStatus()\"\r\n  [@toastOffsetY]=\"(isMobile() && !toastPanelOpened && queryState.store.entities$.value.length > 0 && !expansionPanelExpanded) ? 'true' : 'false'\">\r\n\r\n  <ng-container expansionPanelHeader>\r\n    <igo-workspace-selector\r\n      igoWorkspaceSelector\r\n      (toolToActivate)=\"toolToActivateFromWorkspace($event)\"\r\n      (changeWorkspace)=\"workspaceState.setActiveWorkspaceByTitle($event)\"\r\n      (disableSwitch)=\"workspaceSwitchDisabled = $event\"\r\n      (relationLayers)=\"refreshRelationsWorkspace($event)\"\r\n      (rowsInMapExtentCheckCondition)=\"workspaceState.rowsInMapExtentCheckCondition$.next($event)\"\r\n      [store]=\"workspaceStore\"\r\n      [disabled]=\"workspaceSwitchDisabled\"\r\n      [map]=\"map\">\r\n    </igo-workspace-selector>\r\n\r\n    <ng-container *ngIf=\"selectedWorkspace$ | async as workspace\">\r\n      <button\r\n        class=\"eye-workspace\"\r\n        mat-icon-button\r\n        [color]=\"workspace.layer.visible ? 'primary' : 'default'\"\r\n        collapsibleButton\r\n        tooltip-position=\"below\"\r\n        matTooltipShowDelay=\"500\"\r\n        [matTooltip]=\"workspace.layer.visible ?\r\n                      ('igo.geo.layer.hideLayer' | translate) :\r\n                      ('igo.geo.layer.showLayer' | translate)\"\r\n        (click)=\"workspace.layer.visible = !workspace.layer.visible\">\r\n        <mat-icon\r\n          [ngClass]=\"{disabled: (workspace.inResolutionRange$ | async)!==true}\"\r\n          [svgIcon]=\"workspace.layer.visible ? 'eye' : 'eye-off'\">\r\n        </mat-icon>\r\n      </button>\r\n      <button\r\n        *ngIf=\"isEditionWorkspace(workspace)\"\r\n        class=\"add-feature\"\r\n        mat-icon-button\r\n        color=\"primary\"\r\n        collapsibleButton\r\n        tooltip-position=\"below\"\r\n        matTooltipShowDelay=\"500\"\r\n        [matTooltip]=\"('workspace.addFeature') | translate\"\r\n        (click)=\"addFeature(workspace)\">\r\n        <mat-icon\r\n          svgIcon=\"plus\">\r\n        </mat-icon>\r\n      </button>\r\n      <igo-actionbar\r\n        class=\"actionbar-workspace\"\r\n        *ngIf=\"workspace.actionStore\"\r\n        [store]=\"workspace.actionStore\"\r\n        [withIcon]=\"true\"\r\n        [withTitle]=\"actionbarWithTitle\"\r\n        [horizontal]=\"true\"\r\n        [withToggleButton]=\"actionbarMode === 'overlay'\"\r\n        [iconColor]=\"'primary'\"\r\n        [color]=\"'primary'\"\r\n        [mode]=\"actionbarMode\"\r\n        [overlayClass]=\"workspaceMenuClass\">\r\n      </igo-actionbar>\r\n      <div class=\"spacer\"></div>\r\n      <igo-entity-table-paginator\r\n        *ngIf=\"workspaceVisibility()\"\r\n        [store]=\"workspace.entityStore\"\r\n        [entitySortChange$]=\"workspaceEntitySortChange$\"\r\n        [paginatorOptions]=\"paginatorOptions\"\r\n        (paginatorChange)=\"paginatorChange($event)\">\r\n      </igo-entity-table-paginator>\r\n    </ng-container>\r\n  </ng-container>\r\n\r\n  <ng-container *ngIf=\"selectedWorkspace$ | async as workspace\">\r\n    <igo-entity-table\r\n      [class]=\"isEditionWorkspace(workspace) ? 'edition-table' : ''\"\r\n      [paginator]=\"workspacePaginator\"\r\n      *ngIf=\"workspace.entityStore && workspace.meta && workspace.meta.tableTemplate && workspaceVisibility()\"\r\n      [store]=\"workspace.entityStore\"\r\n      (entitySortChange)=\"entitySortChange()\"\r\n      (entitySelectChange)=\"entitySelectChange($event)\"\r\n      [template]=\"workspace.meta.tableTemplate\">\r\n    </igo-entity-table>\r\n    <span class=\"mat-typography\">{{workspaceNotAvailableMessage | translate}}</span>\r\n  </ng-container>\r\n\r\n</app-expansion-panel>\r\n\r\n<app-toast-panel-for-expansion\r\n  [withHeader]=\"false\"\r\n  [(opened)]=\"toastPanelForExpansionOpened\">\r\n\r\n  <div class=\"toast-panel-for-expansion-close-button-container\">\r\n    <button\r\n      mat-icon-button\r\n      color=\"warn\"\r\n      (click)=\"toastPanelForExpansionOpened = false\">\r\n      <mat-icon svgIcon=\"close\"></mat-icon>\r\n    </button>\r\n  </div>\r\n\r\n  <igo-workspace-widget-outlet\r\n    *ngIf=\"selectedWorkspace$ | async as workspace\"\r\n    [workspace]=\"workspace\"\r\n    (deactivateWidget)=\"onDeactivateWorkspaceWidget()\">\r\n  </igo-workspace-widget-outlet>\r\n\r\n</app-toast-panel-for-expansion >\r\n\r\n<app-toast-panel *ngIf=\"(queryStore.empty$ | async)!==true\"\r\n  [map]=\"map\"\r\n  [store]=\"queryStore\"\r\n  [hasFeatureEmphasisOnSelection]=\"hasFeatureEmphasisOnSelection\"\r\n  [@toastPanelOffsetX]=\"toastPanelOffsetX$ | async\"\r\n  [@toastPanelOffsetY]=\"getToastPanelOffsetY()\"\r\n  [@toastPanelMobileSidenav]=\"(isMobile() && sidenavOpened) || (isTablet() && isPortrait() && sidenavOpened)\"\r\n  [opened]=\"toastPanelOpened\"\r\n  (openedChange)=\"toastOpenedChange($event)\"\r\n  (fullExtentEvent)=\"fullExtent = $event\"\r\n  (windowHtmlDisplayEvent)=\"setToastPanelHtmlDisplay($event)\">\r\n</app-toast-panel>\r\n\r\n<ng-template #contextMenu>\r\n  <igo-actionbar\r\n    [store]=\"contextMenuStore\"\r\n    [withIcon]=\"false\"\r\n    [horizontal]=\"true\"\r\n    mode=\"context\">\r\n  </igo-actionbar>\r\n</ng-template>\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  OnDestroy,\r\n  ChangeDetectorRef,\r\n  ViewChild,\r\n  ElementRef\r\n} from '@angular/core';\r\nimport { ActivatedRoute, Params } from '@angular/router';\r\nimport { Subscription, of, BehaviorSubject, combineLatest, zip } from 'rxjs';\r\nimport { debounceTime, take, pairwise, skipWhile, first, concatMap, delay } from 'rxjs/operators';\r\nimport { MatDialog, MatDialogConfig, MatDialogRef } from '@angular/material/dialog';\r\nimport MapBrowserEvent from 'ol/MapBrowserEvent';\r\nimport * as olProj from 'ol/proj';\r\nimport olFeature from 'ol/Feature';\r\nimport type { default as OlGeometry } from 'ol/geom/Geometry';\r\n\r\nimport {\r\n  MediaService,\r\n  Media,\r\n  MediaOrientation,\r\n  ConfigService,\r\n  LanguageService,\r\n  MessageService,\r\n  StorageService\r\n} from '@igo2/core';\r\nimport {\r\n  ActionbarMode,\r\n  Workspace,\r\n  WorkspaceStore,\r\n  ActionStore,\r\n  EntityStore,\r\n  // getEntityTitle,\r\n  Toolbox,\r\n  Tool,\r\n  Widget,\r\n  EntityTablePaginatorOptions,\r\n  EntityRecord\r\n} from '@igo2/common';\r\nimport { AuthOptions, AuthService } from '@igo2/auth';\r\nimport { DetailedContext } from '@igo2/context';\r\nimport {\r\n  DataSourceService,\r\n  Feature,\r\n  FEATURE,\r\n  featureToSearchResult,\r\n  GoogleLinks,\r\n  IgoMap,\r\n  LayerService,\r\n  QuerySearchSource,\r\n  Research,\r\n  SearchResult,\r\n  SearchSource,\r\n  SearchSourceService,\r\n  CapabilitiesService,\r\n  sourceCanSearch,\r\n  sourceCanReverseSearch,\r\n  ImportService,\r\n  handleFileImportError,\r\n  handleFileImportSuccess,\r\n  featureFromOl,\r\n  QueryService,\r\n  WfsWorkspace,\r\n  FeatureWorkspace,\r\n  EditionWorkspace,\r\n  EditionWorkspaceService,\r\n  generateIdFromSourceOptions,\r\n  computeOlFeaturesExtent,\r\n  addStopToStore,\r\n  GeoDBService,\r\n  ImageLayer,\r\n  VectorLayer,\r\n  MapExtent\r\n} from '@igo2/geo';\r\n\r\nimport {\r\n  ToolState,\r\n  MapState,\r\n  SearchState,\r\n  QueryState,\r\n  ContextState,\r\n  WorkspaceState,\r\n  DirectionState,\r\n  MapRtssProximityState,\r\n  MapProximityState\r\n} from '@igo2/integration';\r\n\r\nimport {\r\n  expansionPanelAnimation,\r\n  toastPanelAnimation,\r\n  controlsAnimations,\r\n  controlSlideX,\r\n  controlSlideY,\r\n  mapSlideX,\r\n  mapSlideY\r\n} from './portal.animation';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\n\r\nimport { WelcomeWindowComponent } from './welcome-window/welcome-window.component';\r\nimport { WelcomeWindowService } from './welcome-window/welcome-window.service';\r\nimport { MatPaginator } from '@angular/material/paginator';\r\nimport { ObjectUtils } from '@igo2/utils';\r\nimport olFormatGeoJSON from 'ol/format/GeoJSON';\r\n\r\n@Component({\r\n  selector: 'app-portal',\r\n  templateUrl: './portal.component.html',\r\n  styleUrls: ['./portal.component.scss'],\r\n  animations: [\r\n    expansionPanelAnimation(),\r\n    toastPanelAnimation(),\r\n    controlsAnimations(),\r\n    controlSlideX(),\r\n    controlSlideY(),\r\n    mapSlideX(),\r\n    mapSlideY()\r\n  ]\r\n})\r\nexport class PortalComponent implements OnInit, OnDestroy {\r\n  public infoContent = undefined;\r\n  public toastPanelOffsetX$: BehaviorSubject<string> = new BehaviorSubject(undefined);\r\n  public sidenavOpened$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n  public minSearchTermLength = 2;\r\n  public hasExpansionPanel = false;\r\n  public hasGeolocateButton = true;\r\n  public hasHomeExtentButton = false;\r\n  public showMenuButton = true;\r\n  public showSearchBar = true;\r\n  public showRotationButtonIfNoRotation = false;\r\n  public hasFeatureEmphasisOnSelection: Boolean = false;\r\n  public workspaceNotAvailableMessage: String = 'workspace.disabled.resolution';\r\n  public workspacePaginator: MatPaginator;\r\n  public workspaceEntitySortChange$: BehaviorSubject<boolean> = new BehaviorSubject(false);\r\n  public workspaceSwitchDisabled = false;\r\n  public paginatorOptions: EntityTablePaginatorOptions = {\r\n    pageSize: 50, // Number of items to display on a page.\r\n    pageSizeOptions: [1, 5, 10, 20, 50, 100, 500] // The set of provided page size options to display to the user.\r\n  };\r\n  public workspaceMenuClass = 'workspace-menu';\r\n\r\n  public fullExtent = this.storageService.get('fullExtent') as boolean;\r\n  private workspaceMaximize$$: Subscription[] = [];\r\n  readonly workspaceMaximize$: BehaviorSubject<boolean> = new BehaviorSubject(\r\n    this.storageService.get('workspaceMaximize') as boolean\r\n  );\r\n\r\n  public matDialogRef$ = new BehaviorSubject<MatDialogRef<any>>(undefined);\r\n  public searchBarTerm = '';\r\n  public onSettingsChange$ = new BehaviorSubject<boolean>(undefined);\r\n  public termDefinedInUrl = false;\r\n  public termSplitter = '|';\r\n  public termDefinedInUrlTriggered = false;\r\n  private addedLayers$$: Subscription[] = [];\r\n  public forceCoordsNA = false;\r\n\r\n  public contextMenuStore = new ActionStore([]);\r\n  private contextMenuCoord: [number, number];\r\n\r\n  private contextLoaded = false;\r\n\r\n  private context$$: Subscription;\r\n  private openSidenav$$: Subscription;\r\n  private sidenavMediaAndOrientation$$: Subscription;\r\n\r\n  public igoSearchPointerSummaryEnabled: boolean;\r\n\r\n  public toastPanelForExpansionOpened = true;\r\n  private activeWidget$$: Subscription;\r\n  public showToastPanelForExpansionToggle = false;\r\n  public selectedWorkspace$: BehaviorSubject<Workspace> = new BehaviorSubject(\r\n    undefined\r\n  );\r\n  private routeParams: Params;\r\n  public toastPanelHtmlDisplay = false;\r\n\r\n  public homeExtent: MapExtent;\r\n  public homeCenter: [number, number];\r\n  public homeZoom: number;\r\n  @ViewChild('mapBrowser', { read: ElementRef, static: true })\r\n  mapBrowser: ElementRef;\r\n  @ViewChild('searchBar', { read: ElementRef, static: true })\r\n  searchBar: ElementRef;\r\n\r\n  get map(): IgoMap {\r\n    return this.mapState.map;\r\n  }\r\n\r\n  get sidenavOpened(): boolean {\r\n    return this.sidenavOpened$.value;\r\n  }\r\n\r\n  set sidenavOpened(value: boolean) {\r\n    this.sidenavOpened$.next(value);\r\n  }\r\n\r\n  get auth(): AuthOptions {\r\n    return this.configService.getConfig('auth') || [];\r\n  }\r\n\r\n  get toastPanelOpened(): boolean {\r\n    return this._toastPanelOpened;\r\n  }\r\n  set toastPanelOpened(value: boolean) {\r\n    if (value !== !this._toastPanelOpened) {\r\n      return;\r\n    }\r\n    this._toastPanelOpened = value;\r\n    this.cdRef.detectChanges();\r\n  }\r\n  private _toastPanelOpened =\r\n    (this.storageService.get('toastOpened') as boolean) !== false;\r\n\r\n  isMobile(): boolean {\r\n    return this.mediaService.getMedia() === Media.Mobile;\r\n  }\r\n\r\n  isTablet(): boolean {\r\n    return this.mediaService.getMedia() === Media.Tablet;\r\n  }\r\n\r\n  isLandscape(): boolean {\r\n    return this.mediaService.getOrientation() === MediaOrientation.Landscape;\r\n  }\r\n\r\n  isPortrait(): boolean {\r\n    return this.mediaService.getOrientation() === MediaOrientation.Portrait;\r\n  }\r\n\r\n  get backdropShown(): boolean {\r\n    return (\r\n      (this.isMobile() || (this.isTablet() && this.isPortrait())) &&\r\n      this.sidenavOpened\r\n    );\r\n  }\r\n\r\n  get expansionPanelExpanded(): boolean {\r\n    return this.workspaceState.workspacePanelExpanded;\r\n  }\r\n  set expansionPanelExpanded(value: boolean) {\r\n    this.workspaceState.workspacePanelExpanded = value;\r\n  }\r\n\r\n  get toastPanelShown(): boolean {\r\n    return true;\r\n  }\r\n\r\n  get expansionPanelBackdropShown(): boolean {\r\n    return this.expansionPanelExpanded && this.toastPanelForExpansionOpened;\r\n  }\r\n\r\n  get actionbarMode(): ActionbarMode {\r\n    return ActionbarMode.Overlay;\r\n  }\r\n\r\n  get actionbarWithTitle(): boolean {\r\n    return this.actionbarMode === ActionbarMode.Overlay;\r\n  }\r\n\r\n  get searchStore(): EntityStore<SearchResult> {\r\n    return this.searchState.store;\r\n  }\r\n\r\n  get searchResultsGeometryEnabled(): boolean {\r\n    return this.searchState.searchResultsGeometryEnabled$.value;\r\n  }\r\n\r\n  get queryStore(): EntityStore<SearchResult> {\r\n    return this.queryState.store;\r\n  }\r\n\r\n  get toolbox(): Toolbox {\r\n    return this.toolState.toolbox;\r\n  }\r\n\r\n  get toastPanelContent(): string {\r\n    let content;\r\n    if (this.workspace !== undefined && this.workspace.hasWidget) {\r\n      content = 'workspace';\r\n    } /*else if (this.searchResult !== undefined) {\r\n      content = this.searchResult.meta.dataType.toLowerCase();\r\n    }*/\r\n    return content;\r\n  }\r\n\r\n  // get toastPanelTitle(): string {\r\n  //   let title;\r\n  //   if (\r\n  //     this.toastPanelContent !== 'workspace' &&\r\n  //     this.searchResult !== undefined\r\n  //   ) {\r\n  //     title = getEntityTitle(this.searchResult);\r\n  //   }\r\n  //   return title;\r\n  // }\r\n\r\n  get workspaceStore(): WorkspaceStore {\r\n    return this.workspaceState.store;\r\n  }\r\n\r\n  get workspace(): Workspace {\r\n    return this.workspaceState.workspace$.value;\r\n  }\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    public workspaceState: WorkspaceState,\r\n    public authService: AuthService,\r\n    public mediaService: MediaService,\r\n    public layerService: LayerService,\r\n    public dataSourceService: DataSourceService,\r\n    public cdRef: ChangeDetectorRef,\r\n    public capabilitiesService: CapabilitiesService,\r\n    private contextState: ContextState,\r\n    private mapState: MapState,\r\n    private searchState: SearchState,\r\n    private queryState: QueryState,\r\n    private toolState: ToolState,\r\n    private searchSourceService: SearchSourceService,\r\n    private configService: ConfigService,\r\n    private importService: ImportService,\r\n    private http: HttpClient,\r\n    private languageService: LanguageService,\r\n    private messageService: MessageService,\r\n    private welcomeWindowService: WelcomeWindowService,\r\n    public dialogWindow: MatDialog,\r\n    private queryService: QueryService,\r\n    private storageService: StorageService,\r\n    private editionWorkspaceService: EditionWorkspaceService,\r\n    private directionState: DirectionState,\r\n    private mapRtssProximityState: MapRtssProximityState,\r\n    private mapProximityState: MapProximityState,\r\n    private geoDBService: GeoDBService\r\n  ) {\r\n    this.hasExpansionPanel = this.configService.getConfig('hasExpansionPanel');\r\n    this.hasHomeExtentButton =\r\n      this.configService.getConfig('homeExtentButton') === undefined ? false : true;\r\n    this.hasGeolocateButton = this.configService.getConfig('hasGeolocateButton') === undefined ? true :\r\n      this.configService.getConfig('hasGeolocateButton');\r\n    this.showRotationButtonIfNoRotation = this.configService.getConfig('showRotationButtonIfNoRotation') === undefined ? false :\r\n      this.configService.getConfig('showRotationButtonIfNoRotation');\r\n    this.showMenuButton = this.configService.getConfig('showMenuButton') === undefined ? true :\r\n      this.configService.getConfig('showMenuButton');\r\n    this.showSearchBar = this.configService.getConfig('showSearchBar') === undefined ? true :\r\n      this.configService.getConfig('showSearchBar');\r\n    this.forceCoordsNA = this.configService.getConfig('app.forceCoordsNA');\r\n    this.hasFeatureEmphasisOnSelection = this.configService.getConfig('hasFeatureEmphasisOnSelection');\r\n\r\n\r\n    this.igoSearchPointerSummaryEnabled = this.configService.getConfig('hasSearchPointerSummary');\r\n    if (this.igoSearchPointerSummaryEnabled === undefined) {\r\n      this.igoSearchPointerSummaryEnabled = this.storageService.get('searchPointerSummaryEnabled') as boolean || false;\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    window['IGO'] = this;\r\n    this.searchState.searchTermSplitter$.next(this.termSplitter);\r\n\r\n    this.initWelcomeWindow();\r\n\r\n    this.authService.authenticate$.subscribe((authenticated) => {\r\n      this.contextLoaded = false;\r\n    });\r\n\r\n    this.context$$ = this.contextState.context$.subscribe(\r\n      (context: DetailedContext) => this.onChangeContext(context)\r\n    );\r\n\r\n    this.contextMenuStore.load([\r\n      {\r\n        id: 'coordinates',\r\n        title: 'coordinates',\r\n        handler: () => this.searchCoordinate(this.contextMenuCoord)\r\n      },\r\n      {\r\n        id: 'googleMaps',\r\n        title: 'googleMap',\r\n        handler: () => this.openGoogleMaps(this.contextMenuCoord)\r\n      },\r\n      {\r\n        id: 'googleStreetView',\r\n        title: 'googleStreetView',\r\n        handler: () => this.openGoogleStreetView(this.contextMenuCoord)\r\n      }\r\n    ]);\r\n\r\n    this.queryStore.count$\r\n      .pipe(pairwise())\r\n      .subscribe(([prevCnt, currentCnt]) => {\r\n        this.map.viewController.padding[2] = currentCnt ? 280 : 0;\r\n        // on mobile. Close the toast if workspace is opened, on new query\r\n        if (\r\n          prevCnt === 0 &&\r\n          currentCnt !== prevCnt &&\r\n          this.isMobile() &&\r\n          this.hasExpansionPanel &&\r\n          this.expansionPanelExpanded &&\r\n          this.toastPanelOpened\r\n        ) {\r\n          this.toastPanelOpened = false;\r\n        }\r\n      });\r\n    this.map.ol.once('rendercomplete', () => {\r\n      this.readQueryParams();\r\n    });\r\n\r\n    this.onSettingsChange$.subscribe(() => {\r\n      this.searchState.setSearchSettingsChange();\r\n    });\r\n\r\n    this.searchState.selectedResult$.subscribe((result) => {\r\n      if (result && this.isMobile()) {\r\n        this.closeSidenav();\r\n      }\r\n    });\r\n\r\n    this.workspaceState.workspaceEnabled$.next(this.hasExpansionPanel);\r\n    this.workspaceState.store.empty$.subscribe((workspaceEmpty) => {\r\n      if (!this.hasExpansionPanel) {\r\n        return;\r\n      }\r\n      this.workspaceState.workspaceEnabled$.next(workspaceEmpty ? false : true);\r\n      if (workspaceEmpty) {\r\n        this.expansionPanelExpanded = false;\r\n      }\r\n      this.updateMapBrowserClass();\r\n    });\r\n\r\n    this.workspaceMaximize$$.push(this.workspaceState.workspaceMaximize$.subscribe((workspaceMaximize) => {\r\n      this.workspaceMaximize$.next(workspaceMaximize);\r\n      this.updateMapBrowserClass();\r\n    }));\r\n    this.workspaceMaximize$$.push(\r\n      this.workspaceMaximize$.subscribe(() => this.updateMapBrowserClass())\r\n    );\r\n\r\n    this.workspaceState.workspace$.subscribe((activeWks: WfsWorkspace | FeatureWorkspace | EditionWorkspace) => {\r\n      if (activeWks) {\r\n        this.selectedWorkspace$.next(activeWks);\r\n        this.expansionPanelExpanded = true;\r\n\r\n        if (activeWks.layer.options.workspace?.pageSize && activeWks.layer.options.workspace?.pageSizeOptions) {\r\n          this.paginatorOptions = {\r\n            pageSize: activeWks.layer.options.workspace?.pageSize,\r\n            pageSizeOptions: activeWks.layer.options.workspace?.pageSizeOptions\r\n          };\r\n        } else {\r\n          this.paginatorOptions = {\r\n            pageSize: 50,\r\n            pageSizeOptions: [1, 5, 10, 20, 50, 100, 500]\r\n          };\r\n        }\r\n      } else {\r\n        this.expansionPanelExpanded = false;\r\n      }\r\n    });\r\n\r\n    this.activeWidget$$ = this.workspaceState.activeWorkspaceWidget$.subscribe(\r\n      (widget: Widget) => {\r\n        if (widget !== undefined) {\r\n          this.openToastPanelForExpansion();\r\n          this.showToastPanelForExpansionToggle = true;\r\n        } else {\r\n          this.closeToastPanelForExpansion();\r\n          this.showToastPanelForExpansionToggle = false;\r\n        }\r\n      }\r\n    );\r\n\r\n    this.openSidenav$$ = this.toolState.openSidenav$.subscribe(\r\n      (openSidenav: boolean) => {\r\n        if (openSidenav) {\r\n          this.openSidenav();\r\n          this.toolState.openSidenav$.next(false);\r\n        }\r\n      }\r\n    );\r\n\r\n    this.sidenavMediaAndOrientation$$ =\r\n      combineLatest([\r\n        this.sidenavOpened$,\r\n        this.mediaService.media$,\r\n        this.mediaService.orientation$]\r\n      ).pipe(\r\n        debounceTime(50)\r\n      ).subscribe((sidenavMediaAndOrientation: [boolean, string, string]) => {\r\n        this.computeToastPanelOffsetX();\r\n      });\r\n      this.initSW();\r\n      this.mapRtssProximityState.currentRTSSCh$.subscribe(rtss => {\r\n        if (rtss) {\r\n          this.mapProximityState.proximityFeatureStore.delete(rtss);\r\n          this.mapProximityState.proximityFeatureStore.insert(rtss);\r\n          const route = rtss.properties.num_rts.substring(0,5);\r\n          const tronc = rtss.properties.num_rts.substring(5,7);\r\n          const sect = rtss.properties.num_rts.substring(7,10);\r\n          const srte = rtss.properties.num_rts.substring(10,14);\r\n          const chainage = rtss.properties.chainage;\r\n          const thousand = Math.floor(chainage/1000);\r\n          const units = this.padWithZero(chainage%1000,3);\r\n          this.infoContent = `${route}-${tronc}-${sect}-${srte}\r\n${thousand}+${units}\r\n${rtss.properties.distance} m`;\r\n        } else {\r\n          this.infoContent = undefined;\r\n        }\r\n      });\r\n\r\n    if (this.storageService.get('favorite.context.uri')) {\r\n      this.toolbox.activateTool(\"map-rtss-proximity\");\r\n    }\r\n  }\r\n\r\n  padWithZero(num, targetLength) {\r\n    return String(num).padStart(targetLength, '0');\r\n  }\r\n\r\n  private initSW() {\r\n\r\n    const urlBase = \"https://ws.mapserver.transports.gouv.qc.ca/donnees/geomatique/sigo-terrain\";\r\n    const dgts = [\r\n      \"Aeroportuaire\", \"DGT29\", \"DGT63-65\", \"DGT64-70\",\r\n      \"DGT66\", \"DGT67\", \"DGT68\", \"DGT71\", \"DGT81-91\", \"DGT86\", \"DGT88\", \"DGT89\", \"DGT90\"\r\n    ];\r\n    const ds = [\"rtss\",\"gsq\",\"pon\",\"cs\",\"mun\"];\r\n    const dataList = [];\r\n    dgts.map(dgt => {\r\n      ds.map(d => dataList.push(`${urlBase}/${dgt}/${d}.geojson`));\r\n    });\r\n\r\n    if ('serviceWorker' in navigator) {\r\n      let downloadMessage;\r\n      let currentVersion;\r\n      navigator.serviceWorker.ready.then((registration) => {\r\n        console.log('Service Worker Ready');\r\n        this.http.get('ngsw.json').pipe(\r\n          concatMap((ngsw: any) => {\r\n            const datas$ = [];\r\n            let hasDataInDataDir: boolean = false;\r\n            if (ngsw) {\r\n              // IF FILE NOT IN THIS LIST... DELETE?\r\n              currentVersion = ngsw.appData.version;\r\n              const cachedDataVersion = this.storageService.get('cachedDataVersion');\r\n              if (currentVersion !== cachedDataVersion) {\r\n                ((ngsw as any).assetGroups as any).map((assetGroup) => {\r\n                  if (assetGroup.name === 'contexts') {\r\n                    if (assetGroup.name === 'data') { // pas necessaire\r\n                      hasDataInDataDir = assetGroup.urls.concat(assetGroup.files).length > 0;\r\n                    }\r\n                    const elemToDownload = assetGroup.urls.concat(assetGroup.files).filter(f => f);\r\n                    elemToDownload.map((url,i) => datas$.push(this.http.get(url).pipe(delay(750))));\r\n                  }\r\n                });\r\n                if (hasDataInDataDir) {\r\n                  const message = this.languageService.translate.instant('pwa.data-download-start');\r\n                  downloadMessage = this.messageService\r\n                    .info(message, undefined, { disableTimeOut: true, progressBar: false, closeButton: true, tapToDismiss: false });\r\n                }\r\n                return zip(...datas$);\r\n              }\r\n\r\n            }\r\n            return zip(...datas$);\r\n          }),\r\n          concatMap((datas) => {\r\n            if (datas.length > 0 && dataList.length > 0) {\r\n              const message = this.languageService.translate.instant('pwa.data-download-start');\r\n              downloadMessage = this.messageService\r\n                .info(message, undefined, { disableTimeOut: true, progressBar: false, closeButton: true, tapToDismiss: false });\r\n              const datas2$ = [];\r\n              dataList.map((url,i) => datas2$.push(\r\n                this.http.get(url).pipe(\r\n                  concatMap(r => {\r\n                    return this.geoDBService.update(url, i, r, 'system' as any, 'automatedUpdatePWA');\r\n                }),\r\n                )\r\n                ));\r\n              return zip(...datas2$);\r\n            }\r\n            return of(datas);\r\n          })\r\n        )\r\n        .pipe(delay(1000))\r\n        .subscribe(() => {\r\n          if (downloadMessage) {\r\n            this.messageService.remove((downloadMessage as any).toastId);\r\n            const message = this.languageService.translate.instant('pwa.data-download-completed');\r\n            this.messageService.success(message, undefined, { timeOut: 40000 });\r\n            if (currentVersion) {\r\n              this.storageService.set('cachedDataVersion', currentVersion);\r\n            }\r\n          }\r\n        });\r\n\r\n      });\r\n    }\r\n  }\r\n\r\n  setToastPanelHtmlDisplay(value) {\r\n    this.toastPanelHtmlDisplay = value;\r\n    this.computeToastPanelOffsetX();\r\n  }\r\n\r\n  computeToastPanelOffsetX() {\r\n    if (this.isMobile() || !this.isLandscape()) {\r\n      Promise.resolve().then(() => this.toastPanelOffsetX$.next(undefined));\r\n    } else {\r\n      Promise.resolve().then(() => this.toastPanelOffsetX$.next(this.getToastPanelExtent()));\r\n    }\r\n  }\r\n\r\n  workspaceVisibility(): boolean {\r\n    const wks = (this.selectedWorkspace$.value as WfsWorkspace | FeatureWorkspace | EditionWorkspace);\r\n    if (wks.inResolutionRange$.value) {\r\n      if (wks.entityStore.empty$.value && !wks.layer.visible) {\r\n        this.workspaceNotAvailableMessage = 'workspace.disabled.visible';\r\n      } else {\r\n        this.workspaceNotAvailableMessage = '';\r\n      }\r\n    } else {\r\n      this.workspaceNotAvailableMessage = 'workspace.disabled.resolution';\r\n    }\r\n    return wks.inResolutionRange$.value;\r\n  }\r\n\r\n  isEditionWorkspace(workspace) {\r\n    if (workspace instanceof EditionWorkspace) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addFeature(workspace: EditionWorkspace) {\r\n    let feature = {\r\n      type: \"Feature\",\r\n      properties: {}\r\n    };\r\n    feature.properties = this.createFeatureProperties(workspace.layer);\r\n    this.workspaceState.rowsInMapExtentCheckCondition$.next(false);\r\n    workspace.editFeature(feature, workspace);\r\n  }\r\n\r\n  createFeatureProperties(layer: ImageLayer | VectorLayer) {\r\n    let properties = {};\r\n    layer.options.sourceOptions.sourceFields.forEach(field => {\r\n      if (!field.primary && field.visible) {\r\n        properties[field.name] = '';\r\n      }\r\n    });\r\n    return properties;\r\n  }\r\n\r\n  paginatorChange(matPaginator: MatPaginator) {\r\n    this.workspacePaginator = matPaginator;\r\n  }\r\n\r\n  entitySortChange() {\r\n    this.workspaceEntitySortChange$.next(true);\r\n  }\r\n\r\n  entitySelectChange(result: { added: Feature[] }) {\r\n    const baseQuerySearchSource = this.getQuerySearchSource();\r\n    const querySearchSourceArray: QuerySearchSource[] = [];\r\n\r\n    if (this.selectedWorkspace$.value instanceof WfsWorkspace || this.selectedWorkspace$.value instanceof FeatureWorkspace) {\r\n      if (!this.selectedWorkspace$.value.getLayerWksOptionTabQuery()) {return;}\r\n    }\r\n    if (result && result.added) {\r\n      const results = result.added.map((res) => {\r\n        if (\r\n          res &&\r\n          res.ol &&\r\n          res.ol.getProperties()._featureStore.layer &&\r\n          res.ol.getProperties()._featureStore.layer.visible\r\n        ) {\r\n          const ol = res.ol as olFeature<OlGeometry>;\r\n          const featureStoreLayer = res.ol.getProperties()._featureStore.layer;\r\n          const feature = featureFromOl(\r\n            ol,\r\n            featureStoreLayer.map.projection,\r\n            featureStoreLayer.ol\r\n          );\r\n\r\n          feature.meta.alias = this.queryService.getAllowedFieldsAndAlias(\r\n            featureStoreLayer\r\n          );\r\n          feature.meta.title =\r\n            this.queryService.getQueryTitle(feature, featureStoreLayer) ||\r\n            feature.meta.title;\r\n          let querySearchSource = querySearchSourceArray.find(\r\n            (s) => s.title === feature.meta.sourceTitle\r\n          );\r\n          if (!querySearchSource) {\r\n            querySearchSource = new QuerySearchSource({\r\n              title: feature.meta.sourceTitle\r\n            });\r\n            querySearchSourceArray.push(querySearchSource);\r\n          }\r\n          return featureToSearchResult(feature, querySearchSource);\r\n        }\r\n      });\r\n\r\n      const research = {\r\n        request: of(results),\r\n        reverse: false,\r\n        source: baseQuerySearchSource\r\n      };\r\n      research.request.subscribe((queryResults: SearchResult<Feature>[]) => {\r\n        this.queryStore.load(queryResults);\r\n      });\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.context$$.unsubscribe();\r\n    this.activeWidget$$.unsubscribe();\r\n    this.openSidenav$$.unsubscribe();\r\n    this.workspaceMaximize$$.map(f => f.unsubscribe());\r\n    this.sidenavMediaAndOrientation$$.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Cancel ongoing add layer, if any\r\n   */\r\n  private cancelOngoingAddLayer() {\r\n    this.addedLayers$$.forEach((sub: Subscription) => sub.unsubscribe());\r\n    this.addedLayers$$ = [];\r\n  }\r\n\r\n  onBackdropClick() {\r\n    this.closeSidenav();\r\n  }\r\n\r\n  onToggleSidenavClick() {\r\n    this.toggleSidenav();\r\n  }\r\n\r\n  onDeactivateWorkspaceWidget() {\r\n    this.closeToastPanelForExpansion();\r\n  }\r\n\r\n  closeToastPanelForExpansion() {\r\n    this.toastPanelForExpansionOpened = false;\r\n  }\r\n\r\n  openToastPanelForExpansion() {\r\n    this.toastPanelForExpansionOpened = true;\r\n  }\r\n\r\n  onMapQuery(event: { features: Feature[]; event: MapBrowserEvent<any> }) {\r\n    const baseQuerySearchSource = this.getQuerySearchSource();\r\n    const querySearchSourceArray: QuerySearchSource[] = [];\r\n    const results = event.features.map((feature: Feature) => {\r\n      let querySearchSource = querySearchSourceArray.find(\r\n        (s) => s.title === feature.meta.sourceTitle\r\n      );\r\n      if (this.getFeatureIsSameActiveWks(feature)) {\r\n        if (this.getWksActiveOpenInResolution() && !(this.workspace as WfsWorkspace).getLayerWksOptionMapQuery()) {\r\n          return;\r\n        }\r\n      }\r\n      if (!querySearchSource) {\r\n        querySearchSource = new QuerySearchSource({\r\n          title: feature.meta.sourceTitle\r\n        });\r\n        querySearchSourceArray.push(querySearchSource);\r\n      }\r\n      return featureToSearchResult(feature, querySearchSource);\r\n    });\r\n    const filteredResults = results.filter(x => x !== undefined);\r\n    const research = {\r\n      request: of(filteredResults),\r\n      reverse: false,\r\n      source: baseQuerySearchSource\r\n    };\r\n    research.request.subscribe((queryResults: SearchResult<Feature>[]) => {\r\n      this.queryStore.load(queryResults);\r\n    });\r\n  }\r\n\r\n  onSearchTermChange(term?: string) {\r\n    if (this.routeParams?.search && term !== this.routeParams.search) {\r\n      this.searchState.deactivateCustomFilterTermStrategy();\r\n    }\r\n\r\n    this.searchState.setSearchTerm(term);\r\n    const termWithoutHashtag = term.replace(/(#[^\\s]*)/g, '').trim();\r\n    if (termWithoutHashtag.length < 2) {\r\n      this.onClearSearch();\r\n      return;\r\n    }\r\n    this.onBeforeSearch();\r\n  }\r\n\r\n  onSearch(event: { research: Research; results: SearchResult[] }) {\r\n    const results = event.results;\r\n\r\n    const isReverseSearch = !sourceCanSearch(event.research.source);\r\n\r\n    let enabledSources;\r\n    if (isReverseSearch) {\r\n      enabledSources = this.searchSourceService\r\n        .getEnabledSources()\r\n        .filter(sourceCanReverseSearch);\r\n    } else {\r\n      enabledSources = this.searchSourceService\r\n        .getEnabledSources()\r\n        .filter(sourceCanSearch);\r\n    }\r\n\r\n    const newResults = this.searchStore.entities$.value\r\n      .filter(\r\n        (result: SearchResult) =>\r\n          result.source !== event.research.source &&\r\n          enabledSources.includes(result.source)\r\n      )\r\n      .concat(results);\r\n    this.searchStore.updateMany(newResults);\r\n  }\r\n\r\n  onSearchResultsGeometryStatusChange(value) {\r\n    this.searchState.setSearchResultsGeometryStatus(value);\r\n  }\r\n\r\n  onSearchSettingsChange() {\r\n    this.onSettingsChange$.next(true);\r\n  }\r\n\r\n  private closeSidenav() {\r\n    this.sidenavOpened = false;\r\n    this.map.viewController.padding[3] = 0;\r\n  }\r\n\r\n  private openSidenav() {\r\n    this.sidenavOpened = true;\r\n    this.map.viewController.padding[3] = this.isMobile() ? 0 : 400;\r\n  }\r\n\r\n  private toggleSidenav() {\r\n    this.sidenavOpened ? this.closeSidenav() : this.openSidenav();\r\n    this.computeToastPanelOffsetX();\r\n  }\r\n\r\n  public toolChanged(tool: Tool) {\r\n    if (tool && tool.name === 'searchResults' && this.searchBar) {\r\n      this.searchBar.nativeElement.getElementsByTagName('input')[0].focus();\r\n    }\r\n  }\r\n\r\n  private computeHomeExtentValues(context: DetailedContext) {\r\n    if (context?.map?.view?.homeExtent) {\r\n      this.homeExtent = context.map.view.homeExtent.extent;\r\n      this.homeCenter = context.map.view.homeExtent.center;\r\n      this.homeZoom = context.map.view.homeExtent.zoom;\r\n    } else {\r\n      this.homeExtent = undefined;\r\n      this.homeCenter = undefined;\r\n      this.homeZoom = undefined;\r\n    }\r\n\r\n  }\r\n\r\n  private onChangeContext(context: DetailedContext) {\r\n    this.cancelOngoingAddLayer();\r\n    if (context === undefined) {\r\n      return;\r\n    }\r\n    if (!this.queryState.store.empty) {\r\n      this.queryState.store.softClear();\r\n    }\r\n\r\n    this.computeHomeExtentValues(context);\r\n\r\n    this.route.queryParams.pipe(debounceTime(250)).subscribe((qParams) => {\r\n      if (!qParams['context'] || qParams['context'] === context.uri) {\r\n        this.readLayersQueryParams(qParams);\r\n      }\r\n    });\r\n\r\n    if (this.contextLoaded) {\r\n      const contextManager = this.toolbox.getTool('contextManager');\r\n      const contextManagerOptions = contextManager\r\n        ? contextManager.options\r\n        : {};\r\n      let toolToOpen = contextManagerOptions.toolToOpenOnContextChange;\r\n\r\n      if (!toolToOpen) {\r\n        const toolOrderToOpen = ['mapTools', 'map', 'mapDetails', 'mapLegend'];\r\n        for (const toolName of toolOrderToOpen) {\r\n          if (this.toolbox.getTool(toolName)) {\r\n            toolToOpen = toolName;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (toolToOpen) {\r\n        this.toolbox.activateTool(toolToOpen);\r\n      }\r\n    }\r\n\r\n    this.contextLoaded = true;\r\n  }\r\n\r\n  private onBeforeSearch() {\r\n    if (\r\n      !this.toolbox.activeTool$.value ||\r\n      this.toolbox.activeTool$.value.name !== 'searchResults'\r\n    ) {\r\n      this.toolbox.activateTool('searchResults');\r\n    }\r\n    this.openSidenav();\r\n  }\r\n\r\n  toastOpenedChange(opened: boolean) {\r\n    this.map.viewController.padding[2] = opened ? 280 : 0;\r\n    this.handleExpansionAndToastOnMobile();\r\n    this.toastPanelOpened = opened;\r\n  }\r\n\r\n  private handleExpansionAndToastOnMobile() {\r\n    if (\r\n      this.isMobile() &&\r\n      this.hasExpansionPanel &&\r\n      this.expansionPanelExpanded &&\r\n      this.toastPanelOpened\r\n    ) {\r\n      this.expansionPanelExpanded = false;\r\n    }\r\n  }\r\n\r\n  public onClearSearch() {\r\n    this.map.searchResultsOverlay.clear();\r\n    this.searchStore.clear();\r\n    this.searchState.setSelectedResult(undefined);\r\n    this.searchState.deactivateCustomFilterTermStrategy();\r\n  }\r\n\r\n  private getQuerySearchSource(): SearchSource {\r\n    return this.searchSourceService\r\n      .getSources()\r\n      .find(\r\n        (searchSource: SearchSource) =>\r\n          searchSource instanceof QuerySearchSource\r\n      );\r\n  }\r\n\r\n  onContextMenuOpen(event: { x: number; y: number }) {\r\n    this.contextMenuCoord = this.getClickCoordinate(event) as [number, number];\r\n  }\r\n\r\n  private getClickCoordinate(event: { x: number; y: number }) {\r\n    const contextmenuPoint = event;\r\n    const boundingMapBrowser = this.mapBrowser.nativeElement.getBoundingClientRect();\r\n    contextmenuPoint.y =\r\n      contextmenuPoint.y -\r\n      boundingMapBrowser.top +\r\n      (window.scrollY || window.pageYOffset);\r\n    contextmenuPoint.x =\r\n      contextmenuPoint.x -\r\n      boundingMapBrowser.left +\r\n      (window.scrollX || window.pageXOffset);\r\n    const pixel = [contextmenuPoint.x, contextmenuPoint.y];\r\n\r\n    const coord = this.map.ol.getCoordinateFromPixel(pixel);\r\n    const proj = this.map.projection;\r\n    return olProj.transform(coord, proj, 'EPSG:4326');\r\n  }\r\n\r\n  private openGoogleMaps(coord: [number, number]) {\r\n    window.open(GoogleLinks.getGoogleMapsCoordLink(coord[0], coord[1]));\r\n  }\r\n\r\n  private openGoogleStreetView(coord: [number, number]) {\r\n    window.open(GoogleLinks.getGoogleStreetViewLink(coord[0], coord[1]));\r\n  }\r\n\r\n  searchCoordinate(coord: [number, number]) {\r\n    this.searchBarTerm = coord.map((c) => c.toFixed(6)).join(', ');\r\n  }\r\n\r\n  updateMapBrowserClass() {\r\n    const header = this.queryState.store.entities$.value.length > 0;\r\n    if (this.hasExpansionPanel && this.workspaceState.workspaceEnabled$.value) {\r\n      this.mapBrowser.nativeElement.classList.add('has-expansion-panel');\r\n    } else {\r\n      this.mapBrowser.nativeElement.classList.remove('has-expansion-panel');\r\n    }\r\n\r\n    if (this.hasExpansionPanel && this.expansionPanelExpanded) {\r\n      if (this.workspaceMaximize$.value) {\r\n        this.mapBrowser.nativeElement.classList.add('expansion-offset-maximized');\r\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset');\r\n      } else {\r\n        this.mapBrowser.nativeElement.classList.add('expansion-offset');\r\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset-maximized');\r\n      }\r\n    } else {\r\n      if (this.workspaceMaximize$.value) {\r\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset-maximized');\r\n      } else {\r\n        this.mapBrowser.nativeElement.classList.remove('expansion-offset');\r\n      }\r\n    }\r\n\r\n    if (this.sidenavOpened) {\r\n      this.mapBrowser.nativeElement.classList.add('sidenav-offset');\r\n    } else {\r\n      this.mapBrowser.nativeElement.classList.remove('sidenav-offset');\r\n    }\r\n\r\n    if (this.sidenavOpened && !this.isMobile()) {\r\n      this.mapBrowser.nativeElement.classList.add('sidenav-offset-baselayers');\r\n    } else {\r\n      this.mapBrowser.nativeElement.classList.remove(\r\n        'sidenav-offset-baselayers'\r\n      );\r\n    }\r\n\r\n    if (!this.toastPanelOpened && header && !this.expansionPanelExpanded) {\r\n      this.mapBrowser.nativeElement.classList.add('toast-offset-scale-line');\r\n    } else {\r\n      this.mapBrowser.nativeElement.classList.remove('toast-offset-scale-line');\r\n    }\r\n\r\n    if (\r\n      !this.toastPanelOpened &&\r\n      header &&\r\n      (this.isMobile() || this.isTablet() || this.sidenavOpened) &&\r\n      !this.expansionPanelExpanded\r\n    ) {\r\n      this.mapBrowser.nativeElement.classList.add('toast-offset-attribution');\r\n    } else {\r\n      this.mapBrowser.nativeElement.classList.remove(\r\n        'toast-offset-attribution'\r\n      );\r\n    }\r\n  }\r\n\r\n  getToastPanelExtent() {\r\n    if (!this.sidenavOpened) {\r\n      if (this.toastPanelHtmlDisplay && this.mediaService.isDesktop()) {\r\n        return 'htmlDisplay';\r\n      }\r\n      if (this.fullExtent) {\r\n        return 'fullStandard';\r\n      } else {\r\n        return 'standard';\r\n      }\r\n    } else if (this.sidenavOpened) {\r\n      if (this.toastPanelHtmlDisplay && this.mediaService.isDesktop()) {\r\n        return 'htmlDisplayOffsetX';\r\n      }\r\n      if (this.fullExtent) {\r\n        return 'fullOffsetX';\r\n      } else {\r\n        return 'standardOffsetX';\r\n      }\r\n    }\r\n  }\r\n\r\n  onPointerSummaryStatusChange(value) {\r\n    this.storageService.set('searchPointerSummaryEnabled', value);\r\n    this.igoSearchPointerSummaryEnabled = value;\r\n  }\r\n\r\n  getExpansionPanelStatus() {\r\n    if (this.sidenavOpened === false) {\r\n      if (this.expansionPanelExpanded === true) {\r\n        return 'full';\r\n      }\r\n      return 'notTriggered';\r\n    }\r\n    if (this.sidenavOpened === true && this.isMobile() === false) {\r\n      if (this.expansionPanelExpanded === true) {\r\n        return 'reduced';\r\n      }\r\n      return 'reducedNotTriggered';\r\n    }\r\n    if (this.sidenavOpened === true && this.isMobile() === true) {\r\n      if (this.expansionPanelExpanded === true) {\r\n        return 'mobile';\r\n      } else {\r\n        return 'notVisible';\r\n      }\r\n    }\r\n  }\r\n\r\n  getToastPanelOffsetY() {\r\n    let status = 'noExpansion';\r\n    if (this.expansionPanelExpanded) {\r\n      if (this.workspaceMaximize$.value) {\r\n        if (this.toastPanelOpened) {\r\n          status = 'expansionMaximizedAndToastOpened';\r\n        } else {\r\n          status = 'expansionMaximizedAndToastClosed';\r\n        }\r\n      } else {\r\n        if (this.toastPanelOpened) {\r\n          status = 'expansionAndToastOpened';\r\n        } else {\r\n          status = 'expansionAndToastClosed';\r\n        }\r\n      }\r\n    } else {\r\n      status = 'noExpansion';\r\n    }\r\n    return status;\r\n  }\r\n\r\n  getToastPanelStatus() {\r\n    if (this.isMobile() === true && this.toastPanelOpened === false) {\r\n      if (this.sidenavOpened === false) {\r\n        if (this.expansionPanelExpanded === false) {\r\n          if (this.queryState.store.entities$.value.length > 0) {\r\n            return 'low';\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  getControlsOffsetY() {\r\n    return this.expansionPanelExpanded ?\r\n      this.workspaceMaximize$.value ? 'firstRowFromBottom-expanded-maximized' : 'firstRowFromBottom-expanded' :\r\n      'firstRowFromBottom';\r\n  }\r\n\r\n  getBaselayersSwitcherStatus() {\r\n    let status;\r\n    if (this.isMobile()) {\r\n\r\n      if (this.workspaceState.workspaceEnabled$.value) {\r\n        if (this.expansionPanelExpanded === false) {\r\n          if (this.queryState.store.entities$.value.length === 0) {\r\n            status = 'secondRowFromBottom';\r\n          } else {\r\n            status = 'thirdRowFromBottom';\r\n          }\r\n        } else {\r\n          if (this.queryState.store.entities$.value.length === 0) {\r\n            status = 'firstRowFromBottom-expanded';\r\n          } else {\r\n            status = 'secondRowFromBottom-expanded';\r\n          }\r\n        }\r\n\r\n      } else {\r\n        if (this.queryState.store.entities$.value.length === 0) {\r\n          status = 'firstRowFromBottom';\r\n        } else {\r\n          status = 'secondRowFromBottom';\r\n        }\r\n      }\r\n    } else {\r\n      if (this.workspaceState.workspaceEnabled$.value) {\r\n        if (this.expansionPanelExpanded) {\r\n          if (this.workspaceMaximize$.value) {\r\n            status = 'firstRowFromBottom-expanded-maximized';\r\n          } else {\r\n            status = 'firstRowFromBottom-expanded';\r\n          }\r\n        } else {\r\n          status = 'secondRowFromBottom';\r\n        }\r\n      } else {\r\n        status = 'firstRowFromBottom';\r\n      }\r\n    }\r\n    return status;\r\n  }\r\n\r\n  private readQueryParams() {\r\n    this.route.queryParams.subscribe((params) => {\r\n      this.routeParams = params;\r\n      this.readToolParams();\r\n      this.readSearchParams();\r\n      this.readFocusFirst();\r\n      this.computeZoomToExtent();\r\n    });\r\n  }\r\n\r\n  private computeZoomToExtent() {\r\n    if (this.routeParams['zoomExtent']) {\r\n      const extentParams = this.routeParams['zoomExtent'].split(',');\r\n      const olExtent = olProj.transformExtent(\r\n        extentParams,\r\n        'EPSG:4326',\r\n        this.map.projection\r\n      );\r\n      this.map.viewController.zoomToExtent(olExtent as [number, number, number, number]);\r\n    }\r\n  }\r\n\r\n  private computeFocusFirst() {\r\n    setTimeout(() => {\r\n      const resultItem: any = document\r\n        .getElementsByTagName('igo-search-results-item')\r\n        .item(0);\r\n      if (resultItem) {\r\n        resultItem.click();\r\n      }\r\n    }, 1);\r\n  }\r\n\r\n  private readFocusFirst() {\r\n    if (this.routeParams['sf'] === '1' && this.termDefinedInUrl) {\r\n      const entities$$ = this.searchStore.stateView.all$()\r\n        .pipe(\r\n          skipWhile((entities) => entities.length === 0),\r\n          debounceTime(500),\r\n          take(1)\r\n        )\r\n        .subscribe((entities) => {\r\n          entities$$.unsubscribe();\r\n          if (entities.length && !this.termDefinedInUrlTriggered) {\r\n            this.computeFocusFirst();\r\n            this.termDefinedInUrlTriggered = true;\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  private readSearchParams() {\r\n    if (this.routeParams['search']) {\r\n      this.termDefinedInUrl = true;\r\n      if (this.routeParams['exactMatch'] === '1') {\r\n        this.searchState.activateCustomFilterTermStrategy();\r\n      }\r\n      if (this.routeParams['search'] && !this.routeParams['zoom'] && this.routeParams['sf'] !== '1') {\r\n        const entities$$ = this.searchStore.stateView.all$()\r\n          .pipe(\r\n            skipWhile((entities) => entities.length === 0),\r\n            debounceTime(500),\r\n            take(1)\r\n          )\r\n          .subscribe((entities) => {\r\n            entities$$.unsubscribe();\r\n            const searchResultsOlFeatures = entities\r\n              .filter(e => e.entity.meta.dataType === FEATURE)\r\n              .map((entity: EntityRecord<SearchResult>) =>\r\n                new olFormatGeoJSON().readFeature(entity.entity.data, {\r\n                  dataProjection: entity.entity.data.projection,\r\n                  featureProjection: this.map.projection\r\n                })\r\n              );\r\n            const totalExtent = computeOlFeaturesExtent(this.map, searchResultsOlFeatures);\r\n            this.map.viewController.zoomToExtent(totalExtent);\r\n          });\r\n      }\r\n      this.searchBarTerm = this.routeParams['search'];\r\n    }\r\n    if (this.routeParams['searchGeom'] === '1') {\r\n      this.searchState.searchResultsGeometryEnabled$.next(true);\r\n    }\r\n  }\r\n\r\n  private readToolParams() {\r\n    if (this.routeParams['tool']) {\r\n      this.matDialogRef$.pipe(\r\n        skipWhile(r => r !== undefined),\r\n        first()\r\n      ).subscribe(matDialogOpened => {\r\n        if (!matDialogOpened) {\r\n          this.toolbox.activateTool(this.routeParams['tool']);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (this.routeParams['sidenav'] === '1') {\r\n      setTimeout(() => {\r\n        this.openSidenav();\r\n      }, 250);\r\n    }\r\n\r\n    if (this.routeParams['routing']) {\r\n      let routingCoordLoaded = false;\r\n      const stopCoords = this.routeParams['routing'].split(';');\r\n      const routingOptions = this.routeParams['routingOptions'];\r\n      let resultSelection: number;\r\n      if (routingOptions) {\r\n        resultSelection = parseInt(routingOptions.split('result:')[1], 10);\r\n      }\r\n      this.directionState.stopsStore.storeInitialized$\r\n        .pipe(skipWhile(init => !init), first())\r\n        .subscribe((init: boolean) => {\r\n          if (init && !routingCoordLoaded) {\r\n            routingCoordLoaded = true;\r\n            stopCoords.map((coord, i) => {\r\n              if (i > 1) {\r\n                addStopToStore(this.directionState.stopsStore);\r\n              }\r\n            });\r\n            setTimeout(() => {\r\n              stopCoords.map((coord, i) => {\r\n                const stop = this.directionState.stopsStore.all().find(e => e.position === i);\r\n                stop.text = coord;\r\n                stop.coordinates = coord.split(',');\r\n                this.directionState.stopsStore.update(stop);\r\n              });\r\n            }, this.directionState.debounceTime * 1.25); // this delay is due to the default component debounce time\r\n          }\r\n        });\r\n      // zoom to active route\r\n      this.directionState.routesFeatureStore.count$\r\n        .pipe(skipWhile(c => c < 1), first())\r\n        .subscribe(c => {\r\n          if (c >= 1) {\r\n            this.directionState.zoomToActiveRoute$.next();\r\n          }\r\n        });\r\n      // select the active route by url controls\r\n      this.directionState.routesFeatureStore.count$\r\n        .pipe(skipWhile(c => c < 2), first())\r\n        .subscribe(() => {\r\n          if (resultSelection) {\r\n            this.directionState.routesFeatureStore.entities$.value.map(d => d.properties.active = false);\r\n            this.directionState.routesFeatureStore.entities$.value[resultSelection].properties.active = true;\r\n            this.directionState.zoomToActiveRoute$.next();\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  private readLayersQueryParams(params: Params) {\r\n    this.readLayersQueryParamsByType(params, 'wms');\r\n    this.readLayersQueryParamsByType(params, 'wmts');\r\n    this.readLayersQueryParamsByType(params, 'arcgisrest');\r\n    this.readLayersQueryParamsByType(params, 'imagearcgisrest');\r\n    this.readLayersQueryParamsByType(params, 'tilearcgisrest');\r\n    this.readVectorQueryParams(params);\r\n  }\r\n\r\n  getQueryParam(name, url) {\r\n    let paramValue;\r\n    if (url.includes('?')) {\r\n      const httpParams = new HttpParams({ fromString: url.split('?')[1] });\r\n      paramValue = httpParams.get(name);\r\n    }\r\n    return paramValue;\r\n  }\r\n\r\n  private readLayersQueryParamsByType(params: Params, type) {\r\n    let nameParamLayersKey;\r\n    let urlsKey;\r\n    switch (type) {\r\n      case 'wms':\r\n        if ((params['layers'] || params['wmsLayers']) && params['wmsUrl']) {\r\n          urlsKey = 'wmsUrl';\r\n          nameParamLayersKey = params['wmsLayers'] ? 'wmsLayers' : 'layers'; // for maintain compatibility\r\n        }\r\n        break;\r\n      case 'wmts':\r\n        if (params['wmtsLayers'] && params['wmtsUrl']) {\r\n          urlsKey = 'wmtsUrl';\r\n          nameParamLayersKey = 'wmtsLayers';\r\n        }\r\n        break;\r\n      case 'arcgisrest':\r\n        if (params['arcgisLayers'] && params['arcgisUrl']) {\r\n          urlsKey = 'arcgisUrl';\r\n          nameParamLayersKey = 'arcgisLayers';\r\n        }\r\n        break;\r\n      case 'imagearcgisrest':\r\n        if (params['iarcgisLayers'] && params['iarcgisUrl']) {\r\n          urlsKey = 'iarcgisUrl';\r\n          nameParamLayersKey = 'iarcgisLayers';\r\n        }\r\n        break;\r\n      case 'tilearcgisrest':\r\n        if (params['tarcgisLayers'] && params['tarcgisUrl']) {\r\n          urlsKey = 'tarcgisUrl';\r\n          nameParamLayersKey = 'tarcgisLayers';\r\n        }\r\n        break;\r\n    }\r\n    if (!nameParamLayersKey || !urlsKey) {\r\n      return;\r\n    }\r\n    const layersByService = params[nameParamLayersKey].split('),(');\r\n    const urls = params[urlsKey].split(',');\r\n\r\n    let cnt = 0;\r\n    urls.forEach((urlSrc) => {\r\n      let url = urlSrc;\r\n      const version =\r\n        this.getQueryParam('VERSION', url) ||\r\n        this.getQueryParam('version', url) ||\r\n        undefined;\r\n      if (version) {\r\n        url = url.replace('VERSION=' + version, '').replace('version=' + version, '');\r\n      }\r\n\r\n      const currentLayersByService = this.extractLayersByService(\r\n        layersByService[cnt]\r\n      );\r\n      currentLayersByService.forEach((layer) => {\r\n        const layerFromUrl = layer.split(':igoz');\r\n        const layerOptions = ObjectUtils.removeUndefined({\r\n          type,\r\n          url: url,\r\n          layer: layerFromUrl[0],\r\n          params: type === 'wms' ? { LAYERS: layerFromUrl[0] } : undefined\r\n        });\r\n        const id = generateIdFromSourceOptions(layerOptions);\r\n        const visibility = this.computeLayerVisibilityFromUrl(params, id);\r\n        this.addLayerFromURL(\r\n          url,\r\n          layerFromUrl[0],\r\n          type,\r\n          version,\r\n          visibility,\r\n          layerFromUrl[1] ? parseInt(layerFromUrl[1], 10) : undefined\r\n        );\r\n      });\r\n      cnt += 1;\r\n    });\r\n  }\r\n\r\n  private readVectorQueryParams(params: Params) {\r\n    if (params['vector']) {\r\n      const url = params['vector'] as string;\r\n      const lastIndex = url.lastIndexOf('/');\r\n      const fileName = url.slice(lastIndex + 1, url.length);\r\n\r\n      this.http.get(`${url}`, { responseType: 'blob' }).subscribe((data) => {\r\n        const file = new File([data], fileName, {\r\n          type: data.type,\r\n          lastModified: Date.now()\r\n        });\r\n        this.importService.import(file).subscribe(\r\n          (features: Feature[]) => this.onFileImportSuccess(file, features),\r\n          (error: Error) => this.onFileImportError(file, error)\r\n        );\r\n      });\r\n    }\r\n  }\r\n\r\n  private onFileImportSuccess(file: File, features: Feature[]) {\r\n    handleFileImportSuccess(\r\n      file,\r\n      features,\r\n      this.map,\r\n      this.messageService,\r\n      this.languageService\r\n    );\r\n  }\r\n\r\n  private onFileImportError(file: File, error: Error) {\r\n    handleFileImportError(\r\n      file,\r\n      error,\r\n      this.messageService,\r\n      this.languageService\r\n    );\r\n  }\r\n\r\n  private extractLayersByService(layersByService: string): any[] {\r\n    let outLayersByService = layersByService;\r\n    outLayersByService = outLayersByService.startsWith('(')\r\n      ? outLayersByService.substr(1)\r\n      : outLayersByService;\r\n    outLayersByService = outLayersByService.endsWith(')')\r\n      ? outLayersByService.slice(0, -1)\r\n      : outLayersByService;\r\n    return outLayersByService.split(',');\r\n  }\r\n  private addLayerFromURL(\r\n    url: string,\r\n    name: string,\r\n    type: 'wms' | 'wmts' | 'arcgisrest' | 'imagearcgisrest' | 'tilearcgisrest',\r\n    version: string,\r\n    visibility: boolean = true,\r\n    zIndex: number\r\n  ) {\r\n    if (!this.contextLoaded) {\r\n      return;\r\n    }\r\n    const commonSourceOptions = {\r\n      optionsFromCapabilities: true,\r\n      optionsFromApi: true,\r\n      crossOrigin: true,\r\n      type,\r\n      url\r\n    };\r\n    const arcgisClause = (type === 'arcgisrest' || type === 'imagearcgisrest' || type === 'tilearcgisrest');\r\n    let sourceOptions = {\r\n      version: type === 'wmts' ? '1.0.0' : undefined,\r\n      queryable: arcgisClause ? true : false,\r\n      queryFormat: arcgisClause ? 'esrijson' : undefined,\r\n      layer: name\r\n    };\r\n    if (type === 'wms') {\r\n      sourceOptions = { params: { LAYERS: name, VERSION: version } } as any;\r\n    }\r\n\r\n    sourceOptions = ObjectUtils.removeUndefined(Object.assign({}, sourceOptions, commonSourceOptions));\r\n\r\n    this.addedLayers$$.push(\r\n      this.layerService\r\n        .createAsyncLayer({\r\n          zIndex: zIndex,\r\n          visible: visibility,\r\n          sourceOptions\r\n        })\r\n        .subscribe((l) => {\r\n          this.map.addLayer(l);\r\n        })\r\n    );\r\n  }\r\n\r\n  private computeLayerVisibilityFromUrl(\r\n    params: Params,\r\n    currentLayerid: string\r\n  ): boolean {\r\n    const queryParams = params;\r\n    let visible = true;\r\n    if (!queryParams || !currentLayerid) {\r\n      return visible;\r\n    }\r\n    let visibleOnLayersParams = '';\r\n    let visibleOffLayersParams = '';\r\n    let visiblelayers: string[] = [];\r\n    let invisiblelayers: string[] = [];\r\n    if (queryParams['visiblelayers']) {\r\n      visibleOnLayersParams = queryParams['visiblelayers'];\r\n    }\r\n    if (queryParams['invisiblelayers']) {\r\n      visibleOffLayersParams = queryParams['invisiblelayers'];\r\n    }\r\n\r\n    /* This order is important because to control whichever\r\n     the order of * param. First whe open and close everything.*/\r\n    if (visibleOnLayersParams === '*') {\r\n      visible = true;\r\n    }\r\n    if (visibleOffLayersParams === '*') {\r\n      visible = false;\r\n    }\r\n\r\n    // After, managing named layer by id (context.json OR id from datasource)\r\n    visiblelayers = visibleOnLayersParams.split(',');\r\n    invisiblelayers = visibleOffLayersParams.split(',');\r\n    if (visiblelayers.indexOf(currentLayerid) > -1 || visiblelayers.indexOf(currentLayerid.toString()) > -1) {\r\n      visible = true;\r\n    }\r\n    if (invisiblelayers.indexOf(currentLayerid) > -1 || invisiblelayers.indexOf(currentLayerid.toString()) > -1) {\r\n      visible = false;\r\n    }\r\n    return visible;\r\n  }\r\n\r\n  private initWelcomeWindow(): void {\r\n    if (this.auth?.url) {\r\n      this.authService.logged$.subscribe((logged) => {\r\n        if (logged) {\r\n          this.createWelcomeWindow();\r\n        }\r\n      });\r\n    } else {\r\n      this.createWelcomeWindow();\r\n    }\r\n  }\r\n\r\n  private createWelcomeWindow(): void {\r\n    if (this.welcomeWindowService.hasWelcomeWindow()) {\r\n      const welcomWindowConfig: MatDialogConfig = this.welcomeWindowService.getConfig();\r\n\r\n      this.matDialogRef$.next(\r\n          this.dialogWindow.open(\r\n          WelcomeWindowComponent,\r\n          welcomWindowConfig\r\n        ));\r\n\r\n        this.matDialogRef$.value.afterClosed().subscribe((result) => {\r\n        this.welcomeWindowService.afterClosedWelcomeWindow();\r\n        this.matDialogRef$.next(undefined);\r\n      });\r\n    }\r\n  }\r\n\r\n  private getFeatureIsSameActiveWks(feature: Feature): boolean {\r\n    if (this.workspace) {\r\n      const featureTitle = feature.meta.sourceTitle;\r\n      const wksTitle = this.workspace.title;\r\n      if (wksTitle === featureTitle) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private getWksActiveOpenInResolution(): boolean {\r\n    if(this.workspace) {\r\n      const activeWks = this.workspace as WfsWorkspace;\r\n      if(activeWks.active && activeWks.inResolutionRange$.value && this.workspaceState.workspacePanelExpanded) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n   }\r\n\r\n  refreshRelationsWorkspace(relationLayers: ImageLayer[] | VectorLayer[]) {\r\n    if (relationLayers?.length) {\r\n      for (const layer of relationLayers) {\r\n        const relationWorkspace = this.workspaceStore.all().find(workspace => layer.options.workspace.workspaceId.includes(workspace.id));\r\n        relationWorkspace?.meta.tableTemplate.columns.forEach(col => {\r\n          // Update domain list\r\n          if (col.type === 'list' || col.type === 'autocomplete') {\r\n            this.editionWorkspaceService.getDomainValues(col.relation.table).subscribe(result => {\r\n              col.domainValues = result;\r\n            });\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n","<igo-spinner igoSpinnerActivity></igo-spinner>\r\n\r\n<igo-auth-form *ngIf=\"authConfig && authConfig.url\"></igo-auth-form>\r\n\r\n<app-portal igoStopDropPropagation></app-portal>\r\n","import './portal.variables.scss';\r\n\r\nimport {\r\n  trigger,\r\n  state,\r\n  style,\r\n  transition,\r\n  animate,\r\n  AnimationTriggerMetadata\r\n} from '@angular/animations';\r\n\r\nexport function expansionPanelAnimation(): AnimationTriggerMetadata[] {\r\n  return [\r\n    trigger('expansionPanelSize', [\r\n      state(\r\n        'full',\r\n        style({\r\n          left: '5px',\r\n          'max-width': '100%'\r\n        })\r\n      ),\r\n      state(\r\n        'notTriggered',\r\n        style({\r\n          left: '5px',\r\n          bottom: '5px',\r\n          'max-width': '100%'\r\n        })\r\n      ),\r\n      state(\r\n        'notVisible',\r\n        style({\r\n          display: 'none'\r\n        })\r\n      ),\r\n      state(\r\n        'mobile',\r\n        style({\r\n          left: 'calc(100% - 40px)',\r\n        })\r\n      ),\r\n      state(\r\n        'reduced',\r\n        style({\r\n          left: '405px',\r\n          'max-width': 'calc(100% - 405px)'\r\n        })\r\n      ),\r\n      state(\r\n        'reducedNotTriggered',\r\n        style({\r\n          left: '405px',\r\n          bottom: '5px',\r\n          'max-width': 'calc(100% - 405px)'\r\n        })\r\n      ),\r\n      transition('* => *', animate('100ms'))\r\n    ]),\r\n    trigger('toastOffsetY', [\r\n      state(\r\n        'true',\r\n        style({\r\n          bottom: '50px'\r\n        })\r\n      ),\r\n      state(\r\n        'false',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      )\r\n    ])\r\n  ];\r\n}\r\n\r\nexport function toastPanelAnimation(): AnimationTriggerMetadata[] {\r\n  return [\r\n    trigger('toastPanelMobileSidenav', [\r\n      state(\r\n        'true',\r\n        style({\r\n          display: 'none'\r\n        })\r\n      ),\r\n      transition('* => void', animate('0ms')),\r\n      transition('* => *', animate('200ms'))\r\n    ]),\r\n    trigger('toastPanelOffsetX', [\r\n      state(\r\n        'fullStandard',\r\n        style({\r\n          left: '45%'\r\n        })\r\n      ),\r\n      state(\r\n        'standard',\r\n        style({\r\n          left: '50%'\r\n        })\r\n      ),\r\n      state(\r\n        'htmlDisplay',\r\n        style({\r\n          left: '40%'\r\n        })\r\n      ),\r\n      state(\r\n        'fullOffsetX',\r\n        style({\r\n          left: 'calc(45% + 202px)'\r\n        })\r\n      ),\r\n      state(\r\n        'standardOffsetX',\r\n        style({\r\n          left: 'calc(50% + 202px)'\r\n        })\r\n      ),\r\n      state(\r\n        'htmlDisplayOffsetX',\r\n        style({\r\n          left: 'calc(40% + 160px)'\r\n        })\r\n    ),\r\n      transition('fullStandard => fullOffsetX', animate('200ms')),\r\n      transition('fullOffsetX => fullStandard', animate('200ms')),\r\n      transition('standard => standardOffsetX', animate('200ms')),\r\n      transition('standardOffsetX => standard', animate('200ms')),\r\n      transition('htmlDisplay => htmlDisplayOffsetX', animate('200ms')),\r\n      transition('htmlDisplayOffsetX => htmlDisplay', animate('200ms')),\r\n      // transition('standard => htmlDisplay', animate('200ms')),\r\n      // transition('htmlDisplay => standard', animate('200ms')),\r\n    ]),\r\n    trigger('toastPanelOffsetY', [\r\n      state(\r\n        'noExpansion',\r\n        style({\r\n          bottom: '0'\r\n        })\r\n      ),\r\n      state(\r\n        'expansionAndToastOpened',\r\n        style({\r\n          bottom: '285px',\r\n          zIndex: '999'\r\n        })\r\n      ),\r\n      state(\r\n        'expansionAndToastClosed',\r\n        style({\r\n          bottom: '285px',\r\n          zIndex: '5'\r\n        })\r\n      ),\r\n      state(\r\n        'expansionMaximizedAndToastOpened',\r\n        style({\r\n          bottom: '500px', // workspace full size\r\n          zIndex: '999'\r\n        })\r\n      ),\r\n      state(\r\n        'expansionMaximizedAndToastClosed',\r\n        style({\r\n          bottom: '500px', // workspace full size\r\n          zIndex: '5'\r\n        })\r\n      ),\r\n    transition('noExpansion => noExpansion', animate('10ms')),\r\n    transition('expansionAndToastOpened => expansionAndToastOpened', animate('200ms')),\r\n    transition('expansionAndToastClosed => expansionAndToastClosed', animate('200ms')),\r\n    transition('expansionMaximizedAndToastOpened => expansionMaximizedAndToastOpened', animate('200ms')),\r\n    transition('expansionMaximizedAndToastClosed => expansionMaximizedAndToastClosed', animate('200ms')),\r\n       ])\r\n  ];\r\n}\r\n\r\nexport function controlsAnimations(): AnimationTriggerMetadata[] {\r\n  return [\r\n    trigger('controlsOffsetY', [\r\n      state('close', style({})),\r\n      state(\r\n        'firstRowFromBottom',\r\n        style({\r\n          bottom: '5px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded',\r\n        style({\r\n          bottom: '285px'\r\n        })\r\n      ),\r\n      state(\r\n        'firstRowFromBottom-expanded-maximized',\r\n        style({\r\n          bottom: '500px'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom',\r\n        style({\r\n          bottom: '47px'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom',\r\n        style({\r\n          bottom: '104px'\r\n        })\r\n      ),\r\n      state(\r\n        '',\r\n        style({\r\n          bottom: 'calc(285px)'\r\n        })\r\n      ),\r\n      state(\r\n        'secondRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 52px)'\r\n        })\r\n      ),\r\n      state(\r\n        'thirdRowFromBottom-expanded',\r\n        style({\r\n          bottom: 'calc(285px + 104px)'\r\n        })\r\n      ),\r\n      transition('* => *', animate('200ms'))\r\n    ]),\r\n    trigger('mobileOffsetY', [\r\n      state(\r\n        'low',\r\n        style({\r\n          bottom: '50px'\r\n        })\r\n      ),\r\n      transition('* => *', animate('200ms'))\r\n    ])\r\n  ];\r\n}\r\n\r\nexport function controlSlideX(): AnimationTriggerMetadata {\r\n  return trigger('controlStateX', [\r\n    state(\r\n      'left',\r\n      style({\r\n        left: '60px'\r\n      })\r\n    ),\r\n    state(\r\n      'right',\r\n      style({\r\n        left: '465px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function controlSlideY(): AnimationTriggerMetadata {\r\n  return trigger('controlStateY', [\r\n    state('close', style({})),\r\n    state(\r\n      'firstRowFromBottom',\r\n      style({\r\n        bottom: '2px',\r\n        'margin-left': '0px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded',\r\n      style({\r\n        bottom: '285px',\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    state(\r\n      'firstRowFromBottom-expanded-maximized',\r\n      style({\r\n        bottom: '500px', // workspace full size\r\n        'margin-left': '-55px'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n\r\nexport function mapSlideX(): AnimationTriggerMetadata {\r\n  return trigger('mapStateX', [\r\n    state(\r\n      'left',\r\n      style({\r\n        left: '0'\r\n      })\r\n    ),\r\n    state(\r\n      'right',\r\n      style({\r\n        left: '0'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\nexport function mapSlideY(): AnimationTriggerMetadata {\r\n  return trigger('mapStateY', [\r\n    state(\r\n      '*',\r\n      style({\r\n        bottom: '0'\r\n      })\r\n    ),\r\n    transition('* => *', animate('200ms'))\r\n  ]);\r\n}\r\n","import { Component, Renderer2 } from '@angular/core';\r\nimport { Title, Meta } from '@angular/platform-browser';\r\nimport { zip } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nimport { userAgent } from '@igo2/utils';\r\nimport {\r\n  LanguageService,\r\n  ConfigService,\r\n  AnalyticsService,\r\n  MessageService\r\n} from '@igo2/core';\r\nimport { AuthOptions } from '@igo2/auth';\r\nimport { AnalyticsListenerService } from '@igo2/integration';\r\nimport { PwaService } from './services/pwa.service';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n  public authConfig: AuthOptions;\r\n  private themeClass = 'blue-theme';\r\n\r\n  constructor(\r\n    protected languageService: LanguageService,\r\n    private configService: ConfigService,\r\n    private analyticsService: AnalyticsService,\r\n    private analyticsListenerService: AnalyticsListenerService,\r\n    private renderer: Renderer2,\r\n    private titleService: Title,\r\n    private metaService: Meta,\r\n    private messageService: MessageService,\r\n    private pwaService: PwaService\r\n  ) {\r\n    this.pwaService.checkForUpdates();\r\n    this.languageService.translate.getTranslation(this.languageService.getLanguage()).subscribe();\r\n\r\n    this.authConfig = this.configService.getConfig('auth');\r\n\r\n    this.readTitleConfig();\r\n    this.readThemeConfig();\r\n    this.readDescriptionConfig();\r\n\r\n    this.analyticsListenerService.listen();\r\n\r\n    this.detectOldBrowser();\r\n  }\r\n\r\n  private readTitleConfig() {\r\n    this.languageService.translate.get(this.configService.getConfig('title')).subscribe(title => {\r\n      if (title) {\r\n        this.titleService.setTitle(title);\r\n        this.metaService.addTag({ name: 'title', content: title });\r\n      }\r\n    });\r\n  }\r\n\r\n  private readThemeConfig() {\r\n    const theme = this.configService.getConfig('theme') || this.themeClass;\r\n    if (theme) {\r\n      this.renderer.addClass(document.body, theme);\r\n    }\r\n  }\r\n\r\n  private readDescriptionConfig() {\r\n    const description = this.configService.getConfig('description');\r\n    if (description) {\r\n      this.metaService.addTag({ name: 'description', content: description });\r\n    }\r\n  }\r\n\r\n  private detectOldBrowser() {\r\n    const oldBrowser = userAgent.satisfies({\r\n      ie: '<=11',\r\n      chrome: '<64',\r\n      firefox: '<60',\r\n      safari: '<=11'\r\n    });\r\n\r\n    if (oldBrowser) {\r\n      const translate = this.languageService.translate;\r\n      const title$ = translate.get('oldBrowser.title');\r\n      const message$ = translate.get('oldBrowser.message');\r\n      zip(title$, message$)\r\n        .pipe(\r\n          map(([title, message]) => ({\r\n            title,\r\n            message\r\n          }))\r\n        )\r\n        .subscribe((rep) =>\r\n          this.messageService.alert(rep.message, rep.title, {\r\n            timeOut: 15000\r\n          })\r\n        );\r\n    }\r\n  }\r\n}\r\n","import { BrowserModule, HammerModule } from '@angular/platform-browser';\r\nimport { APP_INITIALIZER, Injector, NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport {\r\n  provideConfigOptions,\r\n  IgoMessageModule,\r\n  IgoGestureModule,\r\n  RouteService,\r\n  LanguageService\r\n} from '@igo2/core';\r\nimport { IgoSpinnerModule, IgoStopPropagationModule } from '@igo2/common';\r\nimport { IgoAuthModule } from '@igo2/auth';\r\nimport {\r\n  provideIChercheSearchSource,\r\n  provideIChercheReverseSearchSource,\r\n  provideNominatimSearchSource,\r\n  provideCoordinatesReverseSearchSource,\r\n  provideILayerSearchSource,\r\n  provideStoredQueriesSearchSource,\r\n  provideOsrmDirectionsSource,\r\n  provideOptionsApi,\r\n  provideCadastreSearchSource,\r\n  provideStyleListOptions\r\n} from '@igo2/geo';\r\n\r\nimport { PwaService } from './services/pwa.service';\r\n\r\nimport { environment } from '../environments/environment';\r\nimport { PortalModule } from './pages';\r\nimport { AppComponent } from './app.component';\r\nimport { ServiceWorkerModule } from '@angular/service-worker';\r\n\r\n@NgModule({\r\n  declarations: [AppComponent],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    RouterModule.forRoot([]),\r\n    IgoAuthModule.forRoot(),\r\n    IgoGestureModule.forRoot(),\r\n    IgoMessageModule,\r\n    IgoSpinnerModule,\r\n    IgoStopPropagationModule,\r\n    PortalModule,\r\n    HammerModule,\r\n    ServiceWorkerModule.register('ngsw-worker.js', { enabled: environment.production, registrationStrategy: 'registerWithDelay:5000' })\r\n  ],\r\n  providers: [\r\n    provideConfigOptions({\r\n      default: environment.igo,\r\n      path: './config/config.json'\r\n    }),\r\n    RouteService,\r\n    provideNominatimSearchSource(),\r\n    provideIChercheSearchSource(),\r\n    provideIChercheReverseSearchSource(),\r\n    provideCoordinatesReverseSearchSource(),\r\n    provideILayerSearchSource(),\r\n    provideStoredQueriesSearchSource(),\r\n    provideOsrmDirectionsSource(),\r\n    provideOptionsApi(),\r\n    provideCadastreSearchSource(),\r\n    {provide: APP_INITIALIZER, useFactory: appInitializerFactory, deps: [LanguageService, PwaService, Injector], multi: true},\r\n    provideStyleListOptions({\r\n      path: './assets/list-style.json'\r\n    })\r\n  ],\r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule {}\r\n\r\nexport function appInitializerFactory(languageService: LanguageService, pwaService: PwaService, injector: Injector) {\r\n  return () => new Promise<any>((resolve: any) => {\r\n      languageService.translate.getTranslation(languageService.getLanguage()).subscribe(() => {\r\n        console.info(`Successfully initialized '${languageService.getLanguage()}' language.'`);\r\n        pwaService.initPwaPrompt();\r\n      }, err => {\r\n        console.error(`Problem with '${languageService.getLanguage()}' language initialization.'`);\r\n      }, () => {\r\n        resolve(null);\r\n      });\r\n  });\r\n}\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nimport 'hammerjs';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic()\r\n  .bootstrapModule(AppModule)\r\n  .catch(err => console.log(err));\r\n","var map = {\n\t\"./en.auth.json\": 44505,\n\t\"./en.common.json\": 13841,\n\t\"./en.context.json\": 2977,\n\t\"./en.core.json\": 8982,\n\t\"./en.geo.json\": 49853,\n\t\"./en.integration.json\": 38430,\n\t\"./en.json\": 90642,\n\t\"./fr.auth.json\": 13788,\n\t\"./fr.common.json\": 55144,\n\t\"./fr.context.json\": 65742,\n\t\"./fr.core.json\": 38783,\n\t\"./fr.geo.json\": 78405,\n\t\"./fr.integration.json\": 66409,\n\t\"./fr.json\": 60863\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 22356;","var map = {\n\t\"./af\": 62275,\n\t\"./af.js\": 62275,\n\t\"./ar\": 90857,\n\t\"./ar-dz\": 11218,\n\t\"./ar-dz.js\": 11218,\n\t\"./ar-kw\": 14754,\n\t\"./ar-kw.js\": 14754,\n\t\"./ar-ly\": 66680,\n\t\"./ar-ly.js\": 66680,\n\t\"./ar-ma\": 92178,\n\t\"./ar-ma.js\": 92178,\n\t\"./ar-sa\": 56522,\n\t\"./ar-sa.js\": 56522,\n\t\"./ar-tn\": 95682,\n\t\"./ar-tn.js\": 95682,\n\t\"./ar.js\": 90857,\n\t\"./az\": 70164,\n\t\"./az.js\": 70164,\n\t\"./be\": 79774,\n\t\"./be.js\": 79774,\n\t\"./bg\": 60947,\n\t\"./bg.js\": 60947,\n\t\"./bm\": 21832,\n\t\"./bm.js\": 21832,\n\t\"./bn\": 89650,\n\t\"./bn-bd\": 74477,\n\t\"./bn-bd.js\": 74477,\n\t\"./bn.js\": 89650,\n\t\"./bo\": 66005,\n\t\"./bo.js\": 66005,\n\t\"./br\": 98492,\n\t\"./br.js\": 98492,\n\t\"./bs\": 70534,\n\t\"./bs.js\": 70534,\n\t\"./ca\": 52061,\n\t\"./ca.js\": 52061,\n\t\"./cs\": 84737,\n\t\"./cs.js\": 84737,\n\t\"./cv\": 61167,\n\t\"./cv.js\": 61167,\n\t\"./cy\": 77996,\n\t\"./cy.js\": 77996,\n\t\"./da\": 9528,\n\t\"./da.js\": 9528,\n\t\"./de\": 14540,\n\t\"./de-at\": 49430,\n\t\"./de-at.js\": 49430,\n\t\"./de-ch\": 67978,\n\t\"./de-ch.js\": 67978,\n\t\"./de.js\": 14540,\n\t\"./dv\": 83426,\n\t\"./dv.js\": 83426,\n\t\"./el\": 6616,\n\t\"./el.js\": 6616,\n\t\"./en-au\": 63816,\n\t\"./en-au.js\": 63816,\n\t\"./en-ca\": 32162,\n\t\"./en-ca.js\": 32162,\n\t\"./en-gb\": 83305,\n\t\"./en-gb.js\": 83305,\n\t\"./en-ie\": 61954,\n\t\"./en-ie.js\": 61954,\n\t\"./en-il\": 43060,\n\t\"./en-il.js\": 43060,\n\t\"./en-in\": 59923,\n\t\"./en-in.js\": 59923,\n\t\"./en-nz\": 13540,\n\t\"./en-nz.js\": 13540,\n\t\"./en-sg\": 16505,\n\t\"./en-sg.js\": 16505,\n\t\"./eo\": 41907,\n\t\"./eo.js\": 41907,\n\t\"./es\": 86640,\n\t\"./es-do\": 41246,\n\t\"./es-do.js\": 41246,\n\t\"./es-mx\": 56131,\n\t\"./es-mx.js\": 56131,\n\t\"./es-us\": 36430,\n\t\"./es-us.js\": 36430,\n\t\"./es.js\": 86640,\n\t\"./et\": 62551,\n\t\"./et.js\": 62551,\n\t\"./eu\": 32711,\n\t\"./eu.js\": 32711,\n\t\"./fa\": 54572,\n\t\"./fa.js\": 54572,\n\t\"./fi\": 33390,\n\t\"./fi.js\": 33390,\n\t\"./fil\": 87860,\n\t\"./fil.js\": 87860,\n\t\"./fo\": 48216,\n\t\"./fo.js\": 48216,\n\t\"./fr\": 99291,\n\t\"./fr-ca\": 98527,\n\t\"./fr-ca.js\": 98527,\n\t\"./fr-ch\": 58407,\n\t\"./fr-ch.js\": 58407,\n\t\"./fr.js\": 99291,\n\t\"./fy\": 47054,\n\t\"./fy.js\": 47054,\n\t\"./ga\": 49540,\n\t\"./ga.js\": 49540,\n\t\"./gd\": 73917,\n\t\"./gd.js\": 73917,\n\t\"./gl\": 51486,\n\t\"./gl.js\": 51486,\n\t\"./gom-deva\": 56245,\n\t\"./gom-deva.js\": 56245,\n\t\"./gom-latn\": 48868,\n\t\"./gom-latn.js\": 48868,\n\t\"./gu\": 59652,\n\t\"./gu.js\": 59652,\n\t\"./he\": 89019,\n\t\"./he.js\": 89019,\n\t\"./hi\": 42040,\n\t\"./hi.js\": 42040,\n\t\"./hr\": 63402,\n\t\"./hr.js\": 63402,\n\t\"./hu\": 79322,\n\t\"./hu.js\": 79322,\n\t\"./hy-am\": 27609,\n\t\"./hy-am.js\": 27609,\n\t\"./id\": 57942,\n\t\"./id.js\": 57942,\n\t\"./is\": 98275,\n\t\"./is.js\": 98275,\n\t\"./it\": 73053,\n\t\"./it-ch\": 4378,\n\t\"./it-ch.js\": 4378,\n\t\"./it.js\": 73053,\n\t\"./ja\": 46176,\n\t\"./ja.js\": 46176,\n\t\"./jv\": 679,\n\t\"./jv.js\": 679,\n\t\"./ka\": 92726,\n\t\"./ka.js\": 92726,\n\t\"./kk\": 72953,\n\t\"./kk.js\": 72953,\n\t\"./km\": 86957,\n\t\"./km.js\": 86957,\n\t\"./kn\": 59181,\n\t\"./kn.js\": 59181,\n\t\"./ko\": 47148,\n\t\"./ko.js\": 47148,\n\t\"./ku\": 27752,\n\t\"./ku.js\": 27752,\n\t\"./ky\": 65675,\n\t\"./ky.js\": 65675,\n\t\"./lb\": 41263,\n\t\"./lb.js\": 41263,\n\t\"./lo\": 65746,\n\t\"./lo.js\": 65746,\n\t\"./lt\": 11143,\n\t\"./lt.js\": 11143,\n\t\"./lv\": 38753,\n\t\"./lv.js\": 38753,\n\t\"./me\": 44054,\n\t\"./me.js\": 44054,\n\t\"./mi\": 31573,\n\t\"./mi.js\": 31573,\n\t\"./mk\": 30202,\n\t\"./mk.js\": 30202,\n\t\"./ml\": 68523,\n\t\"./ml.js\": 68523,\n\t\"./mn\": 79794,\n\t\"./mn.js\": 79794,\n\t\"./mr\": 56681,\n\t\"./mr.js\": 56681,\n\t\"./ms\": 56975,\n\t\"./ms-my\": 39859,\n\t\"./ms-my.js\": 39859,\n\t\"./ms.js\": 56975,\n\t\"./mt\": 3691,\n\t\"./mt.js\": 3691,\n\t\"./my\": 5152,\n\t\"./my.js\": 5152,\n\t\"./nb\": 7607,\n\t\"./nb.js\": 7607,\n\t\"./ne\": 21526,\n\t\"./ne.js\": 21526,\n\t\"./nl\": 86368,\n\t\"./nl-be\": 40076,\n\t\"./nl-be.js\": 40076,\n\t\"./nl.js\": 86368,\n\t\"./nn\": 68420,\n\t\"./nn.js\": 68420,\n\t\"./oc-lnc\": 51906,\n\t\"./oc-lnc.js\": 51906,\n\t\"./pa-in\": 94504,\n\t\"./pa-in.js\": 94504,\n\t\"./pl\": 54721,\n\t\"./pl.js\": 54721,\n\t\"./pt\": 74645,\n\t\"./pt-br\": 54548,\n\t\"./pt-br.js\": 54548,\n\t\"./pt.js\": 74645,\n\t\"./ro\": 71977,\n\t\"./ro.js\": 71977,\n\t\"./ru\": 26042,\n\t\"./ru.js\": 26042,\n\t\"./sd\": 78849,\n\t\"./sd.js\": 78849,\n\t\"./se\": 27739,\n\t\"./se.js\": 27739,\n\t\"./si\": 50084,\n\t\"./si.js\": 50084,\n\t\"./sk\": 92449,\n\t\"./sk.js\": 92449,\n\t\"./sl\": 23086,\n\t\"./sl.js\": 23086,\n\t\"./sq\": 33139,\n\t\"./sq.js\": 33139,\n\t\"./sr\": 30607,\n\t\"./sr-cyrl\": 30063,\n\t\"./sr-cyrl.js\": 30063,\n\t\"./sr.js\": 30607,\n\t\"./ss\": 40131,\n\t\"./ss.js\": 40131,\n\t\"./sv\": 21665,\n\t\"./sv.js\": 21665,\n\t\"./sw\": 5642,\n\t\"./sw.js\": 5642,\n\t\"./ta\": 33622,\n\t\"./ta.js\": 33622,\n\t\"./te\": 74825,\n\t\"./te.js\": 74825,\n\t\"./tet\": 48336,\n\t\"./tet.js\": 48336,\n\t\"./tg\": 39238,\n\t\"./tg.js\": 39238,\n\t\"./th\": 99463,\n\t\"./th.js\": 99463,\n\t\"./tk\": 39986,\n\t\"./tk.js\": 39986,\n\t\"./tl-ph\": 29672,\n\t\"./tl-ph.js\": 29672,\n\t\"./tlh\": 40043,\n\t\"./tlh.js\": 40043,\n\t\"./tr\": 51212,\n\t\"./tr.js\": 51212,\n\t\"./tzl\": 50110,\n\t\"./tzl.js\": 50110,\n\t\"./tzm\": 80482,\n\t\"./tzm-latn\": 38309,\n\t\"./tzm-latn.js\": 38309,\n\t\"./tzm.js\": 80482,\n\t\"./ug-cn\": 42495,\n\t\"./ug-cn.js\": 42495,\n\t\"./uk\": 54157,\n\t\"./uk.js\": 54157,\n\t\"./ur\": 80984,\n\t\"./ur.js\": 80984,\n\t\"./uz\": 64141,\n\t\"./uz-latn\": 43662,\n\t\"./uz-latn.js\": 43662,\n\t\"./uz.js\": 64141,\n\t\"./vi\": 12607,\n\t\"./vi.js\": 12607,\n\t\"./x-pseudo\": 66460,\n\t\"./x-pseudo.js\": 66460,\n\t\"./yo\": 92948,\n\t\"./yo.js\": 92948,\n\t\"./zh-cn\": 62658,\n\t\"./zh-cn.js\": 62658,\n\t\"./zh-hk\": 39352,\n\t\"./zh-hk.js\": 39352,\n\t\"./zh-mo\": 38274,\n\t\"./zh-mo.js\": 38274,\n\t\"./zh-tw\": 98451,\n\t\"./zh-tw.js\": 98451\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;"]}